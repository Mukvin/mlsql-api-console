(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{124:function(e,t,a){},125:function(e,t,a){},240:function(e,t,a){},303:function(e,t,a){},505:function(e,t,a){e.exports=a(991)},510:function(e,t,a){},511:function(e,t,a){},512:function(e,t,a){},513:function(e,t,a){},581:function(e,t,a){},991:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),o=a.n(c);a(510),a(511),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(5),l=a(7),s=a(9),u=a(8),m=a(10),d=(a(512),a(414)),p=a(107),h=a(415),f=a(995),b=a(3),g=a(323),E=a(324),v=(a(513),{GET:"get",POST:"post",PUT:"put"}),y={Success:200,BadRequest:400,Unauthorized:401,Forbidden:404,ServerError:500},O={name:"access-token"},j=a(135),S=function e(t){Object(i.a)(this,e),this.value=t},k=function e(t,a,n){var r=this;Object(i.a)(this,e),this.json=function(e,t){r.content.then(function(a){try{var n=JSON.parse(a);e(n)}catch(r){console.log(r),t(a)}})},this.status=t,this.content=a,this.accessToken=n},w=function(){function e(t){Object(i.a)(this,e),this.url=t}return Object(l.a)(e,[{key:"request2",value:function(e,t,a){this.request(v.POST,e,function(e){e.json(function(e){t(e)},function(e){a(e)})},function(e){try{e.value().content(function(e){var t=e;try{t=JSON.parse(e).msg}catch(n){}a(t)})}catch(t){a(e?e.toString():"result is null")}})}},{key:"runScript",value:function(e,t,a,n){var r=new Q,c=j(),o=this;r.user(function(r){var i=r.userName,l=r.backendTags;if(l){var s={sql:t,owner:i,jobName:c,sessionPerUser:!0,show_stack:!0,skipAuth:!1,tags:l||""};Object.assign(s,e),(e.background||!1)&&Object.assign(s,{async:!0,callback:""}),o.request(v.POST,s,function(e){if(200===e.status)e.json(function(e){a(e)},function(e){n(e)});else try{e.content.then(function(t){var a=t;try{a=JSON.parse(t).msg}catch(r){}n("backend status:"+e.status+"\n"+a)})}catch(t){n("backend status:"+e.status)}},function(e){try{e.value().content(function(e){var t=e;try{t=JSON.parse(e).msg}catch(a){}n(t)})}catch(t){n(e?e.toString():"result is null")}})}else n("\n                \n                ---------------Warning--------------------\n                \n                Please make sure you have backend configured. \n                If not, please contact admin;\n                \n                ------------------------------------------\n                ")})}},{key:"request",value:function(e,t,a,n){e=e.toUpperCase();var r=[];for(var c in t){var o=encodeURIComponent(c),i=encodeURIComponent(t[c]);r.push(o+"="+i)}var l=this.url;return"GET"===e?(l=l+"?"+r,r=void 0):r=r.join("&"),fetch(l,{method:e,timeout:864e5,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","Access-Token":sessionStorage.getItem(O.name)||""},body:r}).then(function(e){a(new k(e.status,e.text(),e.headers.get(O.name)))}).catch(function(e){n(new S(e))})}},{key:"newRunScript",value:function(e,t,a,n){var r=new Q,c=j(),o=this;r.user(function(r){var i=r.userName,l=r.backendTags;if(l){var s={sql:t,owner:i,jobName:c,sessionPerUser:!0,show_stack:!0,skipAuth:!1,tags:l||""};Object.assign(s,e),(e.background||!1)&&Object.assign(s,{async:!0,callback:""}),o.new_request(v.POST,s,a,n)}else n("\n                \n                ---------------Warning--------------------\n                \n                Please make sure you have backend configured. \n                If not, please contact admin;\n                \n                ------------------------------------------\n                ")})}},{key:"new_request",value:function(e,t,a,n){e=e.toUpperCase();var r=[];for(var c in t){var o=encodeURIComponent(c),i=encodeURIComponent(t[c]);r.push(o+"="+i)}var l=this.url;"GET"===e?(l=l+"?"+r,r=void 0):r=r.join("&");var s=0;return fetch(l,{method:e,timeout:864e5,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","Access-Token":sessionStorage.getItem(O.name)||""},body:r}).then(function(e){return 200===(s=e.status)&&e.json().then(function(e){a(e)}),e}).then(function(e){var t=function(){e.text().then(function(e){try{n(JSON.parse(e).msg)}catch(t){n(e)}})};switch(s){case 201:break;case 400:case 500:t();break;default:console.log("unhandled")}}).catch(function(e){n(e.message)})}}]),e}(),C="/api_v1/user/tags/update",T="/api_v1/script_file",D="/api_v1/script_file/remove",N="/api_v1/script_file/get",x="/api_v1/run/script",R="/api_v1/file/upload",M="/api_v1/team/create",I="/api_v1/team/name/check",_="/api_v1/team",P="/api_v1/team/invited",L="/api_v1/team/member/add",A="/api_v1/team/member/accept",q="/api_v1/team/member/refuse",B="/api_v1/team/role/add",V="/api_v1/team/table/add",F="/api_v1/role/table/add",U="/api_v1/role/member/add",G="/api_v1/changepassword",z=a(446),Q=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,[{key:"isLogin",value:function(){return null!==sessionStorage.getItem(O.name)}},{key:"userName",value:function(e){new w("/api_v1/user/userName").request(v.GET,{},function(t){t.status===y.Unauthorized?sessionStorage.removeItem(O.name):t.content.then(function(t){e(JSON.parse(t).userName)}).catch(function(e){})},function(e){console.log(e)})}},{key:"user",value:function(e){new w("/api_v1/user/userName").request2({},function(t){e(t)},function(e){})}},{key:"login",value:function(e,t,a,n){this.registerOrLogin("/api_v1/user/login",e,t,a,n)}},{key:"logout",value:function(){sessionStorage.removeItem(O.name)}},{key:"register",value:function(e,t,a,n){this.registerOrLogin("/api_v1/user/register",e,t,a,n)}},{key:"registerOrLogin",value:function(e,t,a,n,r){var c={userName:t,password:a};new w(e).request(v.POST,c,function(e){e.accessToken&&(sessionStorage.setItem(O.name,e.accessToken),(new z.a).set(O.name,e.accessToken,{path:"/"}));n(e)},function(e){r(e)})}}]),e}(),K=a(35),H=a.n(K),J=a(46),W=(a(136),a(222),a(47)),$=a.n(W),Y=(a(302),a(223),a(224),a(303),a(155),a(59)),X=a(998),Z=function(e,t){if(!e){if(t=t||"Assertion failed","undefined"!==typeof Error)throw new Error(t);throw t}},ee=function e(){Object(i.a)(this,e),this.makeSQL=function(e){return"JobList"===e?"load _mlsql_.`jobs` as output;":"ConnectMySQL"===e?'connect jdbc where\n url="jdbc:mysql://127.0.0.1:3306/wow?characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&tinyInt1isBit=false"\n and driver="com.mysql.jdbc.Driver"\n and user=""\n and password=""\n as db_1;':"ShowResource"===e?"load _mlsql_.`resource` as output;":""}},te=a(152),ae=a(89),ne=a(130),re="",ce=function e(){Object(i.a)(this,e)};ce.GET="get",ce.POST="post",ce.PUT="put",ce.DELETE="delete";var oe={name:"access-token"},ie=function e(){Object(i.a)(this,e)};ie.USER_NAME="userName",ie.USER_ID="userId",ie.ADMIN_TOKEN="admin_token",ie.LOGIN_TOKEN="access-token";var le=function e(t,a){Object(i.a)(this,e),this.status=t,this.content=a},se=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(i.a)(this,e),this.url=t,this.url||(this.url=re),this.fetch_config=a}return Object(l.a)(e,[{key:"request",value:function(){var e=Object(J.a)(H.a.mark(function e(t,a){var n,r,c,o,i,l,s,u,m,d,p,h,f=arguments;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in n=(n=f.length>2&&void 0!==f[2]?f[2]:"GET").toUpperCase(),(r=sessionStorage.getItem(ie.USER_NAME))&&(a[ie.USER_NAME]=r),c=[],a)i=encodeURIComponent(o),l=encodeURIComponent(a[o]),c.push(i+"="+l);return s=this.url+t,c.length>0&&(s+="?"),"GET"===n?(s+=c.join("&"),c=void 0):c=c.join("&"),u={method:n,timeout:864e5,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","Access-Token":sessionStorage.getItem(oe)||""},body:c},m=Object(ne.a)({},u,this.fetch_config),e.prev=11,console.log(s),e.next=15,fetch(s,m);case 15:if((d=e.sent).ok){e.next=21;break}return e.next=19,d.text();case 19:return p=e.sent,e.abrupt("return",new le(d.status,p));case 21:return e.next=23,d.json();case 23:return h=e.sent,e.abrupt("return",new le(200,h));case 27:return e.prev=27,e.t0=e.catch(11),e.abrupt("return",new le(500,e.t0));case 30:case"end":return e.stop()}},e,this,[[11,27]])}));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),ue=function e(){Object(i.a)(this,e)};ue.RUN="/api_v1/run/script",ue.USER_NAME="/api_v1/user/userName";var me=function(){function e(){Object(i.a)(this,e),this.backend=new se}return Object(l.a)(e,[{key:"userName",value:function(){var e=Object(J.a)(H.a.mark(function e(){var t;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(ue.USER_NAME,{});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"runScript",value:function(){var e=Object(J.a)(H.a.mark(function e(t,a,n){var r,c,o,i,l,s;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userName();case 2:if(200===(r=e.sent).status){e.next=5;break}return e.abrupt("return",r);case 5:return c=r.content,o=c.userName,i=c.backendTags,l={sql:t,owner:o,jobName:a,sessionPerUser:!0,show_stack:!0,skipAuth:!1,tags:i||""},Object.assign(l,n),e.next=10,this.post(ue.RUN,l);case 10:return s=e.sent,e.abrupt("return",s);case 12:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(J.a)(H.a.mark(function e(t,a){var n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backend.request(t,a,ce.GET);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(J.a)(H.a.mark(function e(t,a){var n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backend.request(t,a,ce.POST);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),de=a(135),pe=function(){function e(t){Object(i.a)(this,e),this.appendLog=t,this.log={}}return Object(l.a)(e,[{key:"cancelQueryLog",value:function(){var e=Object(J.a)(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.intervalTimer&&(clearInterval(this.intervalTimer),this.intervalTimer=null);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"queryLog",value:function(){var e=Object(J.a)(H.a.mark(function e(){var t=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.cancelQueryLog(),this.intervalTimer=setInterval(Object(J.a)(H.a.mark(function e(){var a,n,r,c;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=de(),n=new me,e.next=4,n.runScript("load _mlsql_.`log/".concat(t.log.offset||-1,'` where filePath="engine_log" as output;'),a,{});case 4:r=e.sent,(c=r.content[0]).value.length>0&&t.appendLog(c.value.map(function(e){return e.split("__MMMMMM__")[1]}).join("\n")),t.log.offset=c.offset;case 8:case"end":return e.stop()}},e)})),2e3);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),he=te.a.Option,fe=a(135),be=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).text=function(e,t){a.setState({value:e,scriptId:t},function(){a.aceEditorRef.current.editor.setValue(e,1)})},a.executeSave=function(){var e=new w(T),t=Object(b.a)(Object(b.a)(a)),n=a.getMessageBoxAceEditor();t.state.scriptId?e.request(v.POST,{id:t.state.scriptId,content:t.getAceEditor().getValue()},function(e){200!=e.status?e.json(function(e){t.appendLog(e.msg)},function(e){t.appendLog(e)}):t.appendLog("saved")},function(e){t.appendLog(e)}):n.setValue("no file are opened, cannot executeSave")},a.getAllText=function(){return a.getAceEditor().getValue()},a.getSelection=function(){var e=a.getAceEditor().getSelectionRange();return a.getAceEditor().session.getTextRange(e)},a.appendToEditor=function(e){var t=a.getAceEditor(),n=t.getCursorPosition();t.session.insert(n,e),t.focus()},a.getAceEditor=function(){return a.aceEditorRef.current.editor},a.getMessageBoxAceEditor=function(){return a.queryApp.messageBox.current.editor},a.appendLog=function(e){var t=a.getMessageBoxAceEditor().session;t.insert({row:t.getLength(),column:0},"\n"+e)},a.getDashBoard=function(){return a.queryApp.dash.current},a.getDisplay=function(){return a.queryApp.display.current},a.enterLoading=function(e){a.commandGroup.current.setState({loading:!0}),a.resourceProgressRef.current.enter({jobName:e}),a.jobProgress.current.enter({jobName:e}),a.taskProgressRef.current.enter({jobName:e})},a.exitLoading=function(){a.commandGroup.current.setState({loading:!1}),a.jobProgress.current.exit(),a.resourceProgressRef.current.exit(),a.taskProgressRef.current.exit()},a.etOver=function(e){var t=a.queryApp.etRef.current,n=t.getData("eventName"),r=t.getData("popName"),c=t.getData("processType"),o=t.getData("pathAlias"),i=t.getData("tableHidden"),l=t.getData("pathHidden"),s=t.getData("outputTableHidden"),u=t.getData("outputTableAlias"),m=t.getData("tableAlias");"direct"===c?a.appendToEditor((new ee).makeSQL(n)):t.setState({etPop:!0,eventName:n,popName:r,processType:c,pathAlias:o,tableHidden:i,pathHidden:l,outputTableHidden:s,outputTableAlias:u,tableAlias:m})},a.language=a.props.language||"sql",a.queryApp=a.props.parent,a.aceEditorRef=n.createRef(),a.commandGroup=n.createRef(),a.resourceProgressRef=n.createRef(),a.jobProgress=n.createRef(),a.taskProgressRef=n.createRef(),a.logMonitor=new pe(a.appendLog),a.cancelQuery=a.cancelQuery.bind(Object(b.a)(Object(b.a)(a))),a.executeQuery=a.executeQuery.bind(Object(b.a)(Object(b.a)(a))),a.state={value:"",loading:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.parentCallback&&this.props.parentCallback(this)}},{key:"onChange",value:function(e){}},{key:"executeQuery",value:function(){var e=Object(J.a)(H.a.mark(function e(){var t,a,n,r,c,o,i,l,s,u;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(){return a.exitLoading(),(new Date).getTime()-c},this.logMonitor.queryLog(),t=fe(),this.enterLoading(t),(a=this).getMessageBoxAceEditor().setValue(""),a.getDisplay().update(JSON.parse("[]")),n=a.getSelection(),r=a.getAllText(),""!==n&&(r=n),c=(new Date).getTime(),i=this.commandGroup.current.state.timeout,this.jobName=t,l=new me,e.next=16,l.runScript(r,t,{jobName:t,background:this.state.background||!1,timeout:i});case 16:s=e.sent;try{this.logMonitor.cancelQueryLog(),a.exitLoading(),this.jobName=null}catch(m){}if(200===s.status){e.next=23;break}u="";try{u=JSON.parse(s.content)[0].msg}catch(m){u=s.content}return a.appendLog(u+"\nTime cost:"+o()+"ms"),e.abrupt("return");case 23:if(200===s.status)try{a.queryApp.setData(s.content),a.getDisplay().update(s.content),a.appendLog("\nTime cost:"+o()+"ms")}catch(m){console.log(m),a.appendLog("Can not display the result. raw data:\n"+JSON.stringify(s.content,null,2))}case 24:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancelQuery",value:function(){var e=Object(J.a)(H.a.mark(function e(){var t,a,n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.jobName){e.next=2;break}return e.abrupt("return");case 2:return t=fe(),a=new me,e.next=6,a.runScript("!kill "+this.jobName+";",t,{});case 6:n=e.sent;try{this.appendLog(n.content[0].description)}catch(r){this.appendLog(n.content)}this.jobName=null,this.logMonitor.cancelQueryLog();case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"mlsql-editor-area"},n.createElement("div",{onDragOver:function(e){return e.preventDefault()},onDrop:this.etOver},n.createElement(ae.Resizable,{defaultSize:{height:"500px"},onResize:function(){e.aceEditorRef.current.editor.resize()}},n.createElement($.a,{ref:this.aceEditorRef,mode:this.language,theme:"github",width:"100%",height:"100%",onChange:this.onChange,name:"mlsql_editor",fontSize:16,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,editorProps:{$blockScrolling:1/0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2,autoScrollEditorIntoView:!0}}))),n.createElement(ge,{ref:this.commandGroup,parent:this}),n.createElement(Ee,{ref:this.jobProgress,parent:this}),n.createElement(ye,{ref:this.taskProgressRef,parent:this}),n.createElement(ve,{ref:this.resourceProgressRef,parent:this}))}}]),t}(n.Component),ge=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){a.setState({timeout:e})},a.state={loading:!1,timeout:"-1"},a.parent=e.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:"mslql-editor-buttons"},n.createElement(Y.a,{onClick:this.parent.executeQuery,loading:this.state.loading},"Run"),n.createElement(Y.a,{onClick:this.parent.cancelQuery},"Cancel"),n.createElement(Y.a,{onClick:this.parent.executeSave},"Save"),"Job Timeout:",n.createElement(te.a,{onChange:this.onChange,style:{width:"120px"}},n.createElement(he,{value:"10000"},"10s"),n.createElement(he,{value:"30000"},"30s"),n.createElement(he,{value:"60000"},"60s"),n.createElement(he,{value:"1800000"},"30m"),n.createElement(he,{value:"7200000"},"2h"),n.createElement(he,{value:"28800000"},"8h"),n.createElement(he,{value:"-1"},"unlimited")))}}]),t}(n.Component),Ee=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).enter=function(e){var t=Object(b.a)(Object(b.a)(a));a.setState({mark:!0}),setTimeout(function(){t.state.mark&&(t.setState({loading:!0}),t.intervalTimer=setInterval(function(){if("loading"!==t.resourceCompute){t.resourceCompute="loading";var a=new w(x);Z(e.hasOwnProperty("jobName"),"jobName is required");var n=e.jobName;a.runScript({},"load _mlsql_.`jobs/get/".concat(n,"` as wow;"),function(e){var a=e[0];console.log(a);var n=a.progress.currentJobIndex/a.progress.totalJob*100;t.setState({percent:n,successPercent:n,title:"Jobs: current/Total: ".concat(a.progress.currentJobIndex,"/").concat(a.progress.totalJob,")")}),t.resourceCompute="loaded"},function(e){t.resourceCompute="loaded";try{t.parent.appendLog(e)}catch(a){console.log(a)}})}},1e3))},1e3)},a.exit=function(){a.setState({loading:!1,percent:0,successPercent:0,mark:!1}),a.intervalTimer&&clearInterval(a.intervalTimer)},a.state={loading:!1,percent:0,successPercent:0,mark:!1},a.parent=e.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.loading?n.createElement("div",null,this.state.title,n.createElement(X.a,{percent:this.state.percent,successPercent:this.state.successPercent})):n.createElement("div",null)}}]),t}(n.Component),ve=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).enter=function(e){var t=Object(b.a)(Object(b.a)(a));a.setState({mark:!0}),setTimeout(function(){t.state.mark&&(t.setState({loading:!0}),t.intervalTimer=setInterval(function(){if("loading"!==t.resourceCompute){t.resourceCompute="loading";var a=new w(x);Z(e.hasOwnProperty("jobName"),"jobName is required");var n=e.jobName;a.runScript({},"load _mlsql_.`resource/".concat(n,"` as output;"),function(e){var a=e[0];t.setState({percent:a.activeTasks/a.totalCores*100,successPercent:a.currentJobGroupActiveTasks/a.totalCores*100,title:"Resource (for all users): taken/Total: ".concat(a.activeTasks,"/").concat(a.totalCores,"(").concat(a.currentJobGroupActiveTasks," you took)")}),t.resourceCompute="loaded"},function(e){t.resourceCompute="loaded";try{t.parent.appendLog(e)}catch(a){console.log(a)}})}},1e3))},1e3)},a.exit=function(){a.setState({loading:!1,percent:0,successPercent:0,mark:!1}),a.intervalTimer&&clearInterval(a.intervalTimer)},a.state={loading:!1,percent:0,successPercent:0,mark:!1},a.parent=e.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.loading?n.createElement("div",null,this.state.title,n.createElement(X.a,{percent:this.state.percent,successPercent:this.state.successPercent})):n.createElement("div",null)}}]),t}(n.Component),ye=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).enter=function(e){var t=Object(b.a)(Object(b.a)(a));a.setState({mark:!0}),setTimeout(function(){t.state.mark&&(t.setState({loading:!0}),t.intervalTimer=setInterval(function(){if("loading"!==t.taskCompute){t.taskCompute="loading";var a=new w(x);Z(e.hasOwnProperty("jobName"),"jobName is required");var n=e.jobName;a.runScript({},"load _mlsql_.`jobs/".concat(n,"` as output;"),function(e){t.taskCompute="loaded";var a=e[0],n={numTasks:0,numActiveTasks:0,numCompletedTasks:0};a.activeJobs.forEach(function(e){n.numTasks+=e.numTasks,n.numActiveTasks+=e.numActiveTasks,n.numCompletedTasks+=e.numCompletedTasks}),t.setState({percent:n.numActiveTasks/n.numTasks*100,successPercent:n.numCompletedTasks/n.numTasks*100,title:"Tasks (for all stages): Succeeded/Total:\n".concat(n.numCompletedTasks,"/").concat(n.numTasks,"(").concat(n.numActiveTasks," running)")})},function(e){t.taskCompute="loaded";try{t.parent.appendLog(e)}catch(a){console.log(a)}})}},1e3))},1e3)},a.exit=function(){a.taskCompute="loaded",a.resourceCompute="loaded",a.setState({loading:!1,percent:0,successPercent:0,mark:!1}),a.intervalTimer&&clearInterval(a.intervalTimer)},a.state={loading:!1,percent:0,successPercent:0,mark:!1},a.parent=e.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.loading?n.createElement("div",null,this.state.title,n.createElement(X.a,{percent:this.state.percent,successPercent:this.state.successPercent})):n.createElement("div",null)}}]),t}(n.Component),Oe=be,je=a(418),Se=(a(580),a(322)),ke=a(216),we=a(185),Ce=a(189),Te=a(93),De=a(1005),Ne=a(191),xe=a(193),Re=a(2),Me=a.n(Re),Ie=(a(581),function e(){Object(i.a)(this,e),this.build=function(e){var t,a,n={},r=[];for(a=0;a<e.length;a+=1)n[e[a].id]=a,e[a].childNodes=[];for(a=0;a<e.length;a+=1)if(0!==(t=e[a]).parentId)try{e[n[t.parentId]].childNodes.push(t)}catch(c){console.log("------------"),console.log(t),console.log(n[t.parentId])}else r.push(t);return r}}),_e=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).reloadData=function(){var e=new w(T),t=Object(b.a)(Object(b.a)(a));e.request(v.GET,{},function(e){e.content.then(function(e){var a=[];try{a=JSON.parse(e||"[]")}catch(r){}var n=(new Ie).build(a).sort(function(e,t){return e.id-t.id});t.setState({nodes:n})})},function(e){})},a.isRootNode=function(e){return a.state.nodes[0].id===e},a.onNodeContextMenu=function(e,t,r){r.preventDefault();var c=Object(b.a)(Object(b.a)(a));De.a.show(n.createElement(Le,{isDir:e.isDir,parent:c,nodeId:e.id}),{left:r.clientX,top:r.clientY},function(){return a.setState({isContextMenuOpen:!1})}),a.setState({isContextMenuOpen:!0})},a.handNodeDoubleClick=function(e,t,n){if(e.isDir)e.isExpanded=!e.isExpanded,a.toggleIsExpanded(e.id,e.isExpanded);else{var r=new w(N),c=Object(b.a)(Object(b.a)(a));r.request(v.GET,{id:e.id},function(t){t.content.then(function(t){var a=JSON.parse(t||"{}");c.parent.openExistsOrNewEditor({id:e.id,content:a.content,name:a.name})})},function(e){})}a.setState(a.state)},a.handleNodeClick=function(e,t,n){var r=e.isSelected;n.shiftKey||a.forEachNode(a.state.nodes,function(e){return e.isSelected=!1}),e.isSelected=null==r||!r,a.setState(a.state)},a.toggleIsExpanded=function(e,t){var n=new w(T);Object(b.a)(Object(b.a)(a));n.request(v.POST,{id:e,isExpanded:t},function(e){e.content.then(function(e){})},function(e){})},a.handleNodeCollapse=function(e){e.isExpanded=!1,a.toggleIsExpanded(e.id,!1),a.setState(a.state)},a.handleNodeExpand=function(e){e.isExpanded=!0,a.toggleIsExpanded(e.id,!0),a.setState(a.state)},a.state={isContextMenuOpen:!1,openCreateScriptDialog:!1},a.parent=a.props.parent,a.reloadData(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(Se.a,{contents:this.state.nodes,onNodeClick:this.handleNodeClick,onNodeCollapse:this.handleNodeCollapse,onNodeExpand:this.handleNodeExpand,onNodeContextMenu:this.onNodeContextMenu,onNodeDoubleClick:this.handNodeDoubleClick,className:"mlsql-directory-tree"}),this.state.openCreateScriptDialog?n.createElement(Pe,{nodeId:this.state.nodeId,parent:this,queryApp:this.parent}):"")}},{key:"forEachNode",value:function(e,t){if(null!=e){var a=!0,n=!1,r=void 0;try{for(var c,o=e[Symbol.iterator]();!(a=(c=o.next()).done);a=!0){var i=c.value;t(i),this.forEachNode(i.childNodes,t)}}catch(l){n=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}}}}]),t}(n.Component),Pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).title=function(){return a.props.parent.state.isDir?"Create Folder":"Create Script"},a.fileName=function(e){a.setState({fileName:e.target.value})},a.content=function(e){a.setState({content:e.target.value})},a.finish=function(){a.props.parent.setState({openCreateScriptDialog:!1}),a.props.parent.reloadData()},a.create=function(){var e=new w(T),t=Object(b.a)(Object(b.a)(a)),n={fileName:a.state.fileName,isDir:a.props.parent.state.isDir,content:a.state.content,parentId:a.props.nodeId};n.fileName?n.isDir||n.fileName.endsWith(".mlsql")||n.fileName.endsWith(".nb")||n.fileName.endsWith(".py")?e.request(v.POST,n,function(e){e.status===y.Success?t.finish():e.content.then(function(e){a.setState({msg:e})})},function(e){t.setState({msg:"Server error"})}):a.setState({msg:"filename should be ends with .mlsql or .nb or .py"}):a.setState({msg:"filename should not be empty"})},a.close=function(){var e=a.props.parent;e.setState({openCreateScriptDialog:!1}),e.reloadData()},a.state={msg:""},a.messageBox=a.props.queryApp.messageBox.current.editor,a.directoryTree=a.props.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=Me()(ke.a.CARD,ke.a.ELEVATION_4,"docs-md-overlay-example-transition");return n.createElement("div",null,n.createElement(we.a,{className:"msql-treenode-dialog",isOpen:!0,usePortal:!0},n.createElement("div",{className:e},n.createElement(Ce.a,null,this.title()," "),n.createElement("div",{className:"msql-treenode-dialog-form"},n.createElement("p",{style:{color:"red"}},this.state.msg),n.createElement(g.a,{helperText:"The file of name you want create.",label:"fileName",labelFor:"fileName",labelInfo:"(required)"},n.createElement(E.a,{id:"fileName",placeholder:"example.mlsql",onChange:this.fileName}))),n.createElement("br",null),n.createElement(h.a,{onClick:this.create},"Create"),n.createElement(h.a,{intent:Te.a.DANGER,onClick:this.close,style:{float:"right"}},"Close"))))}}]),t}(n.Component),Le=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).confirmDelete=function(){Object(je.confirmAlert)({title:"Confirm to delete",message:"Are you sure to do this \uff1f",buttons:[{label:"confirm",onClick:function(){return a.removeFile()}},{label:"cancel",onClick:function(){}}],closeOnEscape:!0,closeOnClickOutside:!1})},a.removeFile=function(){var e=new w(D),t=Object(b.a)(Object(b.a)(a));e.request(v.POST,{id:t.nodeId},function(e){e.status===y.Success?t.parent.reloadData():e.content.then(function(e){t.parent.setState({msg:e})})},function(e){t.parent.setState({msg:"Server error"})})},a.isCreateProject=function(){return a.parent.isRootNode(a.nodeId)},a.createDocMenuItem=function(){if(!a.isCreateProject()&&a.isDir)return n.createElement(Ne.a,{icon:"document",text:"Create Script",onClick:function(){a.parent.setState({openCreateScriptDialog:!0,nodeId:a.nodeId,isDir:!1})}.bind(Object(b.a)(Object(b.a)(a)))})},a.createFolderTitle=function(){return a.isCreateProject()?"Create Project":"Create Folder"},a.createFolder=function(){return a.isDir?n.createElement(Ne.a,{icon:"folder-new",text:a.createFolderTitle(),onClick:function(){a.parent.setState({openCreateScriptDialog:!0,nodeId:a.nodeId,isDir:!0})}.bind(Object(b.a)(Object(b.a)(a)))}):a.isCreateProject()?n.createElement(Ne.a,{icon:"folder-new",text:"Create Project",onClick:function(){a.parent.setState({openCreateScriptDialog:!0,nodeId:a.nodeId,isDir:!0})}.bind(Object(b.a)(Object(b.a)(a)))}):void 0},a.deleteMenu=function(){if(!a.isCreateProject())return n.createElement(Ne.a,{icon:"remove",text:"Delete",onClick:function(){a.confirmDelete()}.bind(Object(b.a)(Object(b.a)(a)))})},a.parent=a.props.parent,a.nodeId=a.props.nodeId,a.isDir=a.props.isDir,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(xe.a,null,this.createDocMenuItem(),this.createFolder(),this.deleteMenu()))}}]),t}(n.Component),Ae=(a(240),a(996)),qe=a(1002),Be=a(117),Ve=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).setRender=function(e,t){var r=t[0][e.key];if(a.state.config&&a.state.config.render){var c=a.state.config.render[e.key];c&&(e.render=c)}else{try{if(n.Component.isPrototypeOf(r.type))return void(e.render=function(e){return n.createElement("span",null,e)})}catch(o){}"object"!==typeof r?"array"!==typeof r?"boolean"!==typeof r?"fileSystem"!=e.key&&"message"!=e.key&&"info"!=e.key||(e.render=function(e){return n.createElement("pre",null,e.toString())}):e.render=function(e){return n.createElement("span",null,e.toString())}:e.render=function(e){return n.createElement("span",null,e.join(",").substring(0,300))}:e.render=function(e){return n.createElement("span",null,JSON.stringify(e).substring(0,300))}}},a.update=function(e,t){a.setState({config:t});var n=[],r={},c=[],o=Object(b.a)(Object(b.a)(a));e.forEach(function(t){for(var a in t)if(!r[a]){var c={title:a,dataIndex:a,key:a};o.setRender(c,e),n.push(c),r[a]=!0}}),e.forEach(function(e,t){var a={};n.forEach(function(t){a[t.key]=e[t.key]}),a.key=t,c.push(a)}),a.setState({columns:n,data:c})},a.rowDoubleClick=function(e,t,n){"codeExample"!==e.name&&"doc"!==e.name||a.setState({view:{enabled:!0,content:e.value}})},a.disablePreview=function(){a.setState({view:{enabled:!1}})},a.state={columns:[],rows:[],view:{enabled:!1}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(Ae.a,{onRow:function(t,a){return{onDoubleClick:function(n){e.rowDoubleClick(t,a,n)}}},columns:this.state.columns,dataSource:this.state.data}),n.createElement(qe.a,{title:"View",visible:this.state.view.enabled,onCancel:this.disablePreview,onOk:this.disablePreview,cancelText:"Cancel",OkText:"Ok"},n.createElement(Be,{source:this.state.view.content||""})))}}]),t}(n.Component),Fe=a(1e3),Ue=a(447),Ge=a(445),ze=a(428),Qe=a.n(ze),Ke={width:200,height:200,borderWidth:2,borderColor:"#666",borderStyle:"dashed",borderRadius:5},He={borderStyle:"solid",borderColor:"#6c6",backgroundColor:"#eee"},Je={borderStyle:"solid",borderColor:"#c66",backgroundColor:"#eee"},We={display:"flex"},$e=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).onDrop=function(t){e.setState({files:t});var a=Qe.a.post(R);a.set("Access-Token",sessionStorage.getItem(O.name)||""),t.forEach(function(e){a.attach(e.path,e)}),a.end(function(a,n){e.setState({files:[]}),a?(console.log(a),e.setState({msg:a.toString()+"\n Sometimes this caused by your upload space is not enough or backend fails"})):n.ok&&e.setState({msg:"total files:"+t.length+" are uploaded. \n You can check the files with command: !hdfs -ls /tmp/upload; "})})},e.state={files:[]},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.files.map(function(e){return r.a.createElement("li",{key:e.name},e.path," - ",e.size," bytes")});return r.a.createElement("section",{style:We},r.a.createElement("div",null,r.a.createElement(Ue.a,{onDrop:this.onDrop,getDataTransferItems:function(e){return Object(Ge.a)(e)}},function(e){var t=e.getRootProps,a=e.getInputProps,n=e.isDragActive,c=e.isDragAccept,o=e.isDragReject,i=(e.acceptedFiles,e.rejectedFiles,Object(ne.a)({},Ke));return i=n?Object(ne.a)({},i,He):i,i=o?Object(ne.a)({},i,Je):i,r.a.createElement("div",Object.assign({},t(),{style:i}),r.a.createElement("input",a()),r.a.createElement("div",null,c?"Drop":"Drag"," files here..."),o&&r.a.createElement("div",null,"Unsupported file type..."))})),r.a.createElement("aside",null,r.a.createElement("h4",null,0==e.length?"":"Files"),r.a.createElement("ul",null,e)),r.a.createElement("div",null,this.state.msg?this.state.msg:""))}}]),t}(r.a.Component),Ye=(a(746),a(293)),Xe=a(279),Ze=a.n(Xe),et=a(153),tt=a(30),at=a(401),nt=function(){var e=at();return"#000000"===e&&(e="#8884d8"),e},rt=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"render",value:function(e){var t=e[0].hasOwnProperty("z");e.hasOwnProperty("dataType")||e.forEach(function(e){e.dataType="default",t||(e.z=0)});var a=e.reduce(function(e,t){t.x,t.y,t.z;var a=t.dataType,n=e.get(a);return n?n.push(t):e.set(a,[t]),e},new Map),n=e[0]._dash_config||{},c=Object(et.a)(a.keys()).map(function(e){var t=Object.assign({fill:nt(),shape:"triangle"},n[e]||{});return r.a.createElement(tt.g,Object.assign({key:e,name:e,data:a.get(e)},t))}),o=Object.assign({type:"number",dataKey:"x"},n.x||{}),i=Object.assign({type:"number",dataKey:"y"},n.y||{}),l=Object.assign({type:"number",dataKey:"z"},n.z||{});return r.a.createElement(tt.h,{width:400,height:400,margin:{top:20,right:20,bottom:20,left:20}},r.a.createElement(tt.c,null),r.a.createElement(tt.j,o),r.a.createElement(tt.k,i),t?r.a.createElement(tt.l,l):"",r.a.createElement(tt.i,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(tt.d,null),c)}}]),e}();rt.basicCheck=function(e,t){if(e.length<1)return!1;try{return t(e[0])}catch(a){return!1}return!0},rt.isShouldRender=function(e){return rt.basicCheck(e,function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&(e.hasOwnProperty("_dash_config")||e.hasOwnProperty("dash"))&&("scatter"===e.dash||"scatter"===(e._dash_config||{}).dash)})};var ct=a(401),ot=function(){var e=ct();return"#000000"===e&&(e="#8884d8"),e},it=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"render",value:function(e){var t=e[0],a=[],n=t._dash_config||{};return"line"===t.dash||"line"===n.dash?(Object.keys(t).forEach(function(e){if("number"===typeof t[e]){var c=Object.assign({stroke:ot()},n[e]||{});a.push(r.a.createElement(tt.e,Object.assign({key:e,type:"monotone",dataKey:e},c)))}}),r.a.createElement(tt.f,{width:500,height:300,data:e,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(tt.c,{strokeDasharray:"3 3"}),r.a.createElement(tt.j,{dataKey:"x"}),r.a.createElement(tt.k,null),r.a.createElement(tt.i,null),r.a.createElement(tt.d,null),a)):"bar"===t.dash||"bar"===n.dash?(Object.keys(t).forEach(function(e){if("number"===typeof t[e]){var c=Object.assign({fill:ot()},n[e]||{});a.push(r.a.createElement(tt.a,Object.assign({key:e,dataKey:e},c)))}}),r.a.createElement(tt.b,{width:500,height:300,data:e,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(tt.c,{strokeDasharray:"3 3"}),r.a.createElement(tt.j,{dataKey:"x"}),r.a.createElement(tt.k,null),r.a.createElement(tt.i,null),r.a.createElement(tt.d,null),a)):void 0}}]),e}();it.basicCheck=function(e,t){if(e.length<1)return!1;try{return t(e[0])}catch(a){return!1}return!0},it.isShouldRender=function(e){return it.basicCheck(e,function(e){return e.hasOwnProperty("x")&&(e.hasOwnProperty("dash")||e.hasOwnProperty("_dash_config"))})};var lt=a(106),st=a.n(lt),ut=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).renderStream=function(){var e=a.state.data,t=[],n=[];e.forEach(function(e){var a=JSON.parse(e.value),r=st.a.utc(a.timestamp).format("DD,h:mm:ss");t.push({x:r,inputRowsPerSecond:a.inputRowsPerSecond,processedRowsPerSecond:a.processedRowsPerSecond}),n.push({x:r,numInputRows:a.numInputRows})}),a.setState({dataForRender:t,dataForRender2:n})},a.queryApp=e.parent.parent,a.state={data:e.data,dataForRender:[],titleMap:{}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.renderStream()}},{key:"render",value:function(){return 0===this.state.dataForRender.length?null:r.a.createElement("div",null,r.a.createElement(tt.f,{width:800,height:300,data:this.state.dataForRender},r.a.createElement(tt.e,{type:"monotone",dataKey:"inputRowsPerSecond",stroke:"#8884d8"}),r.a.createElement(tt.e,{type:"monotone",dataKey:"processedRowsPerSecond",stroke:"#82ca9d"}),r.a.createElement(tt.c,{stroke:"#ccc"}),r.a.createElement(tt.j,{dataKey:"x"}),r.a.createElement(tt.k,null),r.a.createElement(tt.d,null)),r.a.createElement(tt.f,{width:800,height:300,data:this.state.dataForRender2},r.a.createElement(tt.e,{type:"monotone",dataKey:"numInputRows",stroke:"#8884d8"}),r.a.createElement(tt.c,{stroke:"#ccc"}),r.a.createElement(tt.j,{dataKey:"x"}),r.a.createElement(tt.k,null),r.a.createElement(tt.d,null)))}}]),t}(n.Component);ut.isStream=function(e){if(e.length<1)return!1;try{if(!JSON.parse(e[0].value).runId)return!1}catch(t){return!1}return!0},ut.isShouldRender=function(e){return ut.isStream(e)},ut.renderRawData=function(e){if(!ut.isShouldRender(e))return"";var t=[];return e.forEach(function(e){var a=JSON.parse(e.value);t.push(JSON.stringify(a,null,2))}),t.join("\n")};var mt=a(154),dt=a(280),pt=a.n(dt),ht=a(284),ft=a.n(ht),bt=a(82),gt=a.n(bt),Et=a(210),vt=a.n(Et),yt=a(85),Ot=a.n(yt),jt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).resourceRender=function(){var e=a.state.data[0],t=[{x:"used",y:e.activeTasks},{x:"free",y:e.totalCores-e.activeTasks}],n=[{x:"taskTime",y:e.taskTime},{x:"gcTime",y:e.gcTime}],c=[{x:"used",y:e.activeExecutorNum},{x:"free",y:e.totalExecutorNum-e.activeExecutorNum}],o=-1===e.totalMemory?[]:[{x:"used",y:e.usedMemory/1048576},{x:"free",y:(e.totalMemory-e.usedMemory)/1048576}],i=function(t,a,n){return r.a.createElement(pt.a,{title:t,action:r.a.createElement(ft.a,{title:a},r.a.createElement(gt.a,{type:"info-circle-o"})),total:function(){return r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.shuffleData[n]/1048576}})}})},l=i("Disk Spilled","The size(M) spilled in disk","diskBytesSpilled"),s=i("Memory Spilled","The memory size(M) spilled in disk","memoryBytesSpilled"),u=i("InputRecords","Current active jobs have processed how many records","inputRecords");return r.a.createElement("div",null,r.a.createElement(vt.a,null,r.a.createElement(Ot.a,{span:6},r.a.createElement(mt.Pie,{hasLegend:!0,title:"CPU",subTitle:"CPU",total:function(){return r.a.createElement("span",{dangerouslySetInnerHTML:{__html:t.reduce(function(e,t){return t.y+e},0)}})},data:t,valueFormat:function(e){return r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e}})},height:200})),r.a.createElement(Ot.a,{span:6},r.a.createElement(mt.Pie,{hasLegend:!0,title:"Memory",subTitle:"Memory",total:function(){return r.a.createElement("span",{dangerouslySetInnerHTML:{__html:(o.reduce(function(e,t){return t.y+e},0)+"").split(".")[0]+"M"}})},data:o,valueFormat:function(e){return r.a.createElement("span",{dangerouslySetInnerHTML:{__html:(e+"").split(".")[0]+"M"}})},height:200})),r.a.createElement(Ot.a,{span:6},r.a.createElement(mt.Pie,{hasLegend:!0,title:"Task/GC",subTitle:"Task/GC",total:function(){return r.a.createElement("span",{dangerouslySetInnerHTML:{__html:n.reduce(function(e,t){return t.y+e},0)}})},data:n,valueFormat:function(e){return r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e}})},height:200})),r.a.createElement(Ot.a,{span:6},r.a.createElement(mt.Pie,{hasLegend:!0,title:"Executors",subTitle:"Executors",total:function(){return r.a.createElement("span",{dangerouslySetInnerHTML:{__html:c.reduce(function(e,t){return t.y+e},0)}})},data:c,valueFormat:function(e){return r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e}})},height:200}))),r.a.createElement(vt.a,null,r.a.createElement(Ot.a,{span:8},l),r.a.createElement(Ot.a,{span:8},s),r.a.createElement(Ot.a,{span:8},u)))},a.queryApp=e.parent.parent,a.state={data:e.data,dataForRender:[],titleMap:{}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.resourceRender()}}]),t}(n.Component);jt.isResource=function(e){if(e.length<1)return!1;var t=e[0];try{return t.hasOwnProperty("activeTasks")&&t.hasOwnProperty("totalCores")&&t.hasOwnProperty("activeExecutorNum")}catch(a){return!1}},jt.isShouldRender=function(e){return jt.isResource(e)};var St=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"render",value:function(e){var t=e[0];return r.a.createElement(kt,{data:t})}}]),e}();St.basicCheck=function(e,t){if(e.length<1)return!1;try{return t(e[0])}catch(a){return!1}return!0},St.isShouldRender=function(e){return St.basicCheck(e,function(e){return e.hasOwnProperty("html")&&(e.hasOwnProperty("dash")||e.hasOwnProperty("_dash_config"))})};var kt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).refresh=function(e){a.setState({data:e})},a.state={data:a.props.data},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(ae.Resizable,{defaultSize:{height:"500px"}},r.a.createElement("iframe",{sandbox:"allow-scripts",style:{width:"100%",height:"100%"},srcDoc:this.state.data.html,frameBorder:"0",scrolling:"yes",ref:function(t){e.ifr=t}})))}}]),t}(r.a.Component),wt=Fe.a.Panel,Ct=Ye.a.TabPane;function Tt(e){}var Dt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).isNormalXY=function(e){return t.basicCheck(e,function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&"number"===typeof e.y})},a.xYRender=function(e){return r.a.createElement(Ze.a,{height:200,title:"Bar",data:e})},a.renderDash=function(){var e=a.state.data;return jt.isShouldRender(e)?r.a.createElement(jt,{data:e,parent:Object(b.a)(Object(b.a)(a))}):ut.isShouldRender(e)?r.a.createElement(ut,{data:e,parent:Object(b.a)(Object(b.a)(a))}):rt.isShouldRender(e)?rt.render(e):a.isNormalXY(e)?a.xYRender(e):it.isShouldRender(e)?it.render(e):St.isShouldRender(e)?St.render(e):r.a.createElement("div",null)},a.queryApp=e.parent,a.state={data:[],dataForRender:[],titleMap:{}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"refresh",value:function(){try{var e=this.queryApp.queryResData||[];this.setState({data:e})}catch(t){}}},{key:"render",value:function(){return r.a.createElement(Fe.a,{onChange:Tt},r.a.createElement(wt,{header:"Tools/Dashboard",key:"1"},r.a.createElement(Ye.a,{defaultActiveKey:"1",onChange:Tt},r.a.createElement(Ct,{tab:"Upload",key:"1"},r.a.createElement($e,null)),r.a.createElement(Ct,{tab:"Dashboard",key:"2"},this.renderDash()),r.a.createElement(Ct,{tab:"RawData",key:"3"},r.a.createElement("pre",null,ut.renderRawData(this.state.data))))))}}]),t}(n.PureComponent);Dt.basicCheck=function(e,t){if(e.length<1)return!1;try{return t(e[0])}catch(a){return!1}return!0};var Nt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).originalEditor=function(){return a.editor.editor},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.originalEditor().container.style.lineHeight=3}},{key:"render",value:function(){var e=this;return r.a.createElement($.a,{maxLines:1/0,width:"100%",ref:function(t){e.editor=t},value:this.props.initialCode,mode:"sql",theme:"github"})}}]),t}(r.a.Component),xt=a(21),Rt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).evtExecute=function(){a.setState({isExecute:!0}),a.state.executeUnit.execute()},a.cancelExecute=function(){a.setState({isExecute:!1})},a.state={isExecute:!1,executeUnit:e.executeUnit},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.state.isExecute?r.a.createElement("span",{onClick:this.cancelExecute},r.a.createElement(xt.a,{type:"sync",spin:!0})):r.a.createElement("span",{onClick:this.evtExecute},r.a.createElement(xt.a,{type:"caret-right"})))}}]),t}(r.a.Component),Mt=a(135),It=function e(t){var a=this;Object(i.a)(this,e),this.run=function(e,t,n){var r=Mt();new w(x).newRunScript({jobName:r,timeout:a.timeout},e,t,n)},this.saveFile=function(e,t,a){new w(T).request(v.POST,{id:t,content:e},function(e){200!=e.status?e.json(function(e){a(e.msg)},function(e){a(e)}):a("saved")},function(e){a(e)})},this.timeout=t},_t=a(295),Pt=a(117),Lt=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).setRender=function(e,t,r){var c=t[0][e.key];if(r&&r.render){var o=a.state.config.render[e.key];o&&(e.render=o)}else{try{if(n.Component.isPrototypeOf(c.type))return void(e.render=function(e){return n.createElement("span",null,e)})}catch(i){}"object"!==typeof c?"array"!==typeof c?"boolean"!==typeof c?"fileSystem"!=e.key&&"message"!=e.key&&"info"!=e.key||(e.render=function(e){return n.createElement("pre",null,e.toString())}):e.render=function(e){return n.createElement("span",null,e.toString())}:e.render=function(e){return n.createElement("span",null,e.join(",").substring(0,300))}:e.render=function(e){return n.createElement("span",null,JSON.stringify(e).substring(0,300))}}},a.parseData=function(e,t){var n=[],r={},c=[],o=Object(b.a)(Object(b.a)(a));return e.forEach(function(t){for(var a in t)if(!r[a]){var c={title:a,dataIndex:a,key:a};o.setRender(c,e),n.push(c),r[a]=!0}}),e.forEach(function(e,t){var a={};n.forEach(function(t){a[t.key]=e[t.key]}),a.key=t,c.push(a)}),[n,c]},a.refresh=function(e,t){var n=a.parseData(e,t),r=Object(_t.a)(n,2),c=r[0],o=r[1];a.setState({columns:c,rows:o,config:t})},a.rowDoubleClick=function(e,t,n){"codeExample"!==e.name&&"doc"!==e.name||a.setState({view:{enabled:!0,content:e.value}})},a.disablePreview=function(){a.setState({view:{enabled:!1}})};var r=a.parseData(e.data||[],e.config||{}),c=Object(_t.a)(r,2),o=c[0],l=c[1];return a.state={columns:o,rows:l,view:{enabled:!1}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(Ae.a,{onRow:function(t,a){return{onDoubleClick:function(n){e.rowDoubleClick(t,a,n)}}},columns:e.state.columns,dataSource:e.state.rows}),n.createElement(qe.a,{title:"View",visible:e.state.view.enabled,onCancel:e.disablePreview,onOk:e.disablePreview,cancelText:"Cancel",OkText:"Ok"},n.createElement(Pt,{source:e.state.view.content||""})))}}]),t}(n.Component),At=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).refresh=function(e){if(a.setState({displayData:e,errorMsg:""}),a.displayTableRef&&a.displayTableRef.refresh(a.state.displayData,{}),a.displayDashRef){var t=a.state.displayData[0];a.displayDashRef.refresh(t)}},a.fail=function(e){a.setState({errorMsg:e}),a.editor&&a.editor.editor.setValue(e)},a.displayDash=function(){if(a.state.displayData&&St.isShouldRender(a.state.displayData)){var e=a.state.displayData[0];return r.a.createElement(kt,{data:e,ref:function(e){return a.displayDashRef=e}})}return r.a.createElement("div",null)},a.displayError=function(){return a.state.errorMsg?r.a.createElement("div",null,r.a.createElement($.a,{maxLines:1/0,width:"100%",ref:function(e){a.editor=e},value:a.state.errorMsg,mode:"text",theme:"ace/theme/textmate"})):r.a.createElement("div",null)},a.displayTable=function(){return a.state.displayData?r.a.createElement(Lt,{data:a.state.displayData,ref:function(e){return a.displayTableRef=e}}):r.a.createElement("div",null)},a.state={errorMsg:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.displayError(),this.displayTable(),this.displayDash())}}]),t}(r.a.Component),qt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).execute=function(){var e=a.codeBlock.originalEditor().getValue();new It(3e5).run(e,function(e){a.displayGroup.refresh(e),a.commandGroup.setState({isExecute:!1}),a.notebook.nextExecuteUnit()},function(e){a.displayGroup.fail(e),a.commandGroup.setState({isExecute:!1})})},a.codeBlockIsEmpty=function(){return""===a.getCodeStr()},a.getCodeStr=function(){return a.codeBlock.originalEditor().getValue()},a.notebook=e.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(Nt,{initialCode:this.props.initialCode,ref:function(t){e.codeBlock=t},executeUnit:this}),r.a.createElement(Rt,{ref:function(t){e.commandGroup=t},executeUnit:this}),r.a.createElement(At,{ref:function(t){return e.displayGroup=t}}))}}]),t}(r.a.Component),Bt="set notebooksplitter='notebooksplitter';",Vt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).createNewExecuteUnit=function(e){return r.a.createElement(qt,{parent:Object(b.a)(Object(b.a)(a)),initialCode:e,ref:function(e){return a.addRef(e)}})},a.addRef=function(e){e&&a.executeUnitRefs.push(e)},a.nextExecuteUnit=function(){a.executeUnitRefs.slice(-1)[0].codeBlockIsEmpty()||(a.executeUnits.push(a.createNewExecuteUnit()),a.setState({executeUnits:a.executeUnits})),a.saveNoteBook()},a.saveNoteBook=function(){var e=a.executeUnitRefs.map(function(e){return e.getCodeStr()}).join(Bt);a.engine.saveFile(e,a.scriptId,function(e){})},a.text=function(e,t){a.scriptId=t,a.initialCode=e,e&&"undefined"!==e&&(a.executeUnitRefs=[],a.executeUnits=a.initialCode.split(Bt).map(function(e){return a.createNewExecuteUnit(e)}),a.setState({executeUnits:a.executeUnits}))},a.executeUnitRefs=[],a.executeUnits=[a.createNewExecuteUnit("")],a.state={executeUnits:a.executeUnits},a.engine=new It(3e5),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.parentCallback&&this.props.parentCallback(this)}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.executeUnits)}}]),t}(r.a.Component),Ft=(te.a.Option,a(135)),Ut=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).text=function(e,t){a.setState({value:e,scriptId:t},function(){a.aceEditorRef.editor.setValue(e,1)})},a.executeSave=function(){var e=new w(T),t=Object(b.a)(Object(b.a)(a)),n=a.getMessageBoxAceEditor();t.state.scriptId?e.request(v.POST,{id:t.state.scriptId,content:t.getAceEditor().getValue()},function(e){200!=e.status?e.json(function(e){t.appendLog(e.msg)},function(e){t.appendLog(e)}):t.appendLog("saved")},function(e){t.appendLog(e)}):n.setValue("no file are opened, cannot executeSave")},a.getAllText=function(){return a.getAceEditor().getValue()},a.getSelection=function(){var e=a.getAceEditor().getSelectionRange();return a.getAceEditor().session.getTextRange(e)},a.appendToEditor=function(e){var t=a.getAceEditor(),n=t.getCursorPosition();t.session.insert(n,e),t.focus()},a.getAceEditor=function(){return a.aceEditorRef.editor},a.getMessageBoxAceEditor=function(){return a.queryApp.messageBox.current.editor},a.appendLog=function(e){var t=a.getMessageBoxAceEditor().session;t.insert({row:t.getLength(),column:0},"\n"+e)},a.getDashBoard=function(){return a.queryApp.dash.current},a.getDisplay=function(){return a.queryApp.display.current},a.language=a.props.language||"sql",a.queryApp=a.props.parent.queryApp,a.state={value:"",loading:!1},a.executeQuery=a.executeQuery.bind(Object(b.a)(Object(b.a)(a))),a.cancelQuery=a.cancelQuery.bind(Object(b.a)(Object(b.a)(a))),a.logMonitor=new pe(a.appendLog),a.log={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.parentCallback&&this.props.parentCallback(this)}},{key:"onChange",value:function(e){}},{key:"executeQuery",value:function(){var e=Object(J.a)(H.a.mark(function e(){var t,a,n,r,c,o;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.commandGroup.setState({loading:!0}),this.jobName=Ft(),t=new me,(a=this).getMessageBoxAceEditor().setValue(""),a.getDisplay().update(JSON.parse("[]")),n=a.getSelection(),r=a.getAllText(),""!==n&&(r=n),c=a.state.scriptId,this.logMonitor.queryLog(),e.next=13,t.runScript(r,this.jobName,{scriptId:c,runMode:"python",executeMode:"python"});case 13:if(200===(o=e.sent).status){e.next=19;break}return this.logMonitor.cancelQueryLog(),this.appendLog(o.content),this.commandGroup.setState({loading:!1}),e.abrupt("return");case 19:try{this.appendLog(o.content.join("\n"))}catch(i){this.appendLog(o.content.msg)}this.logMonitor.cancelQueryLog(),this.commandGroup.setState({loading:!1});case 22:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancelQuery",value:function(){var e=Object(J.a)(H.a.mark(function e(){var t,a,n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.jobName){e.next=2;break}return e.abrupt("return");case 2:return t=Ft(),a=new me,e.next=6,a.runScript("!kill "+this.jobName+";",t,{});case 6:n=e.sent;try{this.appendLog(n.content[0].description)}catch(r){this.appendLog(n.content)}this.jobName=null,this.logMonitor.cancelQueryLog();case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"mlsql-editor-area"},n.createElement("div",{onDragOver:function(e){return e.preventDefault()},onDrop:this.etOver},n.createElement(ae.Resizable,{defaultSize:{height:"500px"},onResize:function(){e.aceEditorRef.current.editor.resize()}},n.createElement($.a,{ref:function(t){return e.aceEditorRef=t},mode:this.language,theme:"github",width:"100%",height:"100%",onChange:this.onChange,name:"mlsql_editor",fontSize:16,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,editorProps:{$blockScrolling:1/0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2,autoScrollEditorIntoView:!0}}))),n.createElement(Gt,{ref:function(t){return e.commandGroup=t},parent:this}))}}]),t}(n.Component),Gt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){a.setState({timeout:e})},a.state={loading:!1,timeout:"-1"},a.parent=e.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:"mslql-editor-buttons"},n.createElement(Y.a,{onClick:this.parent.executeQuery,loading:this.state.loading},"Run"),n.createElement(Y.a,{onClick:this.parent.cancelQuery},"Cancel"),n.createElement(Y.a,{onClick:this.parent.executeSave},"Save"))}}]),t}(n.Component),zt=Ut,Qt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).addRef=function(e){e&&(a.editor=e)},a.text=function(e,t){a.editor.text(e,t)},a.queryApp=a.props.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.parentCallback&&this.props.parentCallback(this)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(zt,{parent:this,ref:function(t){return e.addRef(t)},language:"python"}))}}]),t}(r.a.Component),Kt=Ye.a.TabPane,Ht=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).pushRef=function(e){a.myRefs.push(e)},a.getCurrentEditor=function(){var e=a.state.activeKey,t=null;return a.myRefs.forEach(function(a){a.activeKey===e&&(t=a)}),t},a.onChange=function(e){var t=null;a.state.panes.forEach(function(a){a.key===e&&(t=a)}),t&&!t.title.endsWith(".mlsql")?a.parent.setState({displayEditor:"normal"}):t&&!t.title.endsWith(".nb")?a.parent.setState({displayEditor:"notebook"}):a.parent.setState({displayEditor:"pythoneditor"}),a.setState({activeKey:e})},a.onEdit=function(e,t){a[t](e)},a.addFull=function(e,t){var r=a.state.panes,c="newTab".concat(a.newTabIndex++);r.push({title:e||"MLSQL "+a.newTabIndex,content:function(r){return e.endsWith(".mlsql")?n.createElement(Oe,{parent:a.parent,parentCallback:function(e){a.pushRef({ref:e,activeKey:r}),t&&t({ref:e,activeKey:r})},activeKey:r}):e.endsWith(".nb")?n.createElement(Vt,{parent:a.parent,parentCallback:function(e){a.pushRef({ref:e,activeKey:r}),t&&t({ref:e,activeKey:r})},activeKey:r}):e.endsWith(".py")?n.createElement(Qt,{parent:a.parent,parentCallback:function(e){a.pushRef({ref:e,activeKey:r}),t&&t({ref:e,activeKey:r})},activeKey:r}):void 0}(c),key:c}),a.setState({panes:r,activeKey:c})},a.add=function(){a.addFull()},a.getPaneIndexByActiveKey=function(e){var t;return a.state.panes.forEach(function(a,n){a.key===e&&(t=n-1)}),t},a.remove=function(e){var t=a.state.activeKey,n=a.getPaneIndexByActiveKey(e),r=a.state.panes.filter(function(t){return t.key!==e});r.length&&t===e&&(t=n>=0?r[n].key:r[0].key);var c=a.myRefs.filter(function(t){return t.activeKey===e});a.myRefs=a.myRefs.filter(function(t){return t.activeKey!==e}),a.parent.closeEditor(c[0]),a.setState({panes:r,activeKey:t})},a.parent=e.parent,a.myRefs=[],a.newTabIndex=0;var r=[{title:"MLSQL 1",content:n.createElement(Oe,{parent:a.parent,parentCallback:function(e){a.pushRef({ref:e,activeKey:"newTab0"})},activeKey:"newTab0"}),key:"newTab0"}];return a.state={activeKey:r[0].key,panes:r},a.newTabIndex++,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement(Ye.a,{onChange:this.onChange,activeKey:this.state.activeKey,type:"editable-card",onEdit:this.onEdit},this.state.panes.map(function(e){return n.createElement(Kt,{tab:e.title,key:e.key,closable:e.closable},e.content)}))}}]),t}(n.Component),Jt=a(133),Wt=a(69),$t=a(1003),Yt=a(441),Xt=a.n(Yt),Zt=a(999),ea=Zt.a.Group,ta=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).etPopLoad=e.parent,a.state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement("span",null,"parameters:"),n.createElement(ea,{compact:!0},this.state.dataForRender))}}]),t}(n.Component),aa=Zt.a.Group,na=te.a.Option,ra=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).params=function(e){a.data.params[e.target.getAttribute("name")]=e.target.value},a.sourceType=function(e,t){a.data.sourceTypeV=e;var r=Object(b.a)(Object(b.a)(a));new w(x).runScript({},"load _mlsql_.`datasources/params/".concat(e,"` as output;"),function(e){var t=[];e.forEach(function(e){t.push(n.createElement(Jt.a,{key:e.param},n.createElement(Wt.a,null,n.createElement(Zt.a,{style:{marginBottom:"10px"},name:e.param,onChange:r.params,type:"text",addonBefore:e.param,placeholder:e.description}))))}),r.loadParamsRef.current.setState({dataForRender:t})},function(e){})},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.makeMLSQL=function(){var e=Object(b.a)(Object(b.a)(a)),t=[];for(var n in a.data.params){var r=a.data.params[n],c='"'+r+'"';"code"!==n&&"fitParam.[group].code"!==n||(c="'''"+r+"'''"),t.push(n.replace(/\[group\]/g,"0")+"="+c)}var o="";return t.length>0&&(o="where"),"load ".concat(e.data.sourceTypeV,".`").concat(e.data.pathV,"` ").concat(o," ").concat(t.join("and\\n ")," as ").concat(e.data.tableNameV,";")},a.etpop=e.parent,a.data={params:{}},a.state={datasourcesRender:[]},a.loadParamsRef=n.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;new w(x).runScript({},"load _mlsql_.`datasources` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(na,{key:e.name,value:e.name},e.name))}),e.setState({datasourcesRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(aa,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,"soureType:",n.createElement(te.a,{onChange:this.sourceType,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.datasourcesRender)))),n.createElement("br",null),n.createElement(aa,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{onChange:this.path,type:"text",label:"Path",addonBefore:"Path",placeholder:"File path or tableName"})))),n.createElement("br",null),n.createElement(aa,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{type:"text",onChange:this.tableName,label:"tableName",addonBefore:"tableName",placeholder:"tableName"})))),n.createElement("br",null),n.createElement(ta,{parent:this,ref:this.loadParamsRef}))}}]),t}(n.Component),ca=Zt.a.Group,oa=(te.a.Option,Zt.a.TextArea),ia=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).renderParam=function(e){return"keepVersion"===e.param&&"evaluateTable"===e.param?null:"code"===e.param||"fitParam.[group].code"===e.param?n.createElement(Jt.a,null,n.createElement(Wt.a,null,e.param,":",n.createElement(oa,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",rows:10}))):n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",addonBefore:e.param,placeholder:e.description})))},a.params=function(e){a.data.params[e.target.getAttribute("name")]=e.target.value},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.makeMLSQL=function(){Object(b.a)(Object(b.a)(a));var e=[];for(var t in a.data.params){var n=a.data.params[t];e.push(t.replace(/\[group\]/g,"0")+'="'+n+'"')}return 0==e.length&&e.push('keepVersion="true"'),"train ".concat(a.data.tableNameV," as ").concat(a.name,".`").concat(a.data.pathV,"` where \n").concat(e.join(" and\n "),";")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this;new w(x).runScript({},"load modelParams.`".concat(t.name,"` as output;"),function(a){var r=[];a.forEach(function(t){var a=e.renderParam(t);null!==a&&(r.push(a),r.push(n.createElement("br",null)))}),t.setState({dataForRender:r})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement("span",null,"Training data and model path:"),n.createElement(ca,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{type:"text",onChange:this.tableName,size:"large",addonBefore:"tableName",placeholder:"the table of training data"})))),n.createElement("br",null),n.createElement(ca,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{onChange:this.path,type:"text",size:"large",addonBefore:"Model save path",placeholder:"the location you save you model"})))),n.createElement("br",null),n.createElement("span",null,"Algorithm parameters:"),n.createElement(ca,{compact:!0},this.state.dataForRender))}}]),t}(n.Component),la=Zt.a.Group,sa=te.a.Option,ua=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).sourceType=function(e,t){a.data.sourceTypeV=e},a.saveMode=function(e,t){a.data.saveModeV=e},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.partitionBy=function(e){a.data.partitionByV=e.target.value},a.fileNum=function(e){a.data.fileNumV=e.target.value},a.makeMLSQL=function(){var e=Object(b.a)(Object(b.a)(a)),t="";a.data.partitionByV&&(t="partitionBy "+a.data.partitionByV);var n='key="value"';return a.data.fileNumV&&(n='fileNum="'.concat(a.data.fileNumV,'"')),"save ".concat(e.data.saveModeV," ").concat(e.data.tableNameV," as ").concat(e.data.sourceTypeV,".`").concat(e.data.pathV,"` \n where ").concat(n," ").concat(t,";")},a.etpop=e.parent,a.data={},a.state={datasourcesRender:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;new w(x).runScript({},"load _mlsql_.`datasources` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(sa,{key:e.name,value:e.name},e.name))}),e.setState({datasourcesRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(la,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,"soureType:",n.createElement(te.a,{onChange:this.sourceType,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.datasourcesRender)))),n.createElement("br",null),n.createElement(la,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,"SaveMode:",n.createElement(te.a,{onChange:this.saveMode,showSearch:!0,style:{width:200},placeholder:"Choose save mode type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(sa,{key:"overwrite",value:"overwrite"},"overwrite"),n.createElement(sa,{key:"append",value:"append"},"append"),n.createElement(sa,{key:"errorIfExists",value:"errorIfExists"},"errorIfExists"),n.createElement(sa,{key:"ignore",value:"ignore"},"ignore"))))),n.createElement("br",null),n.createElement(la,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{type:"text",onChange:this.tableName,label:"tableName",addonBefore:"tableName",placeholder:"the tableName will be saved"})))),n.createElement("br",null),n.createElement(la,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{onChange:this.path,type:"text",addonBefore:"Target Path",placeholder:"File path or tableName"})))),n.createElement("br",null),n.createElement(la,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{type:"text",onChange:this.partitionBy,addonBefore:"partitionBy",placeholder:"partitionBy"})))),n.createElement("br",null),n.createElement(la,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{type:"text",onChange:this.fileNum,addonBefore:"fileNum",placeholder:"fileNum"})))),n.createElement("br",null))}}]),t}(n.Component),ma=a(110),da=Zt.a.Group,pa=(te.a.Option,Zt.a.TextArea),ha=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).renderParam=function(e){return"keepVersion"===e.param||"evaluateTable"===e.param?null:"code"===e.param||"fitParam.[group].code"===e.param?n.createElement(Jt.a,null,n.createElement(Wt.a,null,e.param,":",n.createElement(pa,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",rows:10}))):n.createElement(Jt.a,{key:e.param},n.createElement(Wt.a,null,n.createElement(Zt.a,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",addonBefore:e.param,placeholder:e.description})))},a.params=function(e){a.data.params[e.target.getAttribute("name")]=e.target.value},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.outputTableName=function(e){a.data.outputTableNameV=e.target.value},a.showTableName=function(){return"true"!==a.state.tableHidden?n.createElement(da,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{type:"text",onChange:a.tableName,size:"large",addonBefore:a.state.tableAlias?a.state.tableAlias:"Input table",placeholder:""})))):null},a.showOutputTableName=function(){return"true"!==a.state.outputTableHidden?n.createElement(da,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{type:"text",onChange:a.outputTableName,size:"large",addonBefore:a.state.outputTableAlias?a.state.outputTableAlias:"Output table",placeholder:""})))):null},a.pathNameForRender=function(){return a.state.pathAlias?a.state.pathAlias:"Save path"},a.showPathName=function(){return"true"!==a.state.pathHidden?n.createElement(da,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{onChange:a.path,type:"text",size:"large",addonBefore:a.pathNameForRender(),placeholder:""})))):""},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[],tableHidden:e.tableHidden,pathAlias:e.pathAlias,pathHidden:e.pathHidden,outputTableHidden:e.outputTableHidden,outputTableAlias:e.outputTableAlias,tableAlias:e.tableAlias},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this;new w(x).runScript({},"load modelParams.`".concat(t.name,"` as output;"),function(a){var r=[];a.forEach(function(t){var a=e.renderParam(t);null!==a&&(r.push(a),r.push(n.createElement("br",null)))}),t.setState({dataForRender:r})},function(e){})}},{key:"_makeMLSQL",value:function(){var e=[];for(var t in this.data.params){var a=this.data.params[t],n='"'+a+'"';"code"!==t&&"fitParam.[group].code"!==t||(n="'''"+a+"'''"),e.push(t.replace(/\[group\]/g,"0")+"="+n)}var r="";e.length>0&&(r="where");var c="";return this.data.outputTableNameV&&(c="as ".concat(this.data.outputTableNameV)),"run ".concat(this.data.tableNameV||"command"," as ").concat(this.name,".`").concat(this.data.pathV||"","` ").concat(r," ").concat(e.join("and\n ")," ").concat(c,";")}},{key:"_render",value:function(){return n.createElement("div",null,this.showTableName(),n.createElement("br",null),this.showOutputTableName(),n.createElement("br",null),this.showPathName(),n.createElement("br",null),0==this.state.dataForRender.length?"":n.createElement("span",null,"Parameters:"),n.createElement(da,{compact:!0},this.state.dataForRender))}}]),t}(n.Component),fa=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).makeMLSQL=function(){return Object(ma.a)(Object(u.a)(t.prototype),"_makeMLSQL",Object(b.a)(a)).call(Object(b.a)(a))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return Object(ma.a)(Object(u.a)(t.prototype),"_render",this).call(this)}}]),t}(ha),ba=Zt.a.Group,ga=(te.a.Option,function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).makeMLSQL=function(){Object(b.a)(Object(b.a)(a));var e=[];for(var t in a.data.params){var n=a.data.params[t];e.push(t.replace(/\[group\]/g,"0")+'="'+n+'"')}return 0==e.length&&e.push('keepVersion="true"'),"run command as ".concat(a.name,".`` where \n").concat(e.join(" and\n "),";")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(ba,{compact:!0},this.state.dataForRender))}}]),t}(fa)),Ea=(a(951),a(952),a(953),a(440)),va=a.n(Ea),ya=te.a.Option,Oa=Zt.a.TextArea,ja=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).udfName=function(e){a.data.udfNameV=e.target.value},a.dataType=function(e){a.data.dataTypeV=e.target.value},a.udfType=function(e){a.udfTypeV=e},a.code=function(e){a.codeV=e},a.langSelect=function(e){a.lang=e,a.codeCheckRef.current.checked=!1,a.setState({dataType:!1}),"python"===a.lang&&a.setState({dataType:!0}),a.setState({codeLang:e})},a.setCodeExample=function(e){e?a.codeRef.current.editor.setValue(a.codeExample()):a.codeRef.current.editor.setValue("")},a.codeExample=function(){var e=a.state.codeLang||"scala";return"scala"===e?"def apply(a:Double,b:Double)={\n   a + b\n}":"python"===e?"def apply(self,m):\n    return m":"java"===e?"import java.util.HashMap;\nimport java.util.Map;\npublic class UDF {\n  public Map<String, Integer[]> apply(String s) {\n    Map<String, Integer[]> m = new HashMap<>();\n    Integer[] arr = {1};\n    m.put(s, arr);\n    return m;\n  }\n}":null},a.showDataType=function(){return a.state.dataType?n.createElement(Jt.a,null,n.createElement(Wt.a,null,"dataType:",n.createElement(Oa,{style:{marginBottom:"10px"},name:"dataType",rows:10,onChange:a.dataType,type:"text",addonBefore:"dataType",placeholder:"This is not required when lang is scala\nAs we know python is not strongly typed language, so\nwe should manually spcify the return type.\nmap(string,string) means a map with key is string type,value also is string type.\narray(string) means a array with string type element.\nnested is support e.g. array(array(map(string,array(string))))\n\n"}))):null},a.showCode=function(){return n.createElement("div",null,n.createElement(Jt.a,null,n.createElement(Wt.a,null,"code:",n.createElement($.a,{ref:a.codeRef,mode:a.state.codeLang||"scala",theme:"github",width:"400px",height:"300px",name:"code",fontSize:16,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,onChange:a.code,editorProps:{$blockScrolling:1/0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2}}))),n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Wt.a,{span:8},"Show CodeExample:",n.createElement(va.a,{ref:a.codeCheckRef,onChange:a.setCodeExample})))))},a.makeMLSQL=function(){Object(b.a)(Object(b.a)(a));var e=[];return e.push('lang="'.concat(a.lang,'"')),e.push("code='''".concat(a.codeV,"'''")),e.push('udfType="'.concat(a.udfTypeV,'"')),a.dataTypeV&&e.push("dataType='''".concat(a.dataTypeV,"'''")),"register ScriptUDF.`` as ".concat(a.data.udfNameV," where \n").concat(e.join("\nand "),";")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[]},a.codeRef=n.createRef(),a.codeCheckRef=n.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{onChange:this.udfName,type:"text",size:"large",addonBefore:"UDF Name",placeholder:"the name of udf"}))),n.createElement("br",null),n.createElement(Jt.a,null,n.createElement(Wt.a,{span:4},n.createElement("span",null,"udfType:")),n.createElement(Wt.a,{span:20},n.createElement(te.a,{showSearch:!0,onChange:this.udfType,style:{width:200},placeholder:"Select udf type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(ya,{value:"udf"},"udf"),n.createElement(ya,{value:"udaf"},"udaf")))),n.createElement("br",null),n.createElement(Jt.a,null,n.createElement(Wt.a,{span:4},n.createElement("span",null,"Lang:")),n.createElement(Wt.a,{span:20},n.createElement(te.a,{showSearch:!0,style:{width:200},placeholder:"Select language type",optionFilterProp:"children",onChange:this.langSelect,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(ya,{value:"java"},"java"),n.createElement(ya,{value:"scala"},"scala"),n.createElement(ya,{value:"python"},"python")))),n.createElement("br",null),this.showDataType(),n.createElement("br",null),this.showCode(),n.createElement("br",null),n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{style:{marginBottom:"10px"},name:"methodName",onChange:this.params,type:"text",addonBefore:"methodName",placeholder:"methodName"}))))}}]),t}(n.Component),Sa=(Zt.a.Group,te.a.Option),ka=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).etName=function(e){a.etName=e},a.makeMLSQL=function(){return"load modelExample.`".concat(a.etName,"` as output;")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[],tableHidden:e.tableHidden,pathAlias:e.pathAlias,pathHidden:e.pathHidden},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;new w(x).runScript({},"load model.`list` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(Sa,{key:e.name,value:e.name},e.name))}),e.setState({dataForRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(Jt.a,null,n.createElement(Wt.a,null,"ET:",n.createElement(te.a,{onChange:this.etName,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.dataForRender))))}}]),t}(n.Component),wa=(Zt.a.Group,te.a.Option),Ca=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).makeMLSQL=function(){var e=Object(b.a)(Object(b.a)(a));return"register ".concat(e.data.sourceTypeV,".`").concat(e.data.pathV,"` as ").concat(e.data.outputTableNameV,";")},a.etName=function(e){a.data.sourceTypeV=e},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;new w(x).runScript({},"load model.`list` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(wa,{key:e.name,value:e.name},e.name))}),e.setState({dataForRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,this.showTableName(),n.createElement("br",null),this.showOutputTableName(),n.createElement("br",null),this.showPathName(),n.createElement("br",null),n.createElement(Jt.a,null,n.createElement(Wt.a,null,"ET:",n.createElement(te.a,{onChange:this.etName,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.dataForRender))))}}]),t}(fa),Ta=Zt.a.Group,Da=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).makeMLSQL=function(){var e="";a.data.outputTableNameV&&(e="as ".concat(a.data.outputTableNameV));var n=Object(ma.a)(Object(u.a)(t.prototype),"_makeMLSQL",Object(b.a)(a)).call(Object(b.a)(a)).replace(e,""),r="predict ".concat(a.data.tableNameV," as ").concat(a.name,".`").concat(a.data.pathV||"","` ").concat(e,";");return"".concat(n,"\n        ").concat(r,"\n        register ").concat(a.name,".`").concat(a.data.pathV||"","` as ").concat(a.data.functionNameV,"; \n        ").stripMargin()},a.functionName=function(e){a.data.functionNameV=e.target.value},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",null,this.showTableName(),n.createElement("br",null),this.showOutputTableName(),n.createElement("br",null),this.showPathName(),n.createElement("br",null),n.createElement(Ta,{compact:!0},n.createElement(Jt.a,null,n.createElement(Wt.a,null,n.createElement(Zt.a,{onChange:this.functionName,type:"text",size:"large",addonBefore:"functionName",placeholder:"A function you can use to convert String to number or number to String"})))),n.createElement("br",null),0==this.state.dataForRender.length?"":n.createElement("span",null,"Parameters:"),n.createElement(Ta,{compact:!0},this.state.dataForRender))}}]),t}(ha),Na=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).makeMLSQL=function(){var e="/api_v1/public/file/download?fileName=".concat(encodeURIComponent(a.data.pathV)),t=document.createElement("a");return t.href=e,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t),""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(ma.a)(Object(u.a)(t.prototype),"_render",this).call(this)}}]),t}(ha),xa=(Zt.a.Group,te.a.Option),Ra=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).etName=function(e){a.etName=e},a.makeMLSQL=function(){return"load _mlsql_.`progress/".concat(a.etName,"` as output;")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[],tableHidden:e.tableHidden,pathAlias:e.pathAlias,pathHidden:e.pathHidden},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;new w(x).runScript({},"load _mlsql_.`jobs` as output;",function(t){var a=t.filter(function(e){return"stream"===e.jobType}).map(function(e){return n.createElement(xa,{key:e.jobName,value:e.jobName},e.jobName)});e.setState({dataForRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(Jt.a,null,n.createElement(Wt.a,null,"Stream Jobs:",n.createElement(te.a,{onChange:this.etName,showSearch:!0,style:{width:200},placeholder:"Choose Stream Name",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.dataForRender))))}}]),t}(n.Component),Ma=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).disableEtModalVisible=function(){a.et.setState({etPop:!1,etModalVisible:!1})},a.enableEtModalVisible=function(){var e=a.popChild.current.makeMLSQL();a.et.makeMLSQL(e),a.et.setState({etPop:!1,etModalVisible:!1})},a.renderContent=function(){return"load"===a.et.state.eventName?n.createElement(ra,{parent:Object(b.a)(Object(b.a)(a)),ref:a.popChild}):"save"===a.et.state.eventName?n.createElement(ua,{name:a.et.state.eventName,ref:a.popChild}):"DownloadExt"===a.et.state.eventName?n.createElement(ga,{name:a.et.state.eventName,ref:a.popChild}):"StringIndex"===a.et.state.eventName?n.createElement(Da,{name:a.et.state.eventName,ref:a.popChild}):"DownloadFile"===a.et.state.eventName?n.createElement(Na,Object.assign({name:a.et.state.eventName,ref:a.popChild},a.et.state)):"ETExample"===a.et.state.eventName?n.createElement(ka,{name:a.et.state.eventName,ref:a.popChild}):"ETStreamProgress"===a.et.state.eventName?n.createElement(Ra,{name:a.et.state.eventName,ref:a.popChild}):"ScriptUDF"===a.et.state.eventName?n.createElement(ja,{name:a.et.state.eventName,ref:a.popChild}):"register"===a.et.state.eventName?n.createElement(Ca,Object.assign({name:a.et.state.eventName,ref:a.popChild},a.et.state)):"tool"===a.et.state.processType?n.createElement(fa,Object.assign({name:a.et.state.eventName,ref:a.popChild},a.et.state)):n.createElement(ia,{name:a.et.state.eventName,ref:a.popChild})},a.et=e.parent,a.popChild=n.createRef(),a.state={etModalVisible:!0,title:e.title},a.data={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(Xt.a,{title:this.state.title,visible:this.state.etModalVisible,onCancel:this.disableEtModalVisible,onOk:this.enableEtModalVisible,okText:"Ok",cancelText:"Cancel"},this.renderContent()))}}]),t}(n.Component),Ia=a(36),_a=a.n(Ia),Pa=Fe.a.Panel,La=(Ye.a.TabPane,function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).setData=function(e,t){a.itemData[e]=t},a.getData=function(e){return a.itemData[e]},a.onDragStart=function(e){var t=e.target.getAttribute("processtype");a.setData("eventName",e.target.getAttribute("name")),a.setData("popName",e.target.getAttribute("help")),a.setData("processType",t),a.setData("pathAlias",e.target.getAttribute("pathalias")||""),a.setData("outputTableAlias",e.target.getAttribute("outputtablealias")||""),a.setData("tableAlias",e.target.getAttribute("tablealias")||""),a.setData("tableHidden",e.target.getAttribute("tablehidden")||!1),a.setData("pathHidden",e.target.getAttribute("pathhidden")||!1),a.setData("outputTableHidden",e.target.getAttribute("outputtablehidden")||!1)},a.makeMLSQL=function(e){a.queryApp.getCurrentEditor().ref.appendToEditor(e)},a.renderPop=function(){return a.state.etPop?n.createElement(Ma,{parent:Object(b.a)(Object(b.a)(a)),title:a.state.popName}):null},a.etDoubleClick=function(e){a.onDragStart(e),a.queryApp.getCurrentEditor().ref.etOver(e)},a.queryApp=e.parent,a.state={},a.itemData={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(Fe.a,{style:{margin:"0px 0px",padding:"0px 0px"}},n.createElement(Pa,{header:"Quick Menu",key:"1"},n.createElement(Jt.a,{gutter:16},n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Load/Save Data"},n.createElement(_a.a,{tyle:{marginBottom:"10px"},title:"Load/Save Data",onDragStart:this.onDragStart,name:"load",help:"Load file/db as table",draggable:!0,color:"magenta",onDoubleClick:this.etDoubleClick},"Load data"),n.createElement(_a.a,{tyle:{marginBottom:"10px"},title:"Save Data",onDragStart:this.onDragStart,name:"save",help:"Save table into file/db ",draggable:!0,color:"magenta",onDoubleClick:this.etDoubleClick},"Save data"))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Algorithms"},n.createElement(_a.a,{tyle:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"TfIdfInPlace",help:"Use TfIdfInPlace vectorize text",draggable:!0,color:"magenta",onDoubleClick:this.etDoubleClick},"TfIdf"),n.createElement(_a.a,{tyle:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"Word2VecInPlace",help:"Use Word2VecInPlace vectorize text",draggable:!0,color:"magenta",onDoubleClick:this.etDoubleClick},"Word2vec"),n.createElement(_a.a,{tyle:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"RandomForest",help:"Use RandomForest to train a model",draggable:!0,color:"magenta"},"RandomForest"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"PythonAlg",help:"Run python lib to train",draggable:!0,color:"magenta"},"Python Algorithm"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"BigDLClassifyExt",help:"Use BigDL to develop deep learning algorithm",draggable:!0,color:"magenta"},"Deep Learning"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"NaiveBayes",help:"Use NaiveBayes",draggable:!0,color:"magenta"},"NaiveBayes"))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Python"},n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"PythonEnvExt",processtype:"tool",help:"Create Python Env",pathalias:"Temp directory",tablehidden:"true",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Create Python Env"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"PythonParallelExt",processtype:"tool",help:"Run python project",pathalias:"Temp directory",tablehidden:"true",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Run python project")))),n.createElement("br",null),n.createElement(Jt.a,{gutter:16},n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Register model as Function"},n.createElement(_a.a,{onDragStart:this.onDragStart,name:"ScriptUDF",processtype:"tool",onDoubleClick:this.etDoubleClick,help:"Use ScriptUDF create udf",draggable:!0,color:"magenta"},"Create UDF"),n.createElement(_a.a,{onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"register",help:"Register model to function ",pathalias:"Model saved path",outputtablealias:"Function name",tablealias:"Function name",tablehidden:"true",pathhidden:"false",outputtablehidden:"false",draggable:!0,color:"magenta"},"Register Model As Function"))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Jobs"},n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"JobList",onDoubleClick:this.etDoubleClick,processtype:"direct",draggable:!0,color:"magenta"},"Show jobs"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"Kill",onDoubleClick:this.etDoubleClick,processtype:"tool",pathalias:"groupId or jobName",tablehidden:"true",help:"Kill your job",draggable:!0,color:"magenta"},"Kill job"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ETStreamProgress",processtype:"",help:"Show Progress of Stream",draggable:!0,color:"magenta"},"Show Stream Job Progress"))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Tools"},n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"DownloadExt",processtype:"tool",help:"Use DownloadExt to download files you have uploaded",draggable:!0,color:"magenta"},"Download uploaded file"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ImageLoaderExt",processtype:"tool",help:"Use ImageLoaderExt to load images",pathalias:"",tablehidden:"true",pathhidden:"true",outputtablehidden:"false",draggable:!0,color:"magenta"},"Load images"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ConnectMySQL",processtype:"direct",help:"",draggable:!0,color:"magenta"},"Connect MySQL"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"JDBC",processtype:"tool",pathalias:"DB name in connect",tablehidden:"false",help:"Run DLL on MySQL",draggable:!0,color:"magenta"},"MySQL DDL"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"TreeBuildExt",processtype:"tool",pathalias:"",tablehidden:"false",pathhidden:"true",help:"Build tree from parent-child",draggable:!0,color:"magenta"},"Parent-Child"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ETExample",processtype:"",help:"Show Example of ET",draggable:!0,color:"magenta"},"Show ET Example"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"RepartitionExt",processtype:"tool",help:"Change Table Partition Num",pathalias:"",tablehidden:"false",pathhidden:"true",outputtablehidden:"false",draggable:!0,color:"magenta"},"Repartition table"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"SendMessage",processtype:"tool",help:"Send email",pathalias:"",tablehidden:"false",pathhidden:"true",outputtablehidden:"true",draggable:!0,color:"magenta"},"Send Mail"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"CacheExt",processtype:"tool",help:"Cache table",pathalias:"",tablehidden:"false",pathhidden:"true",outputtablehidden:"true",draggable:!0,color:"magenta"},"Cache Table"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"StringIndex",processtype:"tool",help:"Convert String to number",pathalias:"Mapping path",tablehidden:"false",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Convert String to number"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"DownloadFile",processtype:"tool",help:"Download File",pathalias:"Target file",tablehidden:"true",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Download File to computer"),n.createElement(_a.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ShowResource",processtype:"direct",draggable:!0,color:"magenta"},"Cluster Resource")))))),this.renderPop())}}]),t}(n.Component)),Aa=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).openExistsOrNewEditor=function(e){var t=Object(b.a)(Object(b.a)(a));if(a.fileToEditorMap.hasOwnProperty(e.id)){var n=a.fileToEditorMap[e.id];n.ref.text(e.content,e.id),a.editorGroup.current.onChange(n.activeKey)}else a.editorGroup.current.addFull(e.name,function(a){a.ref.text(e.content,e.id),t.fileToEditorMap[e.id]=a});e.name.endsWith(".nb")?t.setState({displayEditor:"notebook"}):e.name.endsWith(".py")?t.setState({displayEditor:"pythoneditor"}):t.setState({displayEditor:"normal"})},a.closeEditor=function(e){var t=Object.keys(a.fileToEditorMap).filter(function(t){return a.fileToEditorMap[t].activeKey!==e.activeKey}).reduce(function(e,t){return e[t]=a.fileToEditorMap[t],e},{});a.fileToEditorMap=t},a.getCurrentEditor=function(){return a.editorGroup.current.getCurrentEditor()},a.setData=function(e){a.queryResData=e,a.dash.current.refresh()},a.tableAndDash=function(){if("notebook"!==a.state.displayEditor||"pythoneditor"!==a.state.displayEditor)return r.a.createElement("div",null,r.a.createElement(ae.Resizable,{defaultSize:{height:"300px"},onResize:function(){a.messageBox.current.editor.resize()}},r.a.createElement($.a,{height:"100%",width:"100%",ref:a.messageBox,mode:"text",theme:"github",name:"message_box"})),r.a.createElement("div",null,r.a.createElement(Dt,{ref:a.dash,parent:Object(b.a)(Object(b.a)(a))})),r.a.createElement("div",{className:"mlsql-query-display"},r.a.createElement(Ve,{ref:a.display,parent:Object(b.a)(Object(b.a)(a))})))},a.state={sqlContent:"",displayEditor:"normal"},a.directoryTree=r.a.createRef(),a.editorGroup=r.a.createRef(),a.messageBox=r.a.createRef(),a.display=r.a.createRef(),a.dash=r.a.createRef(),a.etRef=r.a.createRef(),a.fileToEditorMap={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"mlsql-queryapp"},r.a.createElement("div",{className:"mlsql-directory-tree"},r.a.createElement(_e,{ref:this.directoryTree,parent:this})),r.a.createElement("div",{className:"mlsql-editor"},r.a.createElement("div",{style:{marginBottom:"10px"}},r.a.createElement(La,{ref:this.etRef,parent:this})),r.a.createElement(Ht,{ref:this.editorGroup,parent:this}),this.tableAndDash()))}}]),t}(n.Component),qa="console",Ba="team",Va="demo",Fa="script_plugins",Ua="bigdl",Ga="nlp",za="stream",Qa="basic",Ka="team_view_basic",Ha="setup_view_basic",Ja="cluster_view_basic",Wa="auth_view_basic",$a="setting_view_basic",Ya=a(994),Xa=a(294),Za=a(1001),en=a(1004),tn=a(993),an=Za.a.Step,nn=a(117),rn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).setData=function(e){a.queryResData=e,a.dash.current.refresh()},a.getEditor=function(){return a.editor.current.aceEditorRef.current.editor},a.state={current:0},a.editor=n.createRef(),a.dash=n.createRef(),a.display=n.createRef(),a.messageBox=n.createRef(),a.techData=a.generateTechData(),a.commandData=a.generateCommandData(),a.steps=a.generateSteps(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"generateView",value:function(e){return n.createElement("div",{style:{marginTop:"30px"}},this.techData[e].length>0&&n.createElement(en.a,{header:n.createElement("div",null,"How to do:"),footer:n.createElement("div",null,"Congratulations"),bordered:!0,dataSource:this.techData[e],renderItem:function(e){return n.createElement(en.a.Item,null,e)}}),n.createElement("div",{className:"mlsql-queryapp"},n.createElement("div",{className:"mlsql-editor"},n.createElement(Oe,{ref:this.editor,parent:this}),n.createElement("div",{className:"mlsql-messagebox"},n.createElement($.a,{height:"300px",width:"100%",ref:this.messageBox,mode:"text",theme:"github",name:"message_box"})),n.createElement("div",null,n.createElement(Dt,{ref:this.dash,parent:this})),n.createElement("div",{className:"mlsql-query-display"},n.createElement(Ve,{ref:this.display,parent:this})))))}},{key:"generateSteps",value:function(){return[{title:"Download Cifar10 Images",content:this.generateView(0)},{title:"Resize Images",content:this.generateView(1)},{title:"Extract Label",content:this.generateView(2)},{title:"Train",content:this.generateView(3)},{title:"Predict",content:this.generateView(4)}]}},{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){try{e.getEditor().setValue(e.commandData[0],-1)}catch(t){}},1e3)}},{key:"next",value:function(){var e=this,t=this.state.current+1;this.setState({current:t}),setTimeout(function(){try{e.getEditor().setValue(e.commandData[t],-1)}catch(a){}},1e3)}},{key:"prev",value:function(){var e=this,t=this.state.current-1;this.setState({current:t}),setTimeout(function(){try{e.getEditor().setValue(e.commandData[t],-1)}catch(a){}},1e3)}},{key:"render",value:function(){var e=this,t=this.state.current;return n.createElement("div",null,n.createElement("div",{className:"steps-action",style:{marginBottom:"30px"}},t<this.steps.length-1&&n.createElement(Y.a,{type:"primary",onClick:function(){return e.next()}},"Next Step"),t===this.steps.length-1&&n.createElement(Y.a,{type:"primary",onClick:function(){return tn.a.success("Processing complete!")}},"Done"),t>0&&n.createElement(Y.a,{style:{marginLeft:8},onClick:function(){return e.prev()}},"Previous Step")),n.createElement(Za.a,{current:t},this.steps.map(function(e){return n.createElement(an,{key:e.title,title:e.title})})),n.createElement("div",{className:"steps-content"},this.steps[t].content))}},{key:"generateTechData",value:function(){return[["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Tools/Download uploaded file to Editor","Step 3: An dialog will be opened, fill field [from] with 'public/cifar.tar' and field [to] with '/tmp'","Step 4: Click Ok in dialog","Step 5: Click button Run(Since there are so many files, it will take a while.)"],["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Tools/Load images",n.createElement(nn,{source:"Step 3: An dialog will be opened\nfill field [Output table] with 'images'\nfield [imageDir]  with '/tmp/cifar'\nfield [code]  with \n\n```scala\ndef apply(params:Map[String,String]) = {\n         Resize(256, 256) -> CenterCrop(224, 224) ->\n          MatToTensor() -> ImageFrameToSample()\n       }\n```"}),"Step 4: Click Ok in dialog","Step 5: Click button Run"],["Step 0: Use set statement to set a variable named labelMappingPath.","Step 1: extract the class name from path","Step 2: map label string to number","Step 3: add 1 to label number since the bigdl requires that.","Step 4: finally, we get features and label","Step 5: Click button Run"],["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Algorithms/Deep Learning",n.createElement(nn,{source:"Step 3: An dialog will be opened  \nfill field [tableName] with 'trainData'  \nfield [Model save path]  with '/tmp/bigdl' \nfield [code]  with    \n```scala  \n def apply(params:Map[String,String])={\n                        val model = Sequential()\n                        model.add(Reshape(Array(3, 28, 28), inputShape = Shape(28, 28, 3)))\n"+'                        model.add(Convolution2D(6, 5, 5, activation = "tanh").setName("conv1_5x5"))\n                        model.add(MaxPooling2D())\n                        model.add(Convolution2D(12, 5, 5, activation = "tanh").setName("conv2_5x5"))\n                        model.add(MaxPooling2D())\n                        model.add(Flatten())\n                        model.add(Dense(100, activation = "tanh").setName("fc1"))\n                        model.add(Dense(params("classNum").toInt, activation = "softmax").setName("fc2"))\n                    }```  \n'}),"Step 4: Click Ok in dialog",n.createElement(nn,{source:'Step 5: modify the where statement, add \n```\nfitParam.0.featureSize="[3,28,28]"\nand fitParam.0.classNum="10"\nand fitParam.0.maxEpoch="50"\n```'}),"Step 6: Click button Run"],[]]}},{key:"generateCommandData",value:function(){return['run command as DownloadExt.`` where \n            from="public/cifar.tar" \n            and to="/tmp";'.stripMargin(),"run command as ImageLoaderExt.`/tmp/cifar` \n            where code='''\n        def apply(params:Map[String,String]) = {\n         Resize(256, 256) -> CenterCrop(224, 224) ->\n          MatToTensor() -> ImageFrameToSample()\n       }''' as images;".stripMargin(),'-- convert image path to number label \n            set labelMappingPath = "/tmp/si"; \n            select split(split(imageName,"_")[1],"\\\\.")[0] as labelStr,features from images as tempData;\n            --convert the label string to number \n            train tempData as StringIndex.`${labelMappingPath}` where inputCol="labelStr" and outputCol="labelIndex";\n            predict tempData as StringIndex.`${labelMappingPath}` as tempData;\n            -- Since the bigdl need label number from 1, we should plus one\n            select (cast(labelIndex as float) + 1) as label,features from tempData as trainData;'.stripMargin(),'--train with LeNet5 model\n            set modelPath = "/tmp/bigdl";            \n            train trainData as BigDLClassifyExt.`${modelPath}` where\n            fitParam.0.featureSize="[3,28,28]"\n            and fitParam.0.classNum="10"\n            and fitParam.0.maxEpoch="50"\n            and fitParam.0.code=\'\'\'\n            |       def apply(params:Map[String,String])={\n            |            val model = Sequential()\n            |            model.add(Reshape(Array(3, 28, 28), inputShape = Shape(28, 28, 3)))\n            |            model.add(Convolution2D(6, 5, 5, activation = "tanh").setName("conv1_5x5"))\n            |            model.add(MaxPooling2D())\n            |            model.add(Convolution2D(12, 5, 5, activation = "tanh").setName("conv2_5x5"))\n            |            model.add(MaxPooling2D())\n            |            model.add(Flatten())\n            |            model.add(Dense(100, activation = "tanh").setName("fc1"))\n            |            model.add(Dense(params("classNum").toInt, activation = "softmax").setName("fc2"))\n            |        }\'\'\';\n            '.stripMargin(),'set modelPath = "/tmp/bigdl";\n            \n            -- batch predict            \n            predict trainData as BigDLClassifyExt.`${modelPath}` as predictdata;\n            \n            -- register BigDLClassifyExt.`/tmp/bigdl` as cifarPredict;\n            select vec_argmax(cifarPredict(vec_dense(features))) as predicted_label,\n            label from trainData\n            as output;'.stripMargin()]}}]),t}(n.Component),cn=a(117),on=function(e){function t(e){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"generateSteps",value:function(){return[{title:"Download Dataset SogouCS.WWW08",content:this.generateView(0)},{title:"Parse the xml file",content:this.generateView(1)},{title:"Extract Label",content:this.generateView(2)},{title:"Run TFIDF",content:this.generateView(3)},{title:"Train/Register",content:this.generateView(4)},{title:"Predict",content:this.generateView(5)}]}},{key:"generateTechData",value:function(){return[["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Tools/Download uploaded file to Editor","Step 3: An dialog will be opened, fill field [from] with 'public/SogouCS.reduced.tar' and field [to] with '/tmp/nlp/sogo'","Step 4: Click Ok in dialog","Step 5: Click button Run(it will take a while.)"],["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Load/Save Data/Load data",n.createElement(cn,{source:"\n                |\n                |Step 3: An dialog will be opened,\n                |fill field [path] with '/tmp/nlp/sogo' and field [Output table] with 'xmlData',\n                |specify rowTag to doc and charset to GBK\n                |\"\n                |\n                ".stripMargin()}),"Step 4: Click Ok in dialog","Step 5: Use SQL to filter _corrupt_record","Step 6: Click button Run(it will take a while.)"],[n.createElement(cn,{source:'\n                | Step 0: We will treat url as label source, we use SQL to extract label from url:\n                |\n                |\n                |```\n                |-- http://sports.sohu.com/20070422/n249599819.shtml extract sports from url\n                |select temp.* from (select split(split(url,"/")[2],"\\\\.")[0] as labelStr,content from xmlData) as temp\n                |where temp.labelStr is not null\n                |as rawData;\n                |```\n                |\n                |For now , the label is string, we should convert them to number\n\n                '.stripMargin()}),n.createElement(cn,{source:"\n                |Step 1:  Drag Tools/Convert String to number, a dialog will open,\n                |\n                |```\n                |     1. set Input table as rawData,\n                |     2. Set save path as /tmp/nlp/label_mapping\n                |     3. Set inputCol as labelStr\n                |     4. Set outputCol as label\n                |     5. set Output table as rawDataWithLabel\n                |     6. set functionName table as rawDataWithLabel\n                |```\n                |We can use the functionName in SQL to convert String to number or number to String.\n                ".stripMargin()})],[n.createElement(cn,{source:"\n                |Step 0:  Drag Algorithms/TfIdf, a dialog will open,\n                |\n                |```\n                |         1. set Input table as rawDataWithLabel,\n                |         2. Set save path as /tmp/nlp/tfidf\n                |         3. Set inputCol as content\n                |         4. Set nGrams as 2\n                |         5. set Output table as trainData\n                |```\n                |Click Ok in dialog\n                ".stripMargin()}),n.createElement(cn,{source:"\n                |Step 1:  Drag [Register model as Function]/[Register Model As Function], a dialog will open,\n                |\n                |```\n                |         1. set Function name  as tfidf_predict,\n                |         2. Set Model saved path as /tmp/nlp/tfidf\n                |         3. Set et as TfIdfInPlace\n                |```\n                |Click Ok in dialog\n                ".stripMargin()}),"Step 2: Click button Run(it will take a while.)"],[n.createElement(cn,{source:"\n                |Step 0:  Drag Algorithms/RandomForest, a dialog will open,\n                |\n                |```\n                |         1. set tableName as trainData,\n                |         2. Set Model save path as /tmp/nlp/rf\n                |```\n                |Click Ok in dialog\n                ".stripMargin()}),n.createElement(cn,{source:"\n                |Step 1:  Drag [Register model as Function]/[Register Model As Function], a dialog will open,\n                |\n                |```\n                |         1. set Function name  as rf_predict,\n                |         2. Set Model saved path as /tmp/nlp/rf\n                |         3. Set et as RandomForest\n                |```\n                |Click Ok in dialog\n                ".stripMargin()}),"Step 2: Click button Run(it will take a while.)"],[n.createElement(cn,{source:'\n                |Paste:\n                |\n                |```sql\n                |select rf_predict(tfidf_predict("china is cool")) as predicted as output;\n                |```\n                '.stripMargin()}),"Step 2: Click button Run(it will take a while.)"]]}},{key:"generateCommandData",value:function(){return['run command as DownloadExt.`` where \n             |from="public/SogouCS.reduced.tar" and\n             |to="/tmp/nlp/sogo";'.stripMargin(),'load xml.`/tmp/nlp/sogo` where rowTag="doc" and charset="GBK" as xmlData;\n            |select * from xmlData where _corrupt_record is null as xmlData; \n            '.stripMargin(),'-- http://sports.sohu.com/20070422/n249599819.shtml extract sports from url\n            |select temp.* from (select split(split(url,"/")[2],"\\\\.")[0] as labelStr,content from xmlData) as temp \n            |where temp.labelStr is not null \n            |as rawData;\n            |-- select distinct(split(split(url,"/")[2],"\\\\.")[0]) as labelStr from rawData as output;\n            |-- select split(split(url,"/")[2],"\\\\.")[0] as labelStr,url from rawData as output;\n            |\n            |run rawData as StringIndex.`/tmp/nlp/label_mapping` where inputCol="labelStr"and\n            |outputCol="label" ;\n            |predict rawData as StringIndex.`/tmp/nlp/label_mapping` as rawDataWithLabel;\n            |register StringIndex.`/tmp/nlp/label_mapping` as convert_label; '.stripMargin(),'train rawDataWithLabel as TfIdfInPlace.`/tmp/nlp/tfidf` where inputCol="content"\n            |and nGrams="2" as trainData;\n            |\n            |register TfIdfInPlace.`/tmp/nlp/tfidf` as tfidf_predict;'.stripMargin(),'train trainData as RandomForest.`/tmp/nlp/rf` where \n            |keepVersion="true";\n            |\n            |register RandomForest.`/tmp/nlp/rf` as rf_predict;'.stripMargin(),'select rf_predict(tfidf_predict("china is cool")) as predicted as output;'.stripMargin()]}}]),t}(rn),ln=a(117),sn=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"generateSteps",value:function(){return[{title:"Variable in MLSQL",content:this.generateView(0)},{title:"Process excel",content:this.generateView(1)},{title:"Extract Label",content:this.generateView(2)},{title:"Run TFIDF",content:this.generateView(3)},{title:"Train/Register",content:this.generateView(4)},{title:"Predict",content:this.generateView(5)}]}},{key:"generateTechData",value:function(){return[[n.createElement(ln,{source:"\n                |\n                |\n                |\n                ".stripMargin()})],[],[],[],[],[]]}},{key:"generateCommandData",value:function(){return['|-- set string\n             |set email="allwefantasy@gmail.com";\n             |select "${email}" as email  as table1;\n             |             \n             |-- nested variable reference\n             |set email="allwefantasy@gmail.com";\n             |set hello="hello ${email}";\n             |\n             |-- build-in variable: HOME OWNER date\n             |set day_id =\'\'\'${date.toString("yyyy-MM-dd")}\'\'\';\n             |select "${day_id}" as a as test111;\n             |\n             |-- conf/spark.sql("set spark.sql.shuffle.partitions=200")\n             |set spark.sql.shuffle.partitions=200 where type="conf";\n             |\n             |-- shell\n             |set date=`date` where type="shell";\n             |select "${date}" as dt as output;\n             |                \n             '.stripMargin(),'load xml.`...xml..file...path` where rowTag="doc" and charset="GBK" as xmlData;\n            |select * from xmlData where _corrupt_record is null as xmlData; \n            '.stripMargin(),'-- http://sports.sohu.com/20070422/n249599819.shtml extract sports from url\n            |select temp.* from (select split(split(url,"/")[2],"\\\\.")[0] as labelStr,content from xmlData) as temp \n            |where temp.labelStr is not null \n            |as rawData;\n            |-- select distinct(split(split(url,"/")[2],"\\\\.")[0]) as labelStr from rawData as output;\n            |-- select split(split(url,"/")[2],"\\\\.")[0] as labelStr,url from rawData as output;\n            |\n            |run rawData as StringIndex.`/tmp/nlp/label_mapping` where inputCol="labelStr"and\n            |outputCol="label" ;\n            |predict rawData as StringIndex.`/tmp/nlp/label_mapping` as rawDataWithLabel;\n            |register StringIndex.`/tmp/nlp/label_mapping` as convert_label; '.stripMargin(),'train rawDataWithLabel as TfIdfInPlace.`/tmp/nlp/tfidf` where inputCol="content"\n            |and nGrams="2" as trainData;\n            |\n            |register TfIdfInPlace.`/tmp/nlp/tfidf` as tfidf_predict;'.stripMargin(),'train trainData as RandomForest.`/tmp/nlp/rf` where \n            |keepVersion="true";\n            |\n            |register RandomForest.`/tmp/nlp/rf` as rf_predict;'.stripMargin(),'select rf_predict(tfidf_predict("china is cool")) as predicted as output;'.stripMargin()]}}]),t}(rn),un=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).renderView=function(){return a.state.currentView===Ua?n.createElement(rn,null):a.state.currentView===Ga?n.createElement(on,null):a.state.currentView===Qa?n.createElement(sn,null):null},a.state={currentView:Qa},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.renderView()}}]),t}(n.Component),mn=Ya.a.Header,dn=Ya.a.Content,pn=Ya.a.Footer,hn=Ya.a.Sider,fn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).switchToBigDL=function(e){a.demosRef.current.setState({currentView:Ua})},a.switchToNLP=function(e){a.demosRef.current.setState({currentView:Ga})},a.switchToStream=function(e){a.demosRef.current.setState({currentView:za})},a.switchToBasic=function(){a.demosRef.current.setState({currentView:Qa})},a.demosRef=n.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement(Ya.a,{style:{minHeight:"100vh"}},n.createElement(hn,null,n.createElement("div",{className:"logo"}),n.createElement(Xa.a,{theme:"dark",defaultSelectedKeys:["0"],mode:"inline"},n.createElement(Xa.a.Item,{key:"0"},n.createElement(Y.a,{block:!0,onClick:this.switchToBasic},"Basic Tutorial")),n.createElement(Xa.a.Item,{key:"1"},n.createElement(Y.a,{block:!0,onClick:this.switchToBigDL},"Cifar10")),n.createElement(Xa.a.Item,{key:"2"},n.createElement(Y.a,{block:!0,onClick:this.switchToNLP},"NLP")),n.createElement(Xa.a.Item,{key:"3"},n.createElement(Y.a,{block:!0},"Stream")),n.createElement(Xa.a.Item,{key:"4"},n.createElement(Y.a,{block:!0},"Excel")))),n.createElement(Ya.a,null,n.createElement(mn,{style:{background:"#fff",padding:0}}),n.createElement(dn,{style:{margin:"0 16px"}},n.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},n.createElement(un,{ref:this.demosRef}))),n.createElement(pn,{style:{textAlign:"center"}})))}}]),t}(n.Component),bn=function(e){function t(e){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(fn,null))}}]),t}(n.Component),gn=(a(124),a(997)),En=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,a){e||new w(M).request2(a,function(e){"success"===e.msg?(tn.a.success("Create team success",3),t.teamCards.teamsRef&&t.teamCards.teamsRef.current.refresh()):tn.a.warning("Create team fail"+e.msg,10)},function(e){tn.a.error("Create team fail:"+e,10)})})},a.teamNameCheck=function(e,t,a){t?new w(I).request2({name:t},function(e){e.msg?a():a("".concat(t," have been taken. Try another"))},function(e){a("server error:"+e)}):a()},console.log(e),a.teamCards=e.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("name",{rules:[{required:!0,message:"Please input the team name!"},{validator:this.teamNameCheck}]})(n.createElement(Zt.a,{prefix:n.createElement(xt.a,{type:"team",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Team name"}))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Create")))}}]),t}(n.Component),vn=gn.a.create({name:"create_team"})(En),yn=(a(125),a(39)),On=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"fetchTeams",value:function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data";new w(t).request2({},function(e){a.setState(Object(yn.a)({},n,e))},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchMembersByTeam",value:function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data";new w("/api_v1/team/members").request2({teamName:a},function(e){t.setState(Object(yn.a)({},n,e))},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchRoles",value:function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data";new w("/api_v1/team/roles").request2({teamName:a},function(e){t.setState(Object(yn.a)({},n,e))},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchTablesByRole",value:function(t,a,n,r){new w("/api_v1/role/tables").request2({teamName:a,roleName:n},function(e){r&&t.setState(Object(yn.a)({},r,e))},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"removeRoleMember",value:function(t,a,n,r,c,o){new w("/api_v1/role/member/remove").request2({teamName:a,roleName:n,userName:r},function(e){c&&t.setState(Object(yn.a)({},c,e)),o&&o()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchMembersByRole",value:function(t,a,n,r,c){new w("/api_v1/role/members").request2({teamName:a,roleName:n},function(e){r&&t.setState(Object(yn.a)({},r,e)),c&&c()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"removeRole",value:function(t,a,n){new w("/api_v1/team/role/remove").request2({teamName:a,roleName:n},function(e){},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"removeTeamMember",value:function(t,a,n,r){new w("/api_v1/team/member/remove").request2({teamName:a,userName:n},function(e){r()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"teamInvite",value:function(t,a,n,r,c){new w(a).request2({teamName:n},function(e){r&&t.setState(Object(yn.a)({},r,e)),c&&c()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchTables",value:function(t,a,n,r){new w("/api_v1/team/tables").request2({teamName:a},function(e){n&&t.setState(Object(yn.a)({},n,e)),r&&r()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"removeTable",value:function(t,a,n,r,c){new w("/api_v1/team/table/remove").request2({teamName:a,tableId:n},function(e){r&&t.setState(Object(yn.a)({},r,e)),c&&c()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchTableTypes",value:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";new w(x).runScript({},"load _mlsql_.`tables/tableTypes` as output;",function(e){t.setState(Object(yn.a)({},a,e))},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchSourceTypes",value:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";new w(x).runScript({},"load _mlsql_.`tables/sourceTypes` as output;",function(e){t.setState(Object(yn.a)({},a,e))},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchOperateTypes",value:function(t,a){new w(x).runScript({},"load _mlsql_.`tables/operateTypes` as output;",function(e){a&&t.setState(Object(yn.a)({},a,e))},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"removeRoleTable",value:function(t,a,n,r,c,o){new w("/api_v1/role/table/remove").request2({teamName:a,roleName:n,tableId:r},function(e){c&&t.setState(Object(yn.a)({},c,e)),o&&o()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}}]),e}();On.MESSAGE_TIMEOUT=10;var jn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).accept=function(e){e.preventDefault(),On.teamInvite(Object(b.a)(Object(b.a)(a)),A,a.teamName,null,function(){On.fetchTeams(a.apiUrl,Object(b.a)(Object(b.a)(a)),"data"),a.teamCards.teamYourJoinRef.current.refresh()})},a.refuse=function(e){e.preventDefault(),On.teamInvite(Object(b.a)(Object(b.a)(a)),q,a.teamName,null,function(){On.fetchTeams(a.apiUrl,Object(b.a)(Object(b.a)(a)),"data")})},a.refresh=function(){On.fetchTeams(a.apiUrl,Object(b.a)(Object(b.a)(a)),"data")},a.renderCommand=function(e){return a.teamName=e,a.apiUrl===P?[n.createElement("a",{onClick:a.accept},"accept"),n.createElement("a",{onClick:a.refuse},"refuse")]:[]},a.teamCards=e.parent,a.apiUrl=e.apiUrl,a.state={data:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(this.apiUrl,this,"data")}},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(en.a,{dataSource:this.state.data,renderItem:function(t){return n.createElement(en.a.Item,{key:t.name,actions:e.renderCommand(t.name)},n.createElement(en.a.Item.Meta,{title:n.createElement("a",{href:"#"},t.name)}))}}))}}]),t}(n.Component),Sn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,a){e||new w(L).request2(a,function(e){"success"===e.msg?(t.teamCards.setState({refresh:!0}),tn.a.success("Invite success",3)):tn.a.warning("Invite fail:"+e.msg,10)},function(e){t.teamCards.setState({refresh:!0}),tn.a.error("Invite fail:"+e,10)})})},a.renderTeams=function(){return a.state.teams.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.teamCards=e.parent,a.state={teams:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=new w(_),t=this;e.request2({},function(e){t.setState({teams:e})},function(e){tn.a.warning("load data fail:"+e,15)})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("teamName",{rules:[{required:!0,message:"Please choose the team name"}]})(n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200}},this.renderTeams()))),n.createElement(gn.a.Item,null,e("userNames",{rules:[{required:!0,message:"Please input the user name you want invite"}]})(n.createElement(Zt.a,{prefix:n.createElement(xt.a,{type:"team",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"User name, split with ','"}))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Create")))}}]),t}(n.Component),kn=gn.a.create({name:"create_team"})(Sn),wn=function e(){Object(i.a)(this,e)};wn.renderTeamsForSelect=function(e){return e.state.teams.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},wn.onTeamSelect=function(e,t){e.currentTeamName=t,On.fetchRoles(e,t,"roles")},wn.renderTeams=function(e){return e.state.teams.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},wn.renderRoles=function(e){return e.state.roles.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},wn.renderMembers=function(e){return e.state.members.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},wn.renderBackends=function(e){return e.state.backends.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},wn.teamSelect=function(e,t){return n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200},onChange:t},wn.renderTeams(e))},wn.roleSelect=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";return n.createElement(te.a,{placeholder:"role name",mode:a,size:"large",style:{width:200},onChange:t},wn.renderRoles(e))},wn.backendSelect=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";return n.createElement(te.a,{placeholder:"backend name",mode:a,size:"large",style:{width:200},onChange:t},wn.renderBackends(e))},wn.memberSelect=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";return n.createElement(te.a,{placeholder:"member name",mode:a,size:"large",style:{width:200},onChange:t},wn.renderMembers(e))};var Cn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).selectTeam=function(e){a.currentTeam=e,On.fetchMembersByTeam(Object(b.a)(Object(b.a)(a)),e,"members")},a.renderCommand=function(e){var t=Object(b.a)(Object(b.a)(a));return[n.createElement("a",{onClick:function(){On.removeTeamMember(t,t.currentTeam,e,function(){On.fetchMembersByTeam(t,t.currentTeam,"members")})}},"remove")]},a.renderMembers=function(){return n.createElement(en.a,{dataSource:a.state.members,renderItem:function(e){return n.createElement(en.a.Item,{key:e.name,actions:a.renderCommand(e.name)},n.createElement(en.a.Item.Meta,{title:n.createElement("a",{href:"#"},e.name)}))}})},a.teamCards=e.parent,a.apiUrl=e.apiUrl,a.state={teams:[],members:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(this.apiUrl,this,"teams")}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200},onChange:this.selectTeam},wn.renderTeamsForSelect(this)),this.renderMembers())}}]),t}(n.Component),Tn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,a){e||new w(B).request2(a,function(e){"success"===e.msg?(tn.a.success("Create roles success",3),t.teamCards.teamsRef&&t.teamCards.teamsRef.current.refresh()):tn.a.warning("Create roles fail:"+e.msg,10)},function(e){tn.a.error("Create roles fail:"+e,10)})})},a.renderTeams=function(){return a.state.teams.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.teamCards=e.parent,a.state={teams:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=new w(_),t=this;e.request2({},function(e){t.setState({teams:e})},function(e){tn.a.warning("load data fail:"+e,15)})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("teamName",{rules:[{required:!0,message:"Please choose the team name"}]})(n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200}},this.renderTeams()))),n.createElement(gn.a.Item,null,e("roleNames",{rules:[{required:!0,message:"Please input the role name you want to create"}]})(n.createElement(Zt.a,{prefix:n.createElement(xt.a,{type:"role",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"User name, split with ','"}))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Create")))}}]),t}(n.Component),Dn=gn.a.create({name:"add_role_for_team"})(Tn),Nn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).selectTeam=function(e){a.currentTeam=e,On.fetchRoles(Object(b.a)(Object(b.a)(a)),e,"roles")},a.refresh=function(){a.currentTeam&&On.fetchRoles(Object(b.a)(Object(b.a)(a)),a.currentTeam,"roles")},a.renderCommand=function(e){return[n.createElement("a",{onClick:function(){On.removeRole(Object(b.a)(Object(b.a)(a)),a.currentTeam,e),On.fetchRoles(Object(b.a)(Object(b.a)(a)),a.currentTeam,"roles")}},"remove")]},a.renderRoles=function(){return n.createElement(en.a,{dataSource:a.state.roles,renderItem:function(e){return n.createElement(en.a.Item,{key:e.name,actions:a.renderCommand(e.name)},n.createElement(en.a.Item.Meta,{title:n.createElement("a",{href:"#"},e.name)}))}})},a.teamCards=e.parent,a.apiUrl=e.apiUrl,a.state={teams:[],members:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(_,this,"teams")}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200},onChange:this.selectTeam},wn.renderTeamsForSelect(this)),this.renderRoles())}}]),t}(n.Component),xn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,a){e||new w(U).request2(a,function(e){console.log(e),console.log("----"),"success"===e.msg?(t.teamCards.roleMembersRef&&t.teamCards.roleMembersRef.current.refresh(),tn.a.success("Create  success",3)):tn.a.warning("Create  fail:"+e.msg,10)},function(e){tn.a.error("Create  fail:"+e,10)})})},a.onTeamSelect=function(e){wn.onTeamSelect(Object(b.a)(Object(b.a)(a)),e),On.fetchMembersByTeam(Object(b.a)(Object(b.a)(a)),e,"members")},a.teamCards=e.parent,a.state={teams:[],roles:[],members:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(_,this,"teams")}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("teamName",{rules:[{required:!0,message:"Please choose the team name"}]})(wn.teamSelect(t,function(e){t.onTeamSelect(e)}))),n.createElement(gn.a.Item,null,e("roleName",{rules:[{required:!0,message:"Please input the role name"}]})(wn.roleSelect(t,function(){},"multiple"))),n.createElement(gn.a.Item,null,e("userName",{rules:[{required:!0,message:"Please input the member name"}]})(wn.memberSelect(t,function(){},"multiple"))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Create")))}}]),t}(n.Component),Rn=gn.a.create({name:"add_member_for_role"})(xn),Mn=(n.Component,function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,t){e||new w(V).request2(t,function(e){"success"===e.msg?tn.a.success("Create  success",3):tn.a.warning("Create  fail:"+e.msg,10)},function(e){tn.a.error("Create  fail:"+e,10)})})},a.renderTeams=function(){return a.state.teams.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.renderTableTypes=function(){return a.state.tableTypes.map(function(e){return n.createElement(te.a.Option,{key:e.value,name:e.value},e.value)})},a.renderSourceTypes=function(){return a.state.sourceTypes.map(function(e){return n.createElement(te.a.Option,{key:e.value,name:e.value},e.value)})},a.teamCards=e.parent,a.state={teams:[],tableTypes:[],sourceTypes:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(_,this,"teams"),On.fetchTableTypes(this,"tableTypes"),On.fetchSourceTypes(this,"sourceTypes")}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("teamName",{rules:[{required:!0,message:"Please choose the team name"}]})(n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200}},this.renderTeams()))),n.createElement(gn.a.Item,null,e("name",{rules:[{required:!0,message:"Please input the table name"}]})(n.createElement(Zt.a,{prefix:n.createElement(xt.a,{type:"table",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"table name"}))),n.createElement(gn.a.Item,null,e("db",{rules:[]})(n.createElement(Zt.a,{prefix:n.createElement(xt.a,{type:"table",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"db name"}))),n.createElement(gn.a.Item,null,e("tableType",{rules:[{required:!0,message:"Please input the table type you want to create"}]})(n.createElement(te.a,{placeholder:"table Type",size:"large",style:{width:200}},this.renderTableTypes()))),n.createElement(gn.a.Item,null,e("sourceType",{rules:[]})(n.createElement(te.a,{placeholder:"source Type",size:"large",style:{width:200}},this.renderSourceTypes()))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Create")))}}]),t}(n.Component)),In=gn.a.create({name:"add_table_for_team"})(Mn),_n=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onRoleSelect=function(e){a.currentRoleName=e,On.fetchMembersByRole(Object(b.a)(Object(b.a)(a)),a.currentTeamName,a.currentRoleName,"members")},a.refresh=function(){a.currentTeamName&&a.currentRoleName&&On.fetchMembersByRole(Object(b.a)(Object(b.a)(a)),a.currentTeamName,a.currentRoleName,"members")},a.renderCommand=function(e){var t=Object(b.a)(Object(b.a)(a));return[n.createElement("a",{onClick:function(){a.currentTeamName&&a.currentRoleName&&On.removeRoleMember(Object(b.a)(Object(b.a)(a)),a.currentTeamName,a.currentRoleName,e,null,function(){t.refresh()})}},"remove")]},a.renderMembers=function(){return n.createElement(en.a,{dataSource:a.state.members,renderItem:function(e){return n.createElement(en.a.Item,{key:e.name,actions:a.renderCommand(e.name)},n.createElement(en.a.Item.Meta,{title:e.name}))}})},a.teamCards=e.parent,a.apiUrl=e.apiUrl,a.state={teams:[],roles:[],members:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(_,this,"teams")}},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(Jt.a,{gutter:16},n.createElement(Wt.a,null,wn.teamSelect(e,function(t){wn.onTeamSelect(e,t)}))),n.createElement("br",null),n.createElement(Jt.a,{gutter:16},n.createElement(Wt.a,null,wn.roleSelect(e,e.onRoleSelect,"default"))),n.createElement("br",null),n.createElement(Jt.a,{gutter:16},n.createElement(Wt.a,null,this.renderMembers())))}}]),t}(n.Component),Pn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).openNotificationWithIcon=function(e,t,a){f.a[e]({message:t,description:a})},a.parent=e.parent,a.state={},a.teamRolesRef=n.createRef(),a.teamMembersRef=n.createRef(),a.teamsRef=n.createRef(),a.roleTablesRef=n.createRef(),a.roleMembersRef=n.createRef(),a.teamYourJoinRef=n.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:16},n.createElement($t.a,{title:"Team belongs to you",bordered:!1},n.createElement(jn,{parent:this,ref:this.teamsRef,apiUrl:_}))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Create new team",bordered:!1},n.createElement(vn,{parent:this})))),n.createElement("br",null),n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:16},n.createElement($t.a,{title:"View members By Team",bordered:!1},n.createElement(Cn,{ref:this.teamMembersRef,parent:this,apiUrl:_}))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Invite members",bordered:!1},n.createElement(kn,{parent:this})))),n.createElement("br",null),n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:12},n.createElement($t.a,{title:"Team you join",bordered:!1},n.createElement(jn,{parent:this,ref:this.teamYourJoinRef,apiUrl:"/api_v1/team/joined"}))),n.createElement(Wt.a,{span:12},n.createElement($t.a,{title:"Team inviting you",bordered:!1},n.createElement(jn,{parent:this,apiUrl:P})))),n.createElement("br",null),n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:16},n.createElement($t.a,{title:"View Roles By Team",bordered:!1},n.createElement(Nn,{ref:this.teamRolesRef,parent:this,apiUrl:B}))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Add role to Team",bordered:!1},n.createElement(Dn,{parent:this})))),n.createElement("br",null),n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:16},n.createElement($t.a,{title:"View members By Role",bordered:!1},n.createElement(_n,{parent:this,ref:this.roleMembersRef}))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Add Member to Role",bordered:!1},n.createElement(Rn,{parent:this})))))}}]),t}(n.Component),Ln=a(448),An=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"fetchBackends",value:function(t,a,n,r){var c=new w("/api_v1/cluster"),o=Object.assign(a,{action:"/backend/list"});c.request2(o,function(e){n&&t.setState(Object(yn.a)({},n,e)),r&&r()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"checkBackendName",value:function(t,a,n,r){var c=new w("/api_v1/cluster"),o=Object.assign({name:a},{action:"/backend/name/check"});c.request2(o,function(e){n&&t.setState(Object(yn.a)({},n,e)),r&&r(e)},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchBackendsByNames",value:function(t,a,n,r){var c=new w("/api_v1/cluster"),o=Object.assign({names:a},{action:"/backend/list/names"});c.request2(o,function(e){n&&t.setState(Object(yn.a)({},n,e)),r&&r(e)},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"fetchBackendNamesByTeam",value:function(t,a,n,r){new w("/api_v1/backends").request2({teamName:a},function(e){n&&t.setState(Object(yn.a)({},n,e)),r&&r(e)},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"addBackend",value:function(t,a,n,r){var c=new w("/api_v1/cluster"),o=Object.assign(a,{action:"/backend/add"});c.request2(o,function(e){n&&t.setState(Object(yn.a)({},n,e)),r&&r()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"removeBackend",value:function(t,a,n,r){var c=new w("/api_v1/cluster"),o=Object.assign({name:a},{action:"/backend/remove"});c.request2(o,function(e){n&&t.setState(Object(yn.a)({},n,e)),r&&r()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}},{key:"updateBackendTags",value:function(t,a,n,r,c){var o=new w("/api_v1/cluster"),i=Object.assign({tags:n,name:a},{action:"/backend/tags/update",merge:"append"});o.request2(i,function(e){r&&t.setState(Object(yn.a)({},r,e)),c&&c()},function(t){tn.a.warning("load data fail:"+t,e.MESSAGE_TIMEOUT)})}}]),e}();An.MESSAGE_TIMEOUT=10;var qn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).renderBackends=function(){return n.createElement(Ve,{ref:a.dataViewer,parent:Object(b.a)(Object(b.a)(a))})},a.onRoleSelect=function(e){var t=Object(b.a)(Object(b.a)(a)),r=t.currentTeamName+"_"+e;An.fetchBackends(Object(b.a)(Object(b.a)(a)),{tag:r},"backends",function(){t.dataViewer.current.update(t.state.backends.map(function(a){a.ecsResourcePoolId,a.id,a.tags;var r=Object(Ln.a)(a,["ecsResourcePoolId","id","tags"]);return r.command=n.createElement(Y.a,{onClick:function(a){An.removeBackend(t,r.name,null,function(){t.onRoleSelect(e)})}},"remove"),r}),{})})},a.parent=e.parent,a.dataViewer=n.createRef(),a.state={teams:[],roles:[],backends:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(_,this,"teams")}},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(Jt.a,null,n.createElement(Wt.a,null,wn.teamSelect(e,function(t){wn.onTeamSelect(e,t)}))),n.createElement("br",null),n.createElement(Jt.a,null,n.createElement(Wt.a,null,wn.roleSelect(e,e.onRoleSelect))),n.createElement("br",null),n.createElement(Jt.a,null,n.createElement(Wt.a,null,this.renderBackends())))}}]),t}(n.Component),Bn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,a){if(!e){var n=a.teamName,r=a.roleName,c=a.name,o=a.url,i=r.map(function(e){return n+"_"+e}).reduce(function(e,t){return e.push(t),e},[]).join(",");An.addBackend(t,{name:c,url:o,tag:i,teamName:n},null,function(){tn.a.success("Add backend success")})}})},a.onTeamSelect=function(e){On.fetchRoles(Object(b.a)(Object(b.a)(a)),e,"roles")},a.renderTeams=function(){return a.state.teams.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.renderRoles=function(){return a.state.roles.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.checkBackendName=function(e,t,n){An.checkBackendName(Object(b.a)(Object(b.a)(a)),t,null,function(e){e.msg?n("Name have been taken. Try another."):n()})},a.teamCards=e.parent,a.state={teams:[],roles:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(_,this,"teams")}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("name",{rules:[{required:!0,message:"Please input the backend name"},{validator:this.checkBackendName}]})(n.createElement(Zt.a,{prefix:n.createElement(xt.a,{type:"table",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"backend name"}))),n.createElement(gn.a.Item,null,e("url",{rules:[{required:!0,message:"Please input the url name"}]})(n.createElement(Zt.a,{prefix:n.createElement(xt.a,{type:"table",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"url e.g. 127.0.0.1:9003"}))),n.createElement(gn.a.Item,null,e("teamName",{rules:[{required:!0,message:"Please input the team name"}]})(n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200},onChange:this.onTeamSelect},this.renderTeams()))),n.createElement(gn.a.Item,null,e("roleName",{rules:[{required:!0,message:"Please input the role name"}]})(n.createElement(te.a,{mode:"multiple",placeholder:"role name",size:"large",style:{width:200}},this.renderRoles()))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Create")))}}]),t}(n.Component),Vn=gn.a.create({name:"add_backend_for_cluster"})(Bn),Fn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,a){e||new w(B).request2(a,function(e){"success"===e.msg?(tn.a.success("Create roles success",3),t.teamCards.teamsRef.current.refresh()):tn.a.warning("Create roles fail:"+e.msg,10)},function(e){tn.a.error("Create roles fail:"+e,10)})})},a.onTeamSelect=function(e){On.fetchRoles(Object(b.a)(Object(b.a)(a)),e,"roles")},a.renderTeams=function(){return a.state.teams.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.renderRoles=function(){return a.state.roles.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.renderTags=function(){return a.state.tags.map(function(e){return n.createElement(te.a.Option,{key:e,name:e},e)})},a.teamCards=e.parent,a.state={teams:[],roles:[],tags:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;On.fetchTeams(_,this,"teams"),An.fetchBackends(this,"backends",function(){var t=e.state.backends.map(function(e){return e.tags}).reduce(function(e,t){return e.push.apply(e,Object(et.a)(t)),e},[]),a=new Set(t);e.setState({tags:Object(et.a)(a)})})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("teamName",{rules:[{required:!0,message:"Please input the team name"}]})(n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200},onChange:this.onTeamSelect},this.renderTeams()))),n.createElement(gn.a.Item,null,e("roleName",{rules:[{required:!0,message:"Please input the role name"}]})(n.createElement(te.a,{mode:"multiple",placeholder:"role name",size:"large",style:{width:200}},this.renderRoles()))),n.createElement(gn.a.Item,null,e("tag",{rules:[{required:!0,message:"Please input the tag name"}]})(n.createElement(te.a,{mode:"multiple",placeholder:"tag name",size:"large",style:{width:200}},this.renderTags()))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Create")))}}]),t}(n.Component),Un=(gn.a.create({name:"add_tag_to_role"})(Fn),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,t){e||new w(C).request2({backendTags:t.tag},function(e){console.log(e),console.log(t.tag),e.backendTags.includes(t.tag)?tn.a.success("Set Default backend success",3):tn.a.warning("Set Default backend fail:"+e.backendTags,10)},function(e){tn.a.error("Set Default backend fail:"+e,10)})})},a.renderTags=function(){return a.state.tags.map(function(e){return n.createElement(te.a.Option,{key:e,name:e},e)})},a.onRoleSelect=function(e){var t=Object(b.a)(Object(b.a)(a));a.currentRoleName=e;var n=a.currentTeamName;An.fetchBackends(Object(b.a)(Object(b.a)(a)),{tag:n+"_"+e},"backends",function(){t.state.backends.length>0?t.setState({tags:[n+"_"+e]}):t.setState({tags:[]})})},a.teamCards=e.parent,a.state={teams:[],roles:[],tags:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams("/api_v1/team/in",this,"teams")}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("teamName",{rules:[{required:!0,message:"Please input the team name"}]})(wn.teamSelect(t,function(e){wn.onTeamSelect(t,e)}))),n.createElement(gn.a.Item,null,e("roleName",{rules:[{required:!0,message:"Please input the role name"}]})(wn.roleSelect(t,function(e){t.onRoleSelect(e)},"default"))),n.createElement(gn.a.Item,null,e("tag",{rules:[{required:!0,message:"Please input the tag name"}]})(n.createElement(te.a,{mode:"default",placeholder:"tag name",size:"large",style:{width:200}},this.renderTags()))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Set Default")))}}]),t}(n.Component)),Gn=gn.a.create({name:"configure_default_backend"})(Un),zn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,a){if(!e){var n=a.teamName,r=a.roleName,c=a.backendName,o=r.map(function(e){return n+"_"+e}).reduce(function(e,t){return e.push(t),e},[]).join(",");An.updateBackendTags(t,c,o,null,function(){tn.a.success("Update backend tags success")})}})},a.teamCards=e.parent,a.state={teams:[],roles:[],backends:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(_,this,"teams")}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,t("teamName",{rules:[{required:!0,message:"Please input the team name"}]})(wn.teamSelect(this,function(t){An.fetchBackendNamesByTeam(e,t,null,function(t){An.fetchBackendsByNames(e,t.map(function(e){return e.name}).join(","),"backends",function(){console.log(e.state.backends)})}),wn.onTeamSelect(e,t)}))),n.createElement(gn.a.Item,null,t("roleName",{rules:[{required:!0,message:"Please input the role name"}]})(wn.roleSelect(this,function(e){},"multiple"))),n.createElement(gn.a.Item,null,t("backendName",{rules:[{required:!0,message:"Please input the backend name"}]})(wn.backendSelect(this,function(e){},"multiple"))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Confirm")))}}]),t}(n.Component),Qn=gn.a.create({name:"AddExistClusterBackendToRole"})(zn),Kn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,t){e||new w(C).request2({backendTags:t.tag,isScheduler:!0},function(e){console.log(e),console.log(t.tag),e.backendTags.includes(t.tag)?tn.a.success("Set Default backend success",3):tn.a.warning("Set Default backend fail:"+e.backendTags,10)},function(e){tn.a.error("Set Default backend fail:"+e,10)})})},a.renderTags=function(){return a.state.tags.map(function(e){return n.createElement(te.a.Option,{key:e,name:e},e)})},a.onRoleSelect=function(e){var t=Object(b.a)(Object(b.a)(a));a.currentRoleName=e;var n=a.currentTeamName;An.fetchBackends(Object(b.a)(Object(b.a)(a)),{tag:n+"_"+e},"backends",function(){t.state.backends.length>0?t.setState({tags:[n+"_"+e]}):t.setState({tags:[]})})},a.teamCards=e.parent,a.state={teams:[],roles:[],tags:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams("/api_v1/team/in",this,"teams")}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("teamName",{rules:[{required:!0,message:"Please input the team name"}]})(wn.teamSelect(t,function(e){wn.onTeamSelect(t,e)}))),n.createElement(gn.a.Item,null,e("roleName",{rules:[{required:!0,message:"Please input the role name"}]})(wn.roleSelect(t,function(e){t.onRoleSelect(e)},"default"))),n.createElement(gn.a.Item,null,e("tag",{rules:[{required:!0,message:"Please input the tag name"}]})(n.createElement(te.a,{mode:"default",placeholder:"tag name",size:"large",style:{width:200}},this.renderTags()))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Set Default")))}}]),t}(n.Component),Hn=gn.a.create({name:"configure_default_backend"})(Kn),Jn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).openNotificationWithIcon=function(e,t,a){f.a[e]({message:t,description:a})},a.parent=e.parent,a.backendsRef=n.createRef(),a.state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Set default backend tag",bordered:!1},n.createElement(Gn,{parent:this}))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Set default scheduler backend tag",bordered:!1},n.createElement(Hn,{parent:this}))),n.createElement(Wt.a,{span:8},n.createElement($t.a,{title:"Add Backend",bordered:!1},n.createElement(Vn,{parent:this})))),n.createElement("br",null),n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:24},n.createElement($t.a,{title:"Your Backends",bordered:!1},n.createElement(qn,{parent:this,ref:this.backendsRef})))),n.createElement("br",null),n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:24},n.createElement($t.a,{title:"Add role to backend",bordered:!1},n.createElement(Qn,{parent:this})))))}}]),t}(n.Component),Wn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).selectTeam=function(e){a.currentTeam=e,On.fetchRoles(Object(b.a)(Object(b.a)(a)),e,"roles")},a.onRoleSelect=function(e){a.currentRole=e,On.fetchTablesByRole(Object(b.a)(Object(b.a)(a)),a.currentTeam,e,"tables")},a.refresh=function(){a.currentTeam&&a.currentRole&&On.fetchTablesByRole(Object(b.a)(Object(b.a)(a)),a.currentTeam,a.currentRole,"tables")},a.renderCommand=function(e){var t=Object(b.a)(Object(b.a)(a));return[n.createElement("a",{onClick:function(){a.currentTeam&&a.currentRole&&On.removeRoleTable(Object(b.a)(Object(b.a)(a)),a.currentTeam,a.currentRole,e,null,function(){t.refresh()})}},"remove")]},a.renderRoles=function(){return a.state.roles.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.sourceType=function(e,t){return"undefined"===e?t:e},a.renderTables=function(){return n.createElement(en.a,{dataSource:a.state.tables,renderItem:function(e){return n.createElement(en.a.Item,{key:e.name,actions:a.renderCommand(e.id)},n.createElement(en.a.Item.Meta,{title:e.tableType+":"+a.sourceType(e.sourceType,e.tableType)+":"+e.name+":"+e.operateType}))}})},a.teamCards=e.parent,a.apiUrl=e.apiUrl,a.state={teams:[],roles:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(_,this,"teams")}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(Jt.a,{gutter:16},n.createElement(Wt.a,null,n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200},onChange:this.selectTeam},wn.renderTeamsForSelect(this)))),n.createElement("br",null),n.createElement(Jt.a,{gutter:16},n.createElement(Wt.a,null,n.createElement(te.a,{placeholder:"role name",size:"large",style:{width:200},onChange:this.onRoleSelect},this.renderRoles()))),n.createElement("br",null),n.createElement(Jt.a,{gutter:16},n.createElement(Wt.a,null,this.renderTables())))}}]),t}(n.Component),$n=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,a){e||new w(F).request2(a,function(e){"success"===e.msg?(t.authCards.roleTablesRef.current.refresh(),tn.a.success("Create  success",3)):tn.a.warning("Create  fail:"+e.msg,10)},function(e){tn.a.error("Create  fail:"+e,10)})})},a.onTeamSelect=function(e){On.fetchRoles(Object(b.a)(Object(b.a)(a)),e,"roles"),On.fetchTables(Object(b.a)(Object(b.a)(a)),e,"tables"),On.fetchOperateTypes(Object(b.a)(Object(b.a)(a)),"operateTypes")},a.renderTeams=function(){return a.state.teams.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.renderRoles=function(){return a.state.roles.map(function(e){return n.createElement(te.a.Option,{key:e.name,name:e.name},e.name)})},a.sourceType=function(e,t){return"undefined"===e?t:e},a.renderTables=function(){return a.state.tables.map(function(e){return n.createElement(te.a.Option,{key:e.name,value:e.id},e.tableType,":",a.sourceType(e.sourceType,e.tableType),":",e.db,".",e.name)})},a.renderOperateTypes=function(){return a.state.operateTypes.map(function(e){return n.createElement(te.a.Option,{key:e.value,name:e.value},e.value)})},a.authCards=e.parent,a.state={teams:[],roles:[],tables:[],operateTypes:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){On.fetchTeams(_,this,"teams")}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("teamName",{rules:[{required:!0,message:"Please choose the team name"}]})(n.createElement(te.a,{placeholder:"Team name",size:"large",style:{width:200},onChange:this.onTeamSelect},this.renderTeams()))),n.createElement(gn.a.Item,null,e("roleName",{rules:[{required:!0,message:"Please input the role name "}]})(n.createElement(te.a,{placeholder:"role name",size:"large",style:{width:200}},this.renderRoles()))),n.createElement(gn.a.Item,null,e("tableName",{rules:[{required:!0,message:"Please input the tableName name "}]})(n.createElement(te.a,{mode:"multiple",placeholder:"table name",size:"large",style:{width:200}},this.renderTables()))),n.createElement(gn.a.Item,null,e("operateType",{rules:[{required:!0,message:"Please input the operateType to Role "}]})(n.createElement(te.a,{mode:"multiple",placeholder:"Operate type",size:"large",style:{width:200}},this.renderOperateTypes()))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Create")))}}]),t}(n.Component),Yn=gn.a.create({name:"add_table_for_role"})($n),Xn=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).parent=e.parent,a.roleTablesRef=n.createRef(),a.state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:12},n.createElement($t.a,{title:"Add Table to Team",bordered:!1},n.createElement(In,{parent:this}))),n.createElement(Wt.a,{span:12},n.createElement($t.a,{title:"Add table to role",bordered:!1},n.createElement(Yn,{parent:this})))),n.createElement("br",null),n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:24},n.createElement($t.a,{title:"View tables By Role",bordered:!1},n.createElement(Wn,{parent:this,ref:this.roleTablesRef})))),n.createElement("br",null))}}]),t}(n.Component),Zn=Za.a.Step,er=(a(117),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).openNotificationWithIcon=function(e,t,a){f.a[e]({message:t,description:a})},a.state={current:0},a.steps=a.generateSteps(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"generateSteps",value:function(){var e=this;return[{title:"Create Team",content:function(){return n.createElement($t.a,{title:"input your team name",bordered:!0},n.createElement(vn,{parent:e}))}},{title:"Create Role",content:function(){return n.createElement($t.a,{title:"Add new role to the team you have created",bordered:!0},n.createElement(Dn,{parent:e}))}},{title:"Invite user to Role",content:function(){return n.createElement($t.a,{title:"Add member to the role you have created",bordered:!0},n.createElement(Rn,{parent:e}))}},{title:"Create Backend",content:function(){return n.createElement($t.a,{title:"Add the cluster information you have setup",bordered:!0},n.createElement(Vn,{parent:e}))}},{title:"Set default backend",content:function(){return n.createElement($t.a,{title:"Configure the default backend you want use",bordered:!0},n.createElement(Gn,{parent:e}))}},{title:"Congratulation!",content:function(){return n.createElement($t.a,{title:"All Done",bordered:!0},"Please go to Console")}}]}},{key:"componentDidMount",value:function(){}},{key:"next",value:function(){var e=this.state.current+1;this.setState({current:e})}},{key:"prev",value:function(){var e=this.state.current-1;this.setState({current:e})}},{key:"render",value:function(){var e=this,t=this.state.current;return n.createElement("div",null,n.createElement("div",{className:"steps-action",style:{marginBottom:"30px"}},t<this.steps.length-1&&n.createElement(Y.a,{type:"primary",onClick:function(){return e.next()}},"Next Step"),t===this.steps.length-1&&n.createElement(Y.a,{type:"primary",onClick:function(){return tn.a.success("Processing complete!")}},"Done"),t>0&&n.createElement(Y.a,{style:{marginLeft:8},onClick:function(){return e.prev()}},"Previous Step")),n.createElement(Za.a,{current:t},this.steps.map(function(e){return n.createElement(Zn,{key:e.title,title:e.title})})),n.createElement("div",{className:"steps-content",style:{"margin-top":"30px"}},n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:8}),n.createElement(Wt.a,{span:8},this.steps[t].content()))))}}]),t}(n.Component)),tr=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();Object(b.a)(Object(b.a)(a));a.props.form.validateFields(function(e,t){e||new w(G).request2(t,function(e){"success"===e.msg?tn.a.success("Success",3):tn.a.warning("Fail:"+e.msg,10)},function(e){tn.a.error("Fail:"+e,10)})})},a.teamCards=e.parent,a.state={teams:[],roles:[],members:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.createElement(gn.a,{onSubmit:this.handleSubmit,className:"login-form"},n.createElement(gn.a.Item,null,e("password",{rules:[{required:!0,message:"Please input the original password"}]})(n.createElement(Zt.a,{type:"password",prefix:n.createElement(xt.a,{type:"password",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"old password"}))),n.createElement(gn.a.Item,null,e("newPassword",{rules:[{required:!0,message:"Please input the new password"}]})(n.createElement(Zt.a,{type:"password",prefix:n.createElement(xt.a,{type:"password",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"new password"}))),n.createElement(gn.a.Item,null,n.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Apply")))}}]),t}(n.Component),ar=gn.a.create({name:"change_password"})(tr),nr=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).parent=e.parent,a.roleTablesRef=n.createRef(),a.state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},n.createElement(Jt.a,{gutter:24},n.createElement(Wt.a,{span:12},n.createElement($t.a,{title:"Change password",bordered:!1},n.createElement(ar,{parent:this})))),n.createElement("br",null))}}]),t}(n.Component),rr=Ya.a.Header,cr=Ya.a.Content,or=Ya.a.Footer,ir=Ya.a.Sider,lr=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).switchToBasic=function(){a.setState({currentView:Ka})},a.switchToSetup=function(){a.setState({currentView:Ha})},a.switchToCluster=function(){a.setState({currentView:Ja})},a.switchToAuth=function(){a.setState({currentView:Wa})},a.switchToSetting=function(){a.setState({currentView:$a})},a.renderView=function(){return a.state.currentView===Ha?n.createElement(er,null):a.state.currentView===Ka?n.createElement(Pn,null):a.state.currentView===Ja?n.createElement(Jn,null):a.state.currentView===Wa?n.createElement(Xn,null):a.state.currentView===$a?n.createElement(nr,null):void 0},a.app=e.parent,a.state={currentView:Ha},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement(Ya.a,{style:{minHeight:"100vh"}},n.createElement(ir,null,n.createElement("div",{className:"logo"}),n.createElement(Xa.a,{theme:"dark",defaultSelectedKeys:["0"],mode:"inline"},n.createElement(Xa.a.Item,{key:"0"},n.createElement(Y.a,{block:!0,onClick:this.switchToSetup},"Setup")),n.createElement(Xa.a.Item,{key:"1"},n.createElement(Y.a,{block:!0,onClick:this.switchToBasic},"Team")),n.createElement(Xa.a.Item,{key:"2"},n.createElement(Y.a,{block:!0,onClick:this.switchToCluster},"Cluster")),n.createElement(Xa.a.Item,{key:"3"},n.createElement(Y.a,{block:!0,onClick:this.switchToAuth},"Auth")),n.createElement(Xa.a.Item,{key:"4"},n.createElement(Y.a,{block:!0,onClick:this.switchToSetting},"Setting")))),n.createElement(Ya.a,null,n.createElement(rr,{style:{background:"#fff",padding:0}}),n.createElement(cr,{style:{margin:"0 16px"}},n.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},this.renderView())),n.createElement(or,{style:{textAlign:"center"}})))}}]),t}(n.Component),sr=function(e){function t(e){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(lr,{parent:this}))}}]),t}(n.Component),ur=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).nav=e.nav,a.state={content:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({content:Object.entries(this.nav.collected_params).filter(function(e){return e[1]}).map(function(e){return"set ".concat(e[0],"='''").concat(e[1],"''';")}).join("\n")+"\ninclude plugin.`".concat(this.nav.current_plugin_name,"`;")})}},{key:"render",value:function(){return n.createElement("div",{className:"steps-content",style:{"margin-top":"30px"}},n.createElement("pre",null,this.state.content))}}]),t}(n.Component),mr=Za.a.Step,dr={labelCol:{span:4},wrapperCol:{span:8}},pr={labelCol:{span:4},wrapperCol:{span:8,offset:4}},hr=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).buildForm=function(e){if(e.hasOwnProperty("final"))return n.createElement(ur,{nav:a.nav});var t=e.params,r=a.props.form.getFieldDecorator;return t.map(function(e){return n.createElement(gn.a.Item,Object.assign({},dr,{label:e.name}),r(e.name,{rules:[{required:e.required,message:"Please input ".concat(e.required,"!")}]})(n.createElement(Zt.a,{type:"input",placeholder:e.desc})))})},a.state={current:0,steps:e.steps.concat([{desc:"MLSQL Script",final:!0}])},a.nav=e.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"next",value:function(){var e=this;this.props.form.validateFields(function(t,a){if(!t){console.log("Received values of form: ",a);var n=e.state.current+1;e.setState({current:n}),e.nav.pushParam(a)}})}},{key:"prev",value:function(){var e=this.state.current-1;this.setState({current:e})}},{key:"render",value:function(){var e=this,t=this.state.current;return n.createElement("div",null,n.createElement(Za.a,{current:t},this.state.steps.map(function(e){return n.createElement(mr,{key:e.desc,title:e.desc})})),n.createElement("div",{className:"steps-content",style:{"margin-top":"30px"}},n.createElement($t.a,{bordered:!0},n.createElement(gn.a,Object.assign({},pr,{style:{width:"600px"}}),this.buildForm(this.state.steps[t])))),n.createElement("div",{className:"steps-action",style:{marginTop:"30px"}},t<this.state.steps.length-1&&n.createElement(Y.a,{type:"primary",onClick:function(){return e.next()}},"Next Step"),t===this.state.steps.length-1&&n.createElement(Y.a,{type:"primary",onClick:function(){return tn.a.success("Processing complete!")}},"Done"),t>0&&n.createElement(Y.a,{style:{marginLeft:8},onClick:function(){return e.prev()}},"Previous Step")))}}]),t}(n.Component),fr=gn.a.create({name:"plugin-tutorial"})(hr),br=Ya.a.Header,gr=Ya.a.Content,Er=Ya.a.Footer,vr=Ya.a.Sider,yr=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).pushParam=function(e){Object.assign(a.collected_params,e)},a.showTut=function(e){a.current_plugin_name=e,new w(x).newRunScript({},"!plugin script show ".concat(e,"/plugin.json;"),function(e){a.setState({data_plugin:e.map(function(e){return JSON.parse(e.value)[a.current_plugin_name].compositor})})},function(e){})},a.state={data_menu:[],data_plugin:[]},a.collected_params={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;new w(x).newRunScript({},'!plugin list "script";',function(t){e.setState({data_menu:t},function(){t.length>0&&e.showTut(t[0].pluginName)})},function(e){})}},{key:"render",value:function(){var e=this;return n.createElement(Ya.a,{style:{minHeight:"100vh"}},n.createElement(vr,null,n.createElement("div",{className:"logo"}),n.createElement(Xa.a,{theme:"dark",defaultSelectedKeys:["0"],mode:"inline"},this.state.data_menu.map(function(t){return n.createElement(Xa.a.Item,{key:"0",onClick:function(){e.showTut(t.pluginName)}},t.pluginName)}))),n.createElement(Ya.a,null,n.createElement(br,{style:{background:"#fff",padding:0}}),n.createElement(gr,{style:{margin:"0 16px"}},n.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},this.state.data_plugin.map(function(t){return n.createElement(fr,{parent:e,steps:t})}))),n.createElement(Er,{style:{textAlign:"center"}})))}}]),t}(n.Component),Or=function(e){function t(e){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(yr,null))}}]),t}(n.Component),jr="login",Sr="register",kr=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).getLoginOrRegisterManager=function(){return a.app.registerOrLoginRef.current},a.logout=function(){a.auth.logout(),a.app.updateLoginoutStatus()},a.login=function(){a.logout(),a.getLoginOrRegisterManager().setState({loginType:jr})},a.register=function(){a.logout(),a.getLoginOrRegisterManager().setState({loginType:Sr})},a.updateLoginoutStatus=function(){a.setState({isLogin:a.auth.isLogin()})},a.auth=new Q,a.state={isLogin:a.auth.isLogin()},a.app=a.props.parent,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.auth.userName(function(t){e.setState({userName:t})})}},{key:"render",value:function(){var e=n.createElement(h.a,{className:"bp3-minimal",icon:"log-in",text:"Login",onClick:this.login}),t=n.createElement(h.a,{className:"bp3-minimal",icon:"log-out",text:"Logout",onClick:this.logout}),a=n.createElement(h.a,{className:"bp3-minimal",icon:"intersection",text:"Register",onClick:this.register});return n.createElement("div",null,this.state.isLogin?"welcome  "+this.state.userName:"",this.state.isLogin?t:e,a)}}]),t}(n.Component),wr=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).currentView=function(){return a.app.state.currentView},a.userName=function(e){a.setState({userName:e.target.value})},a.password=function(e){a.setState({password:e.target.value})},a.updateLoginoutStatus=function(){a.setState({isLogin:a.auth.isLogin()})},a.registerSuccess=function(e){var t=Object(b.a)(Object(b.a)(a));if(e.status===y.Success)a.setState({registerOrLoginSuccess:!0},function(){return t.app.updateLoginoutStatus()});else{var n=Object(b.a)(Object(b.a)(a)),r=function(e){var t=e;try{t=JSON.parse(e).msg}catch(a){}n.setState({msg:t})};e.content.then(r).catch(r)}},a.registerFail=function(e){a.setState({msg:e.value.message})},a.login=function(){new Cr(Object(b.a)(Object(b.a)(a))).validate()&&a.auth.login(a.state.userName,a.state.password,a.registerSuccess,a.registerFail)},a.register=function(){new Cr(Object(b.a)(Object(b.a)(a))).validate()&&a.auth.register(a.state.userName,a.state.password,a.registerSuccess,a.registerFail)},a.auth=new Q,a.app=a.props.parent,a.state={registerOrLoginSuccess:!1,msg:"",isLogin:a.auth.isLogin(),loginType:a.props.loginType||jr},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.auth.isLogin()&&this.currentView()===qa?n.createElement(Aa,null):this.auth.isLogin()&&this.currentView()===Va?n.createElement(bn,null):this.auth.isLogin()&&this.currentView()===Ba?n.createElement(sr,null):this.auth.isLogin()&&this.currentView()===Fa?n.createElement(Or,null):n.createElement("div",{className:"mlsql-register"},n.createElement("div",{className:"mlsql-register-form"},n.createElement(g.a,{helperText:"email",label:"userName",labelFor:"userName",labelInfo:"(required)"},n.createElement(E.a,{id:"userName",placeholder:"email",onChange:this.userName})),n.createElement(g.a,{helperText:"password",label:"password",labelFor:"password",labelInfo:"(required)"},n.createElement(E.a,{id:"password",type:"password",placeholder:"password",onChange:this.password})),n.createElement(h.a,{type:"submit",text:this.state.loginType===jr?"Login":"Register",onClick:this.state.loginType===jr?this.login:this.register}),""!==this.state.msg&&n.createElement("div",{className:"mlsql-register-messagebox"},this.state.msg)))}}]),t}(n.Component),Cr=function(){function e(t){Object(i.a)(this,e),this.parent=t}return Object(l.a)(e,[{key:"validate",value:function(){return this.validateUserName()&&this.validatePassword()}},{key:"validateUserName",value:function(){var e=/[a-zA-Z0-9]+[\.]?([a-zA-Z0-9]+)?[\@][a-z]{3,9}[\.][a-z]{2,5}/g.test(this.parent.state.userName);return e||this.parent.setState({msg:"userName should be email"}),e}},{key:"validatePassword",value:function(){var e=this.parent.state.password.length>=4;return e||this.parent.setState({msg:"the length of password should > 4"}),e}}]),e}();a(987).inject();var Tr=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).updateLoginoutStatus=function(){a.menuRef.current.updateLoginoutStatus(),a.registerOrLoginRef.current.updateLoginoutStatus()},a.switchToTeam=function(){a.setState({currentView:Ba})},a.switchToConsole=function(){a.setState({currentView:qa})},a.switchToDemo=function(){a.setState({currentView:Va})},a.switchToScriptPlugins=function(){a.setState({currentView:Fa})},a.switchToCnDoc=function(){window.open("http://docs.mlsql.tech/zh/","_blank")},a.menuRef=r.a.createRef(),a.registerOrLoginRef=r.a.createRef(),a.state={currentView:qa},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(d.a,null,r.a.createElement(d.a.Group,{align:p.a.LEFT},r.a.createElement(d.a.Heading,null,"MLSQL Web Console"),r.a.createElement(d.a.Divider,null),r.a.createElement(h.a,{className:"bp3-minimal",icon:"home",text:"Console",onClick:this.switchToConsole}),r.a.createElement(h.a,{className:"bp3-minimal",icon:"document",text:"Demo Center",onClick:this.switchToDemo}),r.a.createElement(h.a,{className:"bp3-minimal",icon:"document",text:"Team",onClick:this.switchToTeam}),r.a.createElement(h.a,{className:"bp3-minimal",icon:"document",text:"Script Plugins",onClick:this.switchToScriptPlugins}),r.a.createElement(h.a,{className:"bp3-minimal",icon:"document",text:"\u4e2d\u6587\u6587\u6863",onClick:this.switchToCnDoc})),r.a.createElement(d.a.Group,{align:p.a.RIGHT},r.a.createElement(kr,{ref:this.menuRef,parent:this}))),r.a.createElement(wr,{ref:this.registerOrLoginRef,parent:this,loginType:jr}),r.a.createElement("div",{style:{bottom:"100px",textAlign:"center",width:"100%"}},"MLSQL Licensed under the Apache License, Version 2.0. @",r.a.createElement("a",{className:"copyright",href:"http://www.miitbeian.gov.cn/"},"\u6d59ICP\u590718052520\u53f7"),r.a.createElement("div",null,"@",r.a.createElement("a",{target:"_blank",href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010802009683"},r.a.createElement("img",{src:""}),"\u6d59\u516c\u7f51\u5b89\u5907 33010802009683\u53f7"))))}}]),t}(n.Component);o.a.render(r.a.createElement(Tr,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[505,1,2]]]);
//# sourceMappingURL=main.9256fcd7.chunk.js.map