(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1003:function(e,t,a){},1006:function(e,t,a){},1011:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(25),c=a.n(o);a(511),a(512),a(513),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i,s=a(6),l=a.n(s),u=a(8),p=a(18),d=(a(516),a(47)),m=a(19),f=a(7),h=a(27),b=a(34),g=a(32),v=a(83),y=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("logout"!==t.data.currentPage){e.next=7;break}return a=new b.ActionProxy,e.next=4,a.post(g.default.LOGOUT,{});case 4:return sessionStorage.removeItem(v.a.name),sessionStorage.removeItem("user"),e.abrupt("return",{data:{currentPage:"admin",logined:!1}});case 7:return e.abrupt("return",{data:{currentPage:t.data.currentPage}});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),E=y.handler,O=y.action,k=a(21),j=a(12),w=a(249),S=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,null,[{key:"setupLogin",value:function(e){var t={userName:e.content.name,role:e.content.role},a=e.resp.headers.get(v.a.name);sessionStorage.setItem(v.a.name,a),sessionStorage.setItem("user",JSON.stringify(t)),(new w.a).set(v.a.name,a,{path:"/"})}},{key:"isAdmin",value:function(){var e=sessionStorage.getItem("user");return!!e&&"admin"===JSON.parse(e).role}},{key:"logined",value:function(){return!!sessionStorage.getItem(v.a.name)}},{key:"formLayout2",value:function(){return{formItemLayout:{labelCol:{xs:{span:4},sm:{span:8}},wrapperCol:{xs:{span:4},sm:{span:8}}},tailLayout:{wrapperCol:{offset:8,span:16}}}}},{key:"formLayout1",value:function(){return{formItemLayout:{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},tailLayout:{wrapperCol:{offset:8,span:16}}}}}]),e}(),x=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="workshop","register"!==t.__state.currentPage||S.logined()||(a="register"),e.abrupt("return",{data:Object(k.a)({},t.data,{logined:S.logined(),currentPage:a})});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),C=x.handler,T=x.action,N=a(76),R=function e(){Object(f.a)(this,e)};R.SWITCH="switch",R.CHECK_LOGINED="checkLogined";var D=(i={},Object(m.a)(i,R.SWITCH,E),Object(m.a)(i,R.CHECK_LOGINED,C),Object(m.a)(i,"setState",N.SetStateActionHandler),i);function A(e,t){switch(t.type){case R.SWITCH:return O(e,t.data);case R.CHECK_LOGINED:return T(e,t.data);case"setState":return Object(N.SetStateAction)(e,t.data);default:return e}}a(517);var I=a(62),F=a(1014),P=a(424),L=a(425),_=a(426),M=a(427),q=a(428),V=a(432),B=a(429),G=I.a.SubMenu,U=r.a.createContext();function J(e){var t=e.currentPage,a=e.userLogined,o=Object(n.useContext)(Gc).dispacher,c=Object(n.useState)(t),i=Object(p.a)(c,2),s=i[0],l=i[1],u=Object(n.useState)(a),d=Object(p.a)(u,2),m=d[0],f=d[1];return Object(n.useEffect)(function(){var t=e.currentPage,a=e.userLogined;l(t),f(a)},[e]),r.a.createElement(U.Provider,null,r.a.createElement(I.a,{onClick:function(e){l(e.key),o(h.a.buildEvent(R.SWITCH,{currentPage:e.key}))},selectedKeys:[s],mode:"horizontal"},r.a.createElement(I.a.Item,{key:"home"},r.a.createElement("span",{style:{fontSize:32}},"MLSQL Web Console")),r.a.createElement(F.a,{type:"vertical"}),!m&&r.a.createElement(I.a.Item,{key:"login",icon:r.a.createElement(P.a,null)},"Login"),!m&&r.a.createElement(I.a.Item,{key:"register",icon:r.a.createElement(L.a,null)},"Register"),m&&r.a.createElement(I.a.Item,{key:"console",icon:r.a.createElement(_.a,null)},"Console"),m&&r.a.createElement(I.a.Item,{key:"workshop",icon:r.a.createElement(M.a,null)},"Analysis Workshop"),m&&r.a.createElement(I.a.Item,{key:"admin",icon:r.a.createElement(q.a,null)},"Settings"),m&&r.a.createElement(G,{icon:r.a.createElement(V.a,null),title:"More..."},r.a.createElement(I.a.Item,{key:"doc"},"\u4e2d\u6587\u6587\u6863"),r.a.createElement(I.a.Item,{key:"logout",icon:r.a.createElement(B.a,null)},"Logout"))))}var K,H=a(1030),W=a(1020),z=a(484),Q=a(61),Y=(a(329),h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r,o,c,i,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.data,n=a.userName,r=a.password,o=a.password2,r===o){e.next=3;break}return e.abrupt("return",{data:{error:"Passwords are not matched"}});case 3:return c=new b.ActionProxy,e.next=6,c.post(g.default.REGISTER,{userName:n,password:r});case 6:return i=e.sent,s={},200!==i.status?s={error:JSON.parse(i.content).msg}:(S.setupLogin(i),s={error:void 0,logined:!0,current:t.__state.current+1}),e.abrupt("return",{data:s});case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())),X=Y.handler,$=Y.action,Z=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new b.ActionProxy,e.next=3,a.post(g.default.LOGIN,t.data);case 3:if(200===(n=e.sent).status){e.next=6;break}return e.abrupt("return",{data:{logined:!1,error:JSON.parse(n.content).msg}});case 6:return S.setupLogin(n),e.abrupt("return",{data:{logined:!0}});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),ee=Z.handler,te=Z.action,ae=function e(){Object(f.a)(this,e)};ae.REGISTER="register",ae.LOGIN="login";var ne=(K={},Object(m.a)(K,ae.REGISTER,X),Object(m.a)(K,ae.LOGIN,ee),K);function re(e,t){switch(t.type){case ae.REGISTER:return $(e,t.data);case ae.LOGIN:return te(e,t.data);default:return e}}var oe=a(87),ce=a(88),ie=a(1025);function se(){var e=Object(oe.a)(["\n  width: 100%;    \n  margin: 0px 10px 10px 0px;\n"]);return se=function(){return e},e}var le=ce.a.div(se());var ue=function(e){return r.a.createElement(le,null,r.a.createElement(ie.a,Object.assign({},e,{closable:!0,type:e.type||"error",message:"Message",description:e.message})))},pe=r.a.createContext(),de={logined:!1,error:void 0};function me(){var e=Object(n.useContext)(Gc).dispacher,t=S.formLayout1(),a=t.formItemLayout,o=t.tailLayout,c=Object(d.useReducerAsync)(re,de,ne),i=Object(p.a)(c,2),s=i[0],l=i[1],u=s.logined,m=s.error;return Object(n.useEffect)(function(){e({type:R.CHECK_LOGINED,data:{}})},[u]),r.a.createElement(pe.Provider,{value:{}},r.a.createElement("div",{className:"app-console-main-register"},r.a.createElement(H.a,{title:"Register"},m&&r.a.createElement(ue,{type:"error",message:m}),r.a.createElement(W.a,Object.assign({},a,{className:"login-form",onFinish:function(e){l({type:ae.REGISTER,data:e})}}),r.a.createElement(W.a.Item,{label:"UserName",name:"userName",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(z.a,null)),r.a.createElement(W.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(z.a.Password,null)),r.a.createElement(W.a.Item,{label:"Repeated Password",name:"password2",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(z.a.Password,null)),r.a.createElement(W.a.Item,o,r.a.createElement(Q.a,{type:"primary",htmlType:"submit"},"Go"))))))}var fe={logined:!1,error:void 0},he=r.a.createContext();function be(){var e=S.formLayout1(),t=e.formItemLayout,a=e.tailLayout,o=Object(n.useContext)(Gc).dispacher,c=Object(d.useReducerAsync)(re,fe,ne),i=Object(p.a)(c,2),s=i[0],l=i[1],u=s.logined,m=s.error;return Object(n.useEffect)(function(){o({type:R.CHECK_LOGINED,data:{logined:u}})},[u]),r.a.createElement(he.Provider,null,r.a.createElement("div",{className:"app-console-main-register"},r.a.createElement(H.a,{title:"Login"},m&&r.a.createElement(ue,{type:"error",message:m}),r.a.createElement(W.a,Object.assign({},t,{className:"login-form",onFinish:function(e){l(h.a.buildEvent(ae.LOGIN,e))}}),r.a.createElement(W.a.Item,{label:"UserName",name:"userName",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(z.a,null)),r.a.createElement(W.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(z.a.Password,null)),r.a.createElement(W.a.Item,a,r.a.createElement(Q.a,{type:"primary",htmlType:"submit"},"Go"))))))}var ge=a(10),ve=a(9),ye=a(11),Ee=a(13),Oe=(a(176),a(266),a(69)),ke=a.n(Oe),je=(a(343),a(267),a(268),a(34).ActionProxy),we=a(32).default,Se=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,null,[{key:"getSuggestList",value:function(){var e=Object(u.a)(l.a.mark(function e(t,a,n){var r,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new je,e.next=3,r.post(we.RUN,{executeMode:"autoSuggest",sql:t,lineNum:a+1,columnNum:n,isDebug:!1,queryType:"robot"});case 3:if(!(o=e.sent)||200!==o.status){e.next=9;break}return c=o.content,e.abrupt("return",c);case 9:return e.abrupt("return",[]);case 10:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}()}]),e}(),xe=(a(344),a(1023)),Ce={GET:"get",POST:"post",PUT:"put"},Te=401,Ne={name:"access-token"},Re="/api_v1/script_file",De="/api_v1/run/script",Ae="/api_v1/file/upload",Ie=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,[{key:"isLogin",value:function(){return null!==sessionStorage.getItem(Ne.name)}},{key:"userName",value:function(e){new _e("/api_v1/user/userName").request(Ce.GET,{},function(t){t.status===Te?sessionStorage.removeItem(Ne.name):t.content.then(function(t){e(JSON.parse(t).userName)}).catch(function(e){})},function(e){console.log(e)})}},{key:"user",value:function(e){new _e("/api_v1/user/userName").request2({},function(t){e(t)},function(e){})}},{key:"login",value:function(e,t,a,n){this.registerOrLogin("/api_v1/user/login",e,t,a,n)}},{key:"logout",value:function(){sessionStorage.removeItem(Ne.name)}},{key:"register",value:function(e,t,a,n){this.registerOrLogin("/api_v1/user/register",e,t,a,n)}},{key:"registerOrLogin",value:function(e,t,a,n,r){var o={userName:t,password:a};new _e(e).request(Ce.POST,o,function(e){e.accessToken&&(sessionStorage.setItem(Ne.name,e.accessToken),(new w.a).set(Ne.name,e.accessToken,{path:"/"}));n(e)},function(e){r(e)})}}]),e}(),Fe=a(103),Pe=function e(t){Object(f.a)(this,e),this.value=t},Le=function e(t,a,n){var r=this;Object(f.a)(this,e),this.json=function(e,t){r.content.then(function(a){try{var n=JSON.parse(a);e(n)}catch(r){console.log(r),t(a)}})},this.status=t,this.content=a,this.accessToken=n},_e=function(){function e(t){Object(f.a)(this,e),this.url=t}return Object(j.a)(e,[{key:"request2",value:function(e,t,a){this.request(Ce.POST,e,function(e){e.json(function(e){t(e)},function(e){a(e)})},function(e){try{e.value().content(function(e){var t=e;try{t=JSON.parse(e).msg}catch(n){}a(t)})}catch(t){a(e?e.toString():"result is null")}})}},{key:"runScript",value:function(e,t,a,n){var r=new Ie,o=Fe(),c=this;r.user(function(r){var i=r.userName,s=r.backendTags,l={sql:t,owner:i,jobName:o,sessionPerUser:!0,show_stack:!0,skipAuth:!1,tags:s||""};Object.assign(l,e),(e.background||!1)&&Object.assign(l,{async:!0,callback:""}),c.request(Ce.POST,l,function(e){if(200===e.status)e.json(function(e){a(e)},function(e){n(e)});else try{e.content.then(function(t){var a=t;try{a=JSON.parse(t).msg}catch(r){}n("backend status:"+e.status+"\n"+a)})}catch(t){n("backend status:"+e.status)}},function(e){try{e.value().content(function(e){var t=e;try{t=JSON.parse(e).msg}catch(a){}n(t)})}catch(t){n(e?e.toString():"result is null")}})})}},{key:"request",value:function(e,t,a,n){e=e.toUpperCase();var r=[];for(var o in t){var c=encodeURIComponent(o),i=encodeURIComponent(t[o]);r.push(c+"="+i)}var s=this.url;return"GET"===e?(s=s+"?"+r,r=void 0):r=r.join("&"),fetch(s,{method:e,timeout:864e5,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","Access-Token":sessionStorage.getItem(Ne.name)||""},body:r}).then(function(e){a(new Le(e.status,e.text(),e.headers.get(Ne.name)))}).catch(function(e){n(new Pe(e))})}},{key:"newRunScript",value:function(e,t,a,n){var r=new Ie,o=Fe(),c=this;r.user(function(r){var i=r.userName,s=r.backendTags;if(s){var l={sql:t,owner:i,jobName:o,sessionPerUser:!0,show_stack:!0,skipAuth:!1,tags:s||""};Object.assign(l,e),(e.background||!1)&&Object.assign(l,{async:!0,callback:""}),c.new_request(Ce.POST,l,a,n)}else n("\n                \n                ---------------Warning--------------------\n                \n                Please make sure you have backend configured. \n                If not, please contact admin;\n                \n                ------------------------------------------\n                ")})}},{key:"new_request",value:function(e,t,a,n){e=e.toUpperCase();var r=[];for(var o in t){var c=encodeURIComponent(o),i=encodeURIComponent(t[o]);r.push(c+"="+i)}var s=this.url;"GET"===e?(s=s+"?"+r,r=void 0):r=r.join("&");var l=0;return fetch(s,{method:e,timeout:864e5,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","Access-Token":sessionStorage.getItem(Ne.name)||""},body:r}).then(function(e){return 200===(l=e.status)&&e.json().then(function(e){a(e)}),e}).then(function(e){var t=function(){e.text().then(function(e){try{n(JSON.parse(e).msg)}catch(t){n(e)}})};switch(l){case 201:break;case 400:case 500:t();break;default:console.log("unhandled")}}).catch(function(e){n(e.message)})}}]),e}(),Me=function(e,t){if(!e){if(t=t||"Assertion failed","undefined"!==typeof Error)throw new Error(t);throw t}},qe=function e(){Object(f.a)(this,e),this.makeSQL=function(e){return"JobList"===e?"load _mlsql_.`jobs` as output;":"ConnectMySQL"===e?'connect jdbc where\n url="jdbc:mysql://127.0.0.1:3306/wow?characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&tinyInt1isBit=false"\n and driver="com.mysql.jdbc.Driver"\n and user=""\n and password=""\n as db_1;':"ShowResource"===e?"load _mlsql_.`resource` as output;":""}},Ve=a(186),Be=a(94),Ge=function(e){function t(e){return Object(f.a)(this,t),Object(ge.a)(this,Object(ve.a)(t).call(this,e))}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"getText",value:function(){return this.editor.getValue()}},{key:"getSelection",value:function(){var e=this.editor.getSelectionRange();return this.session.getTextRange(e)}}]),t}(function(){function e(t){Object(f.a)(this,e),this.inner=t,this.session=this.inner.editor.session,this.editor=this.inner.editor}return Object(j.a)(e,[{key:"setText",value:function(e){return this.editor.setValue(e),this}},{key:"append",value:function(e){return this.session.insert({row:this.session.getLength(),column:0},"\n"+e),this}},{key:"insertAfterCursor",value:function(e){var t=this.editor.getCursorPosition();return this.session.insert(t,e),this.editor.focus(),this}}]),e}()),Ue=a(103),Je=new b.ActionProxy,Ke=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,null,[{key:"ls",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new b.ActionProxy,e.next=3,a.runScript("!hdfs -ls -F ".concat(t,";"),Ue(),{queryType:"robot"});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"killJob",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.runScript("!kill "+t+";",Ue(),{queryType:"robot"});case 2:return a=e.sent,e.next=5,Je.get(g.default.JOB_KILL,{jobName:t});case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"runJob",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r=arguments;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]&&r[1],e.next=3,Je.runScript(t,Ue(),{async:a});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"showFunctions",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.runScript("",Ue(),{executeMode:"sqlFunctions"});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"jobs",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ue(),e.next=3,Je.runScript("load _mlsql_.`jobs` as wow;",t,{queryType:"robot"});case 3:return a=e.sent,e.abrupt("return",{jobName:t,res:a});case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"tablesInDeltaLake",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ue(),e.next=3,Je.runScript("!delta show tables;",t,{queryType:"robot"});case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"tablesInWorkshop",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.get(g.default.ANALYSIS_TABLES,{});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"tableInfo",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.get(g.default.ANALYSIS_TABLE_INFO,{tableName:t});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"jobProgress",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r,o,c,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.runScript("load _mlsql_.`jobs/get/".concat(t,"` as wow;"),Ue(),{queryType:"robot"});case 2:if(a=e.sent,n={currentJobIndex:0,totalJobs:1},200!==a.status){e.next=17;break}if(r=a.content[0]){e.next=8;break}return e.abrupt("return",n);case 8:if(o=r.progress.currentJobIndex,1!==(c=r.progress.totalJob)){e.next=16;break}return e.next=13,Je.runScript("load _mlsql_.`jobs/".concat(t,"` as wow;"),Ue(),{queryType:"robot"});case 13:i=e.sent,o=i.content[0].completedJobsNum,c=i.content[0].activeJobsNum+o;case 16:return e.abrupt("return",{currentJobIndex:o,totalJobs:c});case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"resourceInfo",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.runScript("load _mlsql_.`resource` as output;",Ue(),{queryType:"robot"});case 2:return t=e.sent,a=t.content[0].totalCores,n=t.content[0].activeTasks,e.abrupt("return",{activeTasks:n,totalCores:a});case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}]),e}(),He=a(103),We=function(){function e(t){var a=this;Object(f.a)(this,e),this.enterLoading=function(){a.commandGroupRef.setState({loading:!0})},this.exitLoading=function(){a.commandGroupRef.setState({loading:!1})},this.queryPanel=t,this.client=new b.ActionProxy,this.jobName=He(),this.editorOp=this.queryPanel.getEditorOp(),this.consoleOp=this.queryPanel.getConsoleOp();var n=this.editorOp.getSelection();this.sql=n||this.editorOp.getText(),this.commandGroupRef=this.queryPanel.commandGroup.current,this.jobProgressRef=this.queryPanel.jobProgressRef,this.taskProgressRef=this.queryPanel.taskProgressRef.current,this.displayRef=this.queryPanel.queryApp.display.current,this.dashRef=this.queryPanel.queryApp.dash.current,this.timeout=this.commandGroupRef.state.timeout,this.logInfo={},this.closed=!1}return Object(j.a)(e,[{key:"log",value:function(e){return this.consoleOp.append(e),this}},{key:"prepare",value:function(){this.enterLoading(),this.consoleOp.setText(""),this.displayRef.update(JSON.parse("[]"))}},{key:"measureTime",value:function(e){return this.exitLoading(),(new Date).getTime()-e}},{key:"saveFile",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.queryPanel.state.scriptId){e.next=4;break}return this.log("No file are opened, cannot execute save action"),e.abrupt("return");case 4:return e.next=6,this.client.post(g.default.SAVE_SCRIPT_FILE,{id:a,content:this.editorOp.getText()});case 6:return 200!==(n=e.sent).status&&this.log(n.content),200===n.status&&this.log("File[".concat(a,"] have been saved.")),e.abrupt("return",n);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.prepare(),a=(new Date).getTime(),e.next=4,this.client.runScript(this.sql,this.jobName,Object.assign(t,{jobName:this.jobName,async:!0,timeout:this.timeout}));case 4:if(200===(n=e.sent).status){e.next=8;break}return this.log("Fail to submit job\nTime cost:"+this.measureTime(a)+"ms"),e.abrupt("return",[]);case 8:return this.intervalTimer=setInterval(Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.monitorJob();case 2:return e.next=4,r.monitorLog();case 4:case"end":return e.stop()}},e)})),1e3),this.dashRef.queryHistory&&this.dashRef.queryHistory.reload(),this.jobProgressRef.enter(),e.abrupt("return",n);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"cancelMonitor",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.intervalTimer&&(clearInterval(this.intervalTimer),this.intervalTimer=null),this.jobProgressRef.exit();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"monitorJob",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.get(g.default.JOB_DETAIL,{jobName:this.jobName});case 2:t=e.sent,3===(a=t.content).status&&(this.closed=!0,this.cancelMonitor(),this.exitLoading(),this.jobProgressRef.exit(),this.log(a.reason)),2===a.status&&(this.closed=!0,this.cancelMonitor(),this.exitLoading(),this.jobProgressRef.exit(),n=JSON.parse(a.response),this.displayRef.update(n),this.queryPanel.queryApp.setData(n));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"monitorLog",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=He(),e.next=3,this.client.runScript("load _mlsql_.`log/".concat(this.logInfo.offset||-1,'` where filePath="engine_log" as output;'),t,{queryType:"robot"});case 3:a=e.sent,(n=a.content[0]).value&&n.value.length>0&&this.log(n.value.map(function(e){return e.split("__MMMMMM__")[1]}).join("\n")),this.logInfo.offset=n.offset;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"killJob",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.jobName){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ke.killJob(this.jobName);case 4:t=e.sent;try{this.log(t.content[0].description)}catch(a){this.log(t.content)}this.closed=!0,this.jobName=null,this.cancelMonitor(),this.exitLoading();case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),ze=a(256),Qe=a.n(ze),Ye=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).enter=function(e){a.setState({loading:!0}),a.intervalTimer=setInterval(Object(u.a)(l.a.mark(function e(){var t,n,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.queryPanel.executor.jobName,e.next=3,Ke.jobProgress(t);case 3:n=e.sent,r=n.currentJobIndex,o=n.totalJobs,a.setState({progress:r/o*100});case 7:case"end":return e.stop()}},e)})),1e3)},a.exit=function(){a.intervalTimer&&(clearInterval(a.intervalTimer),a.intervalTimer=null,a.finalTime=(a.timer.getTime()/1e3).toFixed(2)+"s",a.setState({loading:!1}))},a.queryPanel=e.parent,a.state={loading:!1,progress:0},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return this.state.loading?n.createElement("div",null,n.createElement(Q.a,{type:"primary",style:{marginRight:"20px"}},"Time Cost:",n.createElement(Qe.a,{ref:function(t){return e.timer=t}},n.createElement(Qe.a.Minutes,{formatValue:function(e){return"".concat(e," m. ")}}),n.createElement(Qe.a.Seconds,{formatValue:function(e){return"".concat(e," s. ")}}))),n.createElement(xe.a,{type:"circle",percent:this.state.progress})):this.finalTime?n.createElement(Q.a,{type:"primary",style:{margin:"0px 0px 20px 0px"}},"Time Cost: ",this.finalTime):n.createElement("div",null)}}]),t}(n.Component),Xe=(a(656),function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).enter=function(e){},a.exit=function(){},a.queryPanel=e.parent,a.state={percent:0},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reload();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"reload",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,r,o,c,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.resourceInfo();case 2:return t=e.sent,a=t.activeTasks,n=t.totalCores,e.next=7,Ke.jobs();case 7:r=e.sent,o=r.jobName,c=r.res,i=c.content.filter(function(e){return e.jobName!==o}).length,this.setState({percent:a/n*100,totalCores:n,activeTasks:a,jobNum:i});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return n.createElement("div",{className:"rp-main"},n.createElement("div",{className:"rp-block"},n.createElement("div",{className:"rp-name"},"CPU Usage(total cores:",this.state.totalCores,"): "),n.createElement(xe.a,{percent:this.state.percent,style:{maxWidth:"300px"}})),n.createElement("div",{className:"rp-block"},n.createElement("div",{className:"rp-name"},"Jobs Running: ",n.createElement("span",null,this.state.jobNum))))}}]),t}(n.Component)),$e=Ve.a.Option,Ze=(a(103),function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).text=function(e,t){a.setState({value:e,scriptId:t},function(){a.aceEditorRef.current.editor.setValue(e,1)})},a.executeSave=Object(u.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new We(Object(Ee.a)(Object(Ee.a)(a))),e.next=3,t.saveFile({});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)})),a.getAllText=function(){return a.getAceEditor().getValue()},a.getSelection=function(){return a.getEditorOp().getSelection()},a.appendToEditor=function(e){return a.getEditorOp().insertAfterCursor(e)},a.getEditorOp=function(){return new Ge(a.aceEditorRef.current)},a.getConsoleOp=function(){return new Ge(a.queryApp.messageBox.current)},a.getAceEditor=function(){return a.getEditorOp().editor},a.getMessageBoxAceEditor=function(){return a.getConsoleOp().editor},a.appendLog=function(e){return a.getConsoleOp().append(e)},a.getDashBoard=function(){return a.queryApp.dash.current},a.getDisplay=function(){return a.queryApp.display.current},a.enterLoading=function(e){a.commandGroup.current.setState({loading:!0}),a.resourceProgressRef.current.enter({jobName:e}),a.jobProgressRef.enter({jobName:e}),a.taskProgressRef.current.enter({jobName:e})},a.exitLoading=function(){a.commandGroup.current.setState({loading:!1}),a.jobProgressRef.exit(),a.resourceProgressRef.current.exit(),a.taskProgressRef.current.exit()},a.etOver=function(e){var t=a.queryApp.etRef.current,n=t.getData("eventName"),r=t.getData("popName"),o=t.getData("processType"),c=t.getData("pathAlias"),i=t.getData("tableHidden"),s=t.getData("pathHidden"),l=t.getData("outputTableHidden"),u=t.getData("outputTableAlias"),p=t.getData("tableAlias");"direct"===o?a.appendToEditor((new qe).makeSQL(n)):t.setState({etPop:!0,eventName:n,popName:r,processType:o,pathAlias:c,tableHidden:i,pathHidden:s,outputTableHidden:l,outputTableAlias:u,tableAlias:p})},a.language=a.props.language||"sql",a.queryApp=a.props.parent,a.aceEditorRef=n.createRef(),a.commandGroup=n.createRef(),a.taskProgressRef=n.createRef(),a.cancelQuery=a.cancelQuery.bind(Object(Ee.a)(Object(Ee.a)(a))),a.executeQuery=a.executeQuery.bind(Object(Ee.a)(Object(Ee.a)(a))),a.state={value:"",loading:!1},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.props.parentCallback&&this.props.parentCallback(this);var e={getCompletions:function(){var e=Object(u.a)(l.a.mark(function e(t,a,n,r,o){var c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se.getSuggestList(t.getValue(),n.row,n.column);case 2:c=e.sent,o(null,c.map(function(e){var t="";return"desc"in e.extra&&(t=e.extra.desc),{caption:e.name,value:e.name,meta:t}}));case 4:case"end":return e.stop()}},e)}));return function(t,a,n,r,o){return e.apply(this,arguments)}}()};this.getAceEditor().completers=[e]}},{key:"onChange",value:function(e){}},{key:"executeQuery",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.executor||this.executor.closed){e.next=4;break}return this.log("Job ".concat(this.jobName," is still running.")),this.log("Try to kill this job or wait it to finish"),e.abrupt("return");case 4:return this.executor=new We(this),e.next=7,this.executor.run({});case 7:return t=e.sent,this.executor.closed||(this.executor.closed=!0),e.abrupt("return",t);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancelQuery",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.executor&&this.executor.killJob();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"mlsql-editor-area"},n.createElement("div",{onDragOver:function(e){return e.preventDefault()},onDrop:this.etOver},n.createElement(Be.Resizable,{defaultSize:{height:"500px"},onResize:function(){e.aceEditorRef.current.editor.resize()}},n.createElement(ke.a,{ref:this.aceEditorRef,mode:this.language,theme:"github",width:"100%",height:"100%",onChange:this.onChange,name:"mlsql_editor",fontSize:16,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,editorProps:{$blockScrolling:1/0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2,autoScrollEditorIntoView:!0}}))),n.createElement(et,{ref:this.commandGroup,parent:this}),n.createElement(Ye,{ref:function(t){e.jobProgressRef=t},parent:this}),n.createElement(tt,{ref:this.taskProgressRef,parent:this}))}}]),t}(n.Component)),et=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).onChange=function(e){a.setState({timeout:e})},a.state={loading:!1,timeout:"-1"},a.parent=e.parent,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:"mslql-editor-buttons"},n.createElement(Q.a,{onClick:this.parent.executeQuery,loading:this.state.loading},"Run"),n.createElement(Q.a,{onClick:this.parent.cancelQuery},"Cancel"),n.createElement(Q.a,{onClick:this.parent.executeSave},"Save"),"Job Timeout:",n.createElement(Ve.a,{onChange:this.onChange,style:{width:"120px"}},n.createElement($e,{value:"10000"},"10s"),n.createElement($e,{value:"30000"},"30s"),n.createElement($e,{value:"60000"},"60s"),n.createElement($e,{value:"1800000"},"30m"),n.createElement($e,{value:"7200000"},"2h"),n.createElement($e,{value:"28800000"},"8h"),n.createElement($e,{value:"-1"},"unlimited")))}}]),t}(n.Component),tt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).enter=function(e){var t=Object(Ee.a)(Object(Ee.a)(a));a.setState({mark:!0}),setTimeout(function(){t.state.mark&&(t.setState({loading:!0}),t.intervalTimer=setInterval(function(){if("loading"!==t.taskCompute){t.taskCompute="loading";var a=new _e(De);Me(e.hasOwnProperty("jobName"),"jobName is required");var n=e.jobName;a.runScript({},"load _mlsql_.`jobs/".concat(n,"` as output;"),function(e){t.taskCompute="loaded";var a=e[0],n={numTasks:0,numActiveTasks:0,numCompletedTasks:0};a.activeJobs.forEach(function(e){n.numTasks+=e.numTasks,n.numActiveTasks+=e.numActiveTasks,n.numCompletedTasks+=e.numCompletedTasks}),t.setState({percent:n.numActiveTasks/n.numTasks*100,successPercent:n.numCompletedTasks/n.numTasks*100,title:"Tasks (for all stages): Succeeded/Total:\n".concat(n.numCompletedTasks,"/").concat(n.numTasks,"(").concat(n.numActiveTasks," running)")})},function(e){t.taskCompute="loaded";try{t.parent.appendLog(e)}catch(a){console.log(a)}})}},1e3))},1e3)},a.exit=function(){a.taskCompute="loaded",a.resourceCompute="loaded",a.setState({loading:!1,percent:0,successPercent:0,mark:!1}),a.intervalTimer&&clearInterval(a.intervalTimer)},a.state={loading:!1,percent:0,successPercent:0,mark:!1},a.parent=e.parent,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return this.state.loading?n.createElement("div",null,this.state.title,n.createElement(xe.a,{percent:this.state.percent,successPercent:this.state.successPercent})):n.createElement("div",null)}}]),t}(n.Component),at=Ze,nt=(a(659),a(1018)),rt=a(1024),ot=a(192),ct=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).setRender=function(e,t){var r=t[0][e.key];if(a.config&&a.config.render){var o=a.config.render[e.key];o&&(e.render=o)}else{try{if(n.Component.isPrototypeOf(r.type))return void(e.render=function(e){return n.createElement("span",null,e)})}catch(c){}"html"!=e.key?"object"!==typeof r?"array"!==typeof r?"boolean"!==typeof r?"fileSystem"!=e.key&&"message"!=e.key&&"info"!=e.key||(e.render=function(e){return n.createElement("pre",null,e.toString())}):e.render=function(e){return n.createElement("span",null,e.toString())}:e.render=function(e){return n.createElement("span",null,e.join(",").substring(0,300))}:e.render=function(e){return n.createElement("span",null,JSON.stringify(e).substring(0,300))}:e.render=function(e){return n.createElement("pre",null,e.substring(0,300))}}},a.update=function(e,t){a.config=t;var n=[],r={},o=[],c=Object(Ee.a)(Object(Ee.a)(a));e.forEach(function(t){for(var a in t)if(!r[a]){var o={title:a,dataIndex:a,key:a};c.setRender(o,e),n.push(o),r[a]=!0}}),e.forEach(function(e,t){var a={};n.forEach(function(t){a[t.key]=e[t.key]}),a.key=t,o.push(a)}),a.setState({columns:n,data:o})},a.rowDoubleClick=function(e,t,n){"codeExample"!==e.name&&"doc"!==e.name||a.setState({view:{enabled:!0,content:e.value}})},a.disablePreview=function(){a.setState({view:{enabled:!1}})},a.tableStyle=e.style||{},a.state={columns:[],rows:[],view:{enabled:!1}},a.config={},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("div",{style:this.tableStyle},n.createElement(nt.a,{onRow:function(t,a){return{onDoubleClick:function(n){e.rowDoubleClick(t,a,n)}}},columns:this.state.columns,dataSource:this.state.data}),n.createElement(rt.a,{title:"View",visible:this.state.view.enabled,onCancel:this.disablePreview,onOk:this.disablePreview,cancelText:"Cancel",OkText:"Ok"},n.createElement(ot,{source:this.state.view.content||""})))}}]),t}(n.Component),it=a(1021),st=a(317),lt=a(485),ut=a(483),pt=a(452),dt=a.n(pt),mt={width:200,height:200,borderWidth:2,borderColor:"#666",borderStyle:"dashed",borderRadius:5},ft={borderStyle:"solid",borderColor:"#6c6",backgroundColor:"#eee"},ht={borderStyle:"solid",borderColor:"#c66",backgroundColor:"#eee"},bt={display:"flex"},gt=function(e){function t(){var e;return Object(f.a)(this,t),(e=Object(ge.a)(this,Object(ve.a)(t).call(this))).onDrop=function(t){e.setState({files:t});var a=dt.a.post(Ae);a.set("Access-Token",sessionStorage.getItem(Ne.name)||""),t.forEach(function(e){a.attach(e.path,e)}),a.end(function(a,n){e.setState({files:[]}),a?(console.log(a),e.setState({msg:a.toString()+"\n Sometimes this caused by your upload space is not enough or backend fails"})):n.ok&&e.setState({msg:"total files:"+t.length+" are uploaded. \n You can check the files with command: !hdfs -ls /tmp/upload; "})})},e.state={files:[]},e}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.state.files.map(function(e){return r.a.createElement("li",{key:e.name},e.path," - ",e.size," bytes")});return r.a.createElement("section",{style:bt},r.a.createElement("div",null,r.a.createElement(lt.a,{onDrop:this.onDrop,getDataTransferItems:function(e){return Object(ut.a)(e)}},function(e){var t=e.getRootProps,a=e.getInputProps,n=e.isDragActive,o=e.isDragAccept,c=e.isDragReject,i=(e.acceptedFiles,e.rejectedFiles,Object(k.a)({},mt));return i=n?Object(k.a)({},i,ft):i,i=c?Object(k.a)({},i,ht):i,r.a.createElement("div",Object.assign({},t(),{style:i}),r.a.createElement("input",a()),r.a.createElement("div",null,o?"Drop":"Drag"," files here..."),c&&r.a.createElement("div",null,"Unsupported file type..."))})),r.a.createElement("aside",null,r.a.createElement("h4",null,0==e.length?"":"Files"),r.a.createElement("ul",null,e)),r.a.createElement("div",null,this.state.msg?this.state.msg:""))}}]),t}(r.a.Component),vt=a(248),yt=a(40),Et=a(399),Ot=function(){var e=Et();return"#000000"===e&&(e="#8884d8"),e},kt=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,null,[{key:"render",value:function(e){var t=e[0].hasOwnProperty("z");e.hasOwnProperty("dataType")||e.forEach(function(e){e.dataType="default",t||(e.z=0)});var a=e.reduce(function(e,t){t.x,t.y,t.z;var a=t.dataType,n=e.get(a);return n?n.push(t):e.set(a,[t]),e},new Map),n=e[0]._dash_config||{},o=Object(vt.a)(a.keys()).map(function(e){var t=Object.assign({fill:Ot(),shape:"triangle"},n[e]||{});return r.a.createElement(yt.g,Object.assign({key:e,name:e,data:a.get(e)},t))}),c=Object.assign({type:"number",dataKey:"x"},n.x||{}),i=Object.assign({type:"number",dataKey:"y"},n.y||{}),s=Object.assign({type:"number",dataKey:"z"},n.z||{});return r.a.createElement(yt.h,{width:400,height:400,margin:{top:20,right:20,bottom:20,left:20}},r.a.createElement(yt.c,null),r.a.createElement(yt.j,c),r.a.createElement(yt.k,i),t?r.a.createElement(yt.l,s):"",r.a.createElement(yt.i,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(yt.d,null),o)}}]),e}();kt.basicCheck=function(e,t){if(e.length<1)return!1;try{return t(e[0])}catch(a){return!1}return!0},kt.isShouldRender=function(e){return kt.basicCheck(e,function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&(e.hasOwnProperty("_dash_config")||e.hasOwnProperty("dash"))&&("scatter"===e.dash||"scatter"===(e._dash_config||{}).dash)})};var jt=a(399),wt=function(){var e=jt();return"#000000"===e&&(e="#8884d8"),e},St=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,null,[{key:"render",value:function(e){var t=e[0],a=[],n=t._dash_config||{};return"line"===t.dash||"line"===n.dash?(Object.keys(t).forEach(function(e){if("number"===typeof t[e]){var o=Object.assign({stroke:wt()},n[e]||{});a.push(r.a.createElement(yt.e,Object.assign({key:e,type:"monotone",dataKey:e},o)))}}),r.a.createElement(yt.f,{width:500,height:300,data:e,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(yt.c,{strokeDasharray:"3 3"}),r.a.createElement(yt.j,{dataKey:"x"}),r.a.createElement(yt.k,null),r.a.createElement(yt.i,null),r.a.createElement(yt.d,null),a)):"bar"===t.dash||"bar"===n.dash?(Object.keys(t).forEach(function(e){if("number"===typeof t[e]){var o=Object.assign({fill:wt()},n[e]||{});a.push(r.a.createElement(yt.a,Object.assign({key:e,dataKey:e},o)))}}),r.a.createElement(yt.b,{width:500,height:300,data:e,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(yt.c,{strokeDasharray:"3 3"}),r.a.createElement(yt.j,{dataKey:"x"}),r.a.createElement(yt.k,null),r.a.createElement(yt.i,null),r.a.createElement(yt.d,null),a)):void 0}}]),e}();St.basicCheck=function(e,t){if(e.length<1)return!1;try{return t(e[0])}catch(a){return!1}return!0},St.isShouldRender=function(e){return St.basicCheck(e,function(e){return e.hasOwnProperty("x")&&(e.hasOwnProperty("dash")||e.hasOwnProperty("_dash_config"))})};var xt=a(463),Ct=a.n(xt),Tt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).renderStream=function(){var e=a.state.data,t=[],n=[];e.forEach(function(e){var a=JSON.parse(e.value),r=Ct.a.utc(a.timestamp).format("DD,h:mm:ss");t.push({x:r,inputRowsPerSecond:a.inputRowsPerSecond,processedRowsPerSecond:a.processedRowsPerSecond}),n.push({x:r,numInputRows:a.numInputRows})}),a.setState({dataForRender:t,dataForRender2:n})},a.queryApp=e.parent.parent,a.state={data:e.data,dataForRender:[],titleMap:{}},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.renderStream()}},{key:"render",value:function(){return 0===this.state.dataForRender.length?null:r.a.createElement("div",null,r.a.createElement(yt.f,{width:800,height:300,data:this.state.dataForRender},r.a.createElement(yt.e,{type:"monotone",dataKey:"inputRowsPerSecond",stroke:"#8884d8"}),r.a.createElement(yt.e,{type:"monotone",dataKey:"processedRowsPerSecond",stroke:"#82ca9d"}),r.a.createElement(yt.c,{stroke:"#ccc"}),r.a.createElement(yt.j,{dataKey:"x"}),r.a.createElement(yt.k,null),r.a.createElement(yt.d,null)),r.a.createElement(yt.f,{width:800,height:300,data:this.state.dataForRender2},r.a.createElement(yt.e,{type:"monotone",dataKey:"numInputRows",stroke:"#8884d8"}),r.a.createElement(yt.c,{stroke:"#ccc"}),r.a.createElement(yt.j,{dataKey:"x"}),r.a.createElement(yt.k,null),r.a.createElement(yt.d,null)))}}]),t}(n.Component);Tt.isStream=function(e){if(e.length<1)return!1;try{if(!JSON.parse(e[0].value).runId)return!1}catch(t){return!1}return!0},Tt.isShouldRender=function(e){return Tt.isStream(e)},Tt.renderRawData=function(e){if(!Tt.isShouldRender(e))return"";var t=[];return e.forEach(function(e){var a=JSON.parse(e.value);t.push(JSON.stringify(a,null,2))}),t.join("\n")};var Nt=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,null,[{key:"render",value:function(e){var t=e[0];return r.a.createElement(Rt,{data:t})}}]),e}();Nt.basicCheck=function(e,t){if(e.length<1)return!1;try{return t(e[0])}catch(a){return!1}return!0},Nt.isShouldRender=function(e){return Nt.basicCheck(e,function(e){return e.hasOwnProperty("html")&&(e.hasOwnProperty("dash")||e.hasOwnProperty("_dash_config"))})};var Rt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).refresh=function(e){a.setState({data:e})},a.state={data:a.props.data},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return console.log(this.state.data),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(Be.Resizable,{defaultSize:{height:"500px"}},r.a.createElement("iframe",{sandbox:"allow-scripts",style:{width:"100%",height:"100%"},srcDoc:this.state.data.html,frameBorder:"0",scrolling:"yes",ref:function(t){e.ifr=t}})))}}]),t}(r.a.Component),Dt=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).toggleDetail=function(){a.setState({showDetail:!a.state.showDetail})},a.toggleResponse=function(){a.setState({showResponse:!a.state.showResponse})},a.queryApp=e.parent.queryApp,a.client=new b.ActionProxy,a.state={showDetail:!1,executeAgainStatus:{}};var n=function(e,t){return r.a.createElement(Q.a,{type:"link",onClick:function(){var e=Object(u.a)(l.a.mark(function e(n){var r,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.target.parentNode,o=r.parentNode.cellIndex,c="",e.t0=o,e.next=2===e.t0?6:4===e.t0?8:7===e.t0?10:12;break;case 6:return c="content",e.abrupt("break",12);case 8:return c="reason",e.abrupt("break",12);case 10:return c="response",e.abrupt("break",12);case 12:return console.log(o),e.next=15,a.showDetail(t.name,c);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},r.a.createElement("span",{style:{whiteSpace:"normal",wordWrap:"break-word",width:"100px"}},e))};return a.renderConfig={render:{content:n,response:function(e,t){return r.a.createElement(Q.a,{type:"link",onClick:function(){var e=Object(u.a)(l.a.mark(function e(n){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.showResponse(t.name);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},r.a.createElement("span",{style:{whiteSpace:"normal",wordWrap:"break-word",width:"100px"}},e))},reason:n,status:function(e){var t="",a={};switch(e){case"fail":case"killed":t="danger";break;case"success":t="primary",a={backgroundColor:"green"};break;case"running":t="primary"}return r.a.createElement(Q.a,{type:t,style:a},e)},__command__:function(e,t){var n=t.name;return"running"!==t.status?r.a.createElement(Q.a,{type:"primary",key:n,loading:a.state.executeAgainStatus[n],onClick:function(){var e=Object(u.a)(l.a.mark(function e(r){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.state.executeAgainStatus[n]=!0,a.setState(a.state.executeAgainStatus),e.next=4,Ke.runJob(t.content);case 4:a.reload();case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},"Execute again"):r.a.createElement(Q.a,{key:n,onClick:function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.killJob(n);case 2:e.sent,a.reload();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},"Kill")}}},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"reload",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({executeAgainStatus:{}}),e.next=3,this.client.get(g.default.JOB_LIST,{});case 3:200==(t=e.sent).status&&this.display&&this.display.update(this.processData(t.content),this.renderConfig);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"processData",value:function(e){return e.map(function(e){var t="running"===e.status?e.jobName:"";return Object.assign(e,{__command__:t})})}},{key:"showDetail",value:function(){var e=Object(u.a)(l.a.mark(function e(t,a){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.get(g.default.JOB_DETAIL,{jobName:t});case 2:n=e.sent,this.setState({showDetail:!0,detailConsoleMessage:n.content[a]});case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"showResponse",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.get(g.default.JOB_DETAIL,{jobName:t});case 2:a=e.sent,this.setState({showResponse:!0}),this.respDisplay&&this.respDisplay.update(JSON.parse(a.content.response));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reload();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"mlsql-query-display"},r.a.createElement(rt.a,{title:"View",visible:this.state.showDetail,onCancel:this.toggleDetail,onOk:this.toggleDetail,cancelText:"Cancel",width:"70%",OkText:"Ok"},r.a.createElement(ke.a,{height:"300px",width:"100%",mode:"text",theme:"github",name:"detail_box",value:this.state.detailConsoleMessage||""})),r.a.createElement(rt.a,{title:"View",visible:this.state.showResponse,onCancel:this.toggleResponse,onOk:this.toggleResponse,cancelText:"Cancel",width:"70%",OkText:"Ok"},r.a.createElement(ct,{style:{overflow:"scroll"},ref:function(t){e.respDisplay=t},parent:this})),r.a.createElement("div",{style:{marginBottom:16}},r.a.createElement(Q.a,{type:"primary",onClick:function(){e.reload()}},"Reload")),r.a.createElement(ct,{ref:function(t){e.display=t},parent:this}))}}]),t}(r.a.Component),At=it.a.Panel,It=st.a.TabPane;function Ft(e){}var Pt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).isNormalXY=function(e){return t.basicCheck(e,function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&"number"===typeof e.y})},a.xYRender=function(e){return r.a.createElement(yt.a,{height:200,title:"Bar",data:e})},a.renderDash=function(){var e=a.state.data;return Tt.isShouldRender(e)?r.a.createElement(Tt,{data:e,parent:Object(Ee.a)(Object(Ee.a)(a))}):kt.isShouldRender(e)?kt.render(e):a.isNormalXY(e)?a.xYRender(e):St.isShouldRender(e)?St.render(e):Nt.isShouldRender(e)?Nt.render(e):r.a.createElement("div",null)},a.queryApp=e.parent,a.state={data:[],dataForRender:[],titleMap:{}},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"refresh",value:function(){try{var e=this.queryApp.queryResData||[];this.setState({data:e})}catch(t){}}},{key:"render",value:function(){var e=this;return r.a.createElement(it.a,{onChange:Ft},r.a.createElement(At,{header:"Tools/Dashboard",key:"0"},r.a.createElement(st.a,{defaultActiveKey:"0",onChange:Ft,onTabClick:function(t){"0"===t&&e.resourceProgressRef.reload()}},r.a.createElement(It,{tab:"Cluster Info",key:"0"},r.a.createElement(Xe,{ref:function(t){return e.resourceProgressRef=t},parent:this})),r.a.createElement(It,{tab:"Upload",key:"1"},r.a.createElement(gt,null)),r.a.createElement(It,{tab:"Dashboard",key:"2"},this.renderDash()),r.a.createElement(It,{tab:"RawData",key:"3"},r.a.createElement("pre",null,Tt.renderRawData(this.state.data))),r.a.createElement(It,{tab:"History",key:"4"},r.a.createElement(Dt,{ref:function(t){return e.queryHistory=t},parent:this})))))}}]),t}(n.PureComponent);Pt.basicCheck=function(e,t){if(e.length<1)return!1;try{return t(e[0])}catch(a){return!1}return!0};var Lt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).originalEditor=function(){return a.editor.editor},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.originalEditor().container.style.lineHeight=3}},{key:"render",value:function(){var e=this;return r.a.createElement(ke.a,{maxLines:1/0,width:"100%",ref:function(t){e.editor=t},value:this.props.initialCode,mode:"sql",theme:"github"})}}]),t}(r.a.Component),_t=a(1017),Mt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).evtExecute=function(){a.setState({isExecute:!0}),a.state.executeUnit.execute()},a.cancelExecute=function(){a.setState({isExecute:!1})},a.state={isExecute:!1,executeUnit:e.executeUnit},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.state.isExecute?r.a.createElement("span",{onClick:this.cancelExecute},r.a.createElement(_t.a,{type:"sync",spin:!0})):r.a.createElement("span",{onClick:this.evtExecute},r.a.createElement(_t.a,{type:"caret-right"})))}}]),t}(r.a.Component),qt=a(103),Vt=function e(t){var a=this;Object(f.a)(this,e),this.run=function(e,t,n){var r=qt();new _e(De).newRunScript({jobName:r,timeout:a.timeout},e,t,n)},this.saveFile=function(e,t,a){new _e(Re).request(Ce.POST,{id:t,content:e},function(e){200!=e.status?e.json(function(e){a(e.msg)},function(e){a(e)}):a("saved")},function(e){a(e)})},this.timeout=t},Bt=a(192),Gt=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).setRender=function(e,t,r){var o=t[0][e.key];if(r&&r.render){var c=a.state.config.render[e.key];c&&(e.render=c)}else{try{if(n.Component.isPrototypeOf(o.type))return void(e.render=function(e){return n.createElement("span",null,e)})}catch(i){}"object"!==typeof o?"array"!==typeof o?"boolean"!==typeof o?"fileSystem"!=e.key&&"message"!=e.key&&"info"!=e.key||(e.render=function(e){return n.createElement("pre",null,e.toString())}):e.render=function(e){return n.createElement("span",null,e.toString())}:e.render=function(e){return n.createElement("span",null,e.join(",").substring(0,300))}:e.render=function(e){return n.createElement("span",null,JSON.stringify(e).substring(0,300))}}},a.parseData=function(e,t){var n=[],r={},o=[],c=Object(Ee.a)(Object(Ee.a)(a));return e.forEach(function(t){for(var a in t)if(!r[a]){var o={title:a,dataIndex:a,key:a};c.setRender(o,e),n.push(o),r[a]=!0}}),e.forEach(function(e,t){var a={};n.forEach(function(t){a[t.key]=e[t.key]}),a.key=t,o.push(a)}),[n,o]},a.refresh=function(e,t){var n=a.parseData(e,t),r=Object(p.a)(n,2),o=r[0],c=r[1];a.setState({columns:o,rows:c,config:t})},a.rowDoubleClick=function(e,t,n){"codeExample"!==e.name&&"doc"!==e.name||a.setState({view:{enabled:!0,content:e.value}})},a.disablePreview=function(){a.setState({view:{enabled:!1}})};var r=a.parseData(e.data||[],e.config||{}),o=Object(p.a)(r,2),c=o[0],i=o[1];return a.state={columns:c,rows:i,view:{enabled:!1}},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(nt.a,{onRow:function(t,a){return{onDoubleClick:function(n){e.rowDoubleClick(t,a,n)}}},columns:e.state.columns,dataSource:e.state.rows}),n.createElement(rt.a,{title:"View",visible:e.state.view.enabled,onCancel:e.disablePreview,onOk:e.disablePreview,cancelText:"Cancel",OkText:"Ok"},n.createElement(Bt,{source:e.state.view.content||""})))}}]),t}(n.Component),Ut=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).refresh=function(e){if(a.setState({displayData:e,errorMsg:""}),a.displayTableRef&&a.displayTableRef.refresh(a.state.displayData,{}),a.displayDashRef){var t=a.state.displayData[0];a.displayDashRef.refresh(t)}},a.fail=function(e){a.setState({errorMsg:e}),a.editor&&a.editor.editor.setValue(e)},a.displayDash=function(){if(a.state.displayData&&Nt.isShouldRender(a.state.displayData)){var e=a.state.displayData[0];return r.a.createElement(Rt,{data:e,ref:function(e){return a.displayDashRef=e}})}return r.a.createElement("div",null)},a.displayError=function(){return a.state.errorMsg?r.a.createElement("div",null,r.a.createElement(ke.a,{maxLines:1/0,width:"100%",ref:function(e){a.editor=e},value:a.state.errorMsg,mode:"text",theme:"ace/theme/textmate"})):r.a.createElement("div",null)},a.displayTable=function(){return a.state.displayData?r.a.createElement(Gt,{data:a.state.displayData,ref:function(e){return a.displayTableRef=e}}):r.a.createElement("div",null)},a.state={errorMsg:""},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.displayError(),this.displayTable(),this.displayDash())}}]),t}(r.a.Component),Jt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).execute=function(){var e=a.codeBlock.originalEditor().getValue();new Vt(3e5).run(e,function(e){a.displayGroup.refresh(e),a.commandGroup.setState({isExecute:!1}),a.notebook.nextExecuteUnit()},function(e){a.displayGroup.fail(e),a.commandGroup.setState({isExecute:!1})})},a.codeBlockIsEmpty=function(){return""===a.getCodeStr()},a.getCodeStr=function(){return a.codeBlock.originalEditor().getValue()},a.notebook=e.parent,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(Lt,{initialCode:this.props.initialCode,ref:function(t){e.codeBlock=t},executeUnit:this}),r.a.createElement(Mt,{ref:function(t){e.commandGroup=t},executeUnit:this}),r.a.createElement(Ut,{ref:function(t){return e.displayGroup=t}}))}}]),t}(r.a.Component),Kt="set notebooksplitter='notebooksplitter';",Ht=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).createNewExecuteUnit=function(e){return r.a.createElement(Jt,{parent:Object(Ee.a)(Object(Ee.a)(a)),initialCode:e,ref:function(e){return a.addRef(e)}})},a.addRef=function(e){e&&a.executeUnitRefs.push(e)},a.nextExecuteUnit=function(){a.executeUnitRefs.slice(-1)[0].codeBlockIsEmpty()||(a.executeUnits.push(a.createNewExecuteUnit()),a.setState({executeUnits:a.executeUnits})),a.saveNoteBook()},a.saveNoteBook=function(){var e=a.executeUnitRefs.map(function(e){return e.getCodeStr()}).join(Kt);a.engine.saveFile(e,a.scriptId,function(e){})},a.text=function(e,t){a.scriptId=t,a.initialCode=e,e&&"undefined"!==e&&(a.executeUnitRefs=[],a.executeUnits=a.initialCode.split(Kt).map(function(e){return a.createNewExecuteUnit(e)}),a.setState({executeUnits:a.executeUnits}))},a.executeUnitRefs=[],a.executeUnits=[a.createNewExecuteUnit("")],a.state={executeUnits:a.executeUnits},a.engine=new Vt(3e5),a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.props.parentCallback&&this.props.parentCallback(this)}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.executeUnits)}}]),t}(r.a.Component),Wt=a(103),zt=function(){function e(t){Object(f.a)(this,e),this.appendLog=t,this.log={}}return Object(j.a)(e,[{key:"cancelQueryLog",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.intervalTimer&&(clearInterval(this.intervalTimer),this.intervalTimer=null);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"queryLog",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.cancelQueryLog(),this.intervalTimer=setInterval(Object(u.a)(l.a.mark(function e(){var a,n,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Wt(),n=new b.ActionProxy,e.next=4,n.runScript("load _mlsql_.`log/".concat(t.log.offset||-1,'` where filePath="engine_log" as output;'),a,{});case 4:r=e.sent,(o=r.content[0]).value.length>0&&t.appendLog(o.value.map(function(e){return e.split("__MMMMMM__")[1]}).join("\n")),t.log.offset=o.offset;case 8:case"end":return e.stop()}},e)})),2e3);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),Qt=(Ve.a.Option,a(103)),Yt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).text=function(e,t){a.setState({value:e,scriptId:t},function(){a.aceEditorRef.editor.setValue(e,1)})},a.executeSave=function(){var e=new _e(Re),t=Object(Ee.a)(Object(Ee.a)(a)),n=a.getMessageBoxAceEditor();t.state.scriptId?e.request(Ce.POST,{id:t.state.scriptId,content:t.getAceEditor().getValue()},function(e){200!=e.status?e.json(function(e){t.appendLog(e.msg)},function(e){t.appendLog(e)}):t.appendLog("saved")},function(e){t.appendLog(e)}):n.setValue("no file are opened, cannot executeSave")},a.getAllText=function(){return a.getAceEditor().getValue()},a.getSelection=function(){var e=a.getAceEditor().getSelectionRange();return a.getAceEditor().session.getTextRange(e)},a.appendToEditor=function(e){var t=a.getAceEditor(),n=t.getCursorPosition();t.session.insert(n,e),t.focus()},a.getAceEditor=function(){return a.aceEditorRef.editor},a.getMessageBoxAceEditor=function(){return a.queryApp.messageBox.current.editor},a.appendLog=function(e){var t=a.getMessageBoxAceEditor().session;t.insert({row:t.getLength(),column:0},"\n"+e)},a.getDashBoard=function(){return a.queryApp.dash.current},a.getDisplay=function(){return a.queryApp.display.current},a.language=a.props.language||"sql",a.queryApp=a.props.parent.queryApp,a.state={value:"",loading:!1},a.executeQuery=a.executeQuery.bind(Object(Ee.a)(Object(Ee.a)(a))),a.cancelQuery=a.cancelQuery.bind(Object(Ee.a)(Object(Ee.a)(a))),a.logMonitor=new zt(a.appendLog),a.log={},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.props.parentCallback&&this.props.parentCallback(this)}},{key:"onChange",value:function(e){}},{key:"executeQuery",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,r,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.commandGroup.setState({loading:!0}),this.jobName=Qt(),t=new b.ActionProxy,(a=this).getMessageBoxAceEditor().setValue(""),a.getDisplay().update(JSON.parse("[]")),n=a.getSelection(),r=a.getAllText(),""!==n&&(r=n),o=a.state.scriptId,this.logMonitor.queryLog(),e.next=13,t.runScript(r,this.jobName,{scriptId:o,runMode:"python",executeMode:"python"});case 13:if(200===(c=e.sent).status){e.next=19;break}return this.logMonitor.cancelQueryLog(),this.appendLog(c.content),this.commandGroup.setState({loading:!1}),e.abrupt("return");case 19:try{this.appendLog(c.content.join("\n"))}catch(i){this.appendLog(c.content.msg)}this.logMonitor.cancelQueryLog(),this.commandGroup.setState({loading:!1});case 22:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancelQuery",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.jobName){e.next=2;break}return e.abrupt("return");case 2:return t=Qt(),a=new b.ActionProxy,e.next=6,a.runScript("!kill "+this.jobName+";",t,{});case 6:n=e.sent;try{this.appendLog(n.content[0].description)}catch(r){this.appendLog(n.content)}this.jobName=null,this.logMonitor.cancelQueryLog();case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"mlsql-editor-area"},n.createElement("div",{onDragOver:function(e){return e.preventDefault()},onDrop:this.etOver},n.createElement(Be.Resizable,{defaultSize:{height:"500px"},onResize:function(){e.aceEditorRef.current.editor.resize()}},n.createElement(ke.a,{ref:function(t){return e.aceEditorRef=t},mode:this.language,theme:"github",width:"100%",height:"100%",onChange:this.onChange,name:"mlsql_editor",fontSize:16,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,editorProps:{$blockScrolling:1/0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2,autoScrollEditorIntoView:!0}}))),n.createElement(Xt,{ref:function(t){return e.commandGroup=t},parent:this}))}}]),t}(n.Component),Xt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).onChange=function(e){a.setState({timeout:e})},a.state={loading:!1,timeout:"-1"},a.parent=e.parent,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:"mslql-editor-buttons"},n.createElement(Q.a,{onClick:this.parent.executeQuery,loading:this.state.loading},"Run"),n.createElement(Q.a,{onClick:this.parent.cancelQuery},"Cancel"),n.createElement(Q.a,{onClick:this.parent.executeSave},"Save"))}}]),t}(n.Component),$t=Yt,Zt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).addRef=function(e){e&&(a.editor=e)},a.text=function(e,t){a.editor.text(e,t)},a.queryApp=a.props.parent,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.props.parentCallback&&this.props.parentCallback(this)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement($t,{parent:this,ref:function(t){return e.addRef(t)},language:"python"}))}}]),t}(r.a.Component),ea=st.a.TabPane,ta=function(e){function t(e){var a;Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).pushRef=function(e){a.myRefs.push(e)},a.getCurrentEditor=function(){var e=a.state.activeKey,t=null;return a.myRefs.forEach(function(a){a.activeKey===e&&(t=a)}),t},a.onChange=function(e){var t=null;a.state.panes.forEach(function(a){a.key===e&&(t=a)}),t&&!t.title.endsWith(".mlsql")?a.parent.setState({displayEditor:"normal"}):t&&!t.title.endsWith(".nb")?a.parent.setState({displayEditor:"notebook"}):a.parent.setState({displayEditor:"pythoneditor"}),a.setState({activeKey:e})},a.onEdit=function(e,t){a[t](e)},a.addFull=function(e,t){var r=a.state.panes,o="newTab".concat(a.newTabIndex++);r.push({title:e||"MLSQL "+a.newTabIndex,content:function(r){return e.endsWith(".mlsql")?n.createElement(at,{parent:a.parent,parentCallback:function(e){a.pushRef({ref:e,activeKey:r}),t&&t({ref:e,activeKey:r})},activeKey:r}):e.endsWith(".nb")?n.createElement(Ht,{parent:a.parent,parentCallback:function(e){a.pushRef({ref:e,activeKey:r}),t&&t({ref:e,activeKey:r})},activeKey:r}):e.endsWith(".py")?n.createElement(Zt,{parent:a.parent,parentCallback:function(e){a.pushRef({ref:e,activeKey:r}),t&&t({ref:e,activeKey:r})},activeKey:r}):void 0}(o),key:o}),a.setState({panes:r,activeKey:o})},a.add=function(){a.addFull("MLSQL "+(a.newTabIndex+1),function(e){})},a.getPaneIndexByActiveKey=function(e){var t;return a.state.panes.forEach(function(a,n){a.key===e&&(t=n-1)}),t},a.remove=function(e){var t=a.state.activeKey,n=a.getPaneIndexByActiveKey(e),r=a.state.panes.filter(function(t){return t.key!==e});r.length&&t===e&&(t=n>=0?r[n].key:r[0].key);var o=a.myRefs.filter(function(t){return t.activeKey===e});a.myRefs=a.myRefs.filter(function(t){return t.activeKey!==e}),a.parent.closeEditor(o[0]),a.setState({panes:r,activeKey:t})},a.parent=e.parent,a.myRefs=[],a.newTabIndex=0;var r=[{title:"MLSQL 1",content:n.createElement(at,{parent:a.parent,parentCallback:function(e){a.pushRef({ref:e,activeKey:"newTab0"})},activeKey:"newTab0"}),key:"newTab0"}];return a.state={activeKey:r[0].key,panes:r},a.newTabIndex++,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement(st.a,{onChange:this.onChange,activeKey:this.state.activeKey,type:"editable-card",onEdit:this.onEdit},this.state.panes.map(function(e){return n.createElement(ea,{tab:e.title,key:e.key,closable:e.closable},e.content)}))}}]),t}(n.Component),aa=a(172),na=a(99),ra=a(208),oa=a.n(ra),ca=z.a.Group,ia=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).etPopLoad=e.parent,a.state={},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement("span",null,"parameters:"),n.createElement(ca,{compact:!0},this.state.dataForRender))}}]),t}(n.Component),sa=a(103),la=function e(){Object(f.a)(this,e)};la.getTempTableName=function(){return(sa()+"").replace(/-/g,"")},la.getJobName=function(){return sa()+""},la.unQuote=function(e){return e.startsWith('"')&&e.endsWith('"')?e.slice(1,e.length-1):e.startsWith("'")&&e.endsWith("'")?e.slice(1,e.length-1):e.startsWith("'''")&&e.endsWith("'''")?e.slice(3,e.length-3):e},la.visitDown=function(e,t){t(e),e.children&&e.children.map(function(e){la.visitDown(e,t)})},la.visitUp=function(e,t){e.children&&e.children.map(function(e){la.visitUp(e,t)}),t(e)},la.robotFetchParam=function(){return{queryType:"robot",fetchType:"take",includeSchema:!0}},la.robotFetchParamWithCollect=function(){return{queryType:"robot",includeSchema:!0}},la.getField=function(e){return e.startsWith("`")&&e.endsWith("`")?e:"`".concat(e,"`")},la.distinct=function(e,t){var a={};return e.filter(function(e){return!(e[t]in a)&&(a[e[t]]=e[t],!0)})},la.fastCompareObject=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},la.deepCompareObject=function(e,t){var a,n;return function e(t,r){var o;if(isNaN(t)&&isNaN(r)&&"number"===typeof t&&"number"===typeof r)return!0;if(t===r)return!0;if("function"===typeof t&&"function"===typeof r||t instanceof Date&&r instanceof Date||t instanceof RegExp&&r instanceof RegExp||t instanceof String&&r instanceof String||t instanceof Number&&r instanceof Number)return t.toString()===r.toString();if(!(t instanceof Object&&r instanceof Object))return!1;if(t.isPrototypeOf(r)||r.isPrototypeOf(t))return!1;if(t.constructor!==r.constructor)return!1;if(t.prototype!==r.prototype)return!1;if(a.indexOf(t)>-1||n.indexOf(r)>-1)return!1;for(o in r){if(r.hasOwnProperty(o)!==t.hasOwnProperty(o))return!1;if(typeof r[o]!==typeof t[o])return!1}for(o in t){if(r.hasOwnProperty(o)!==t.hasOwnProperty(o))return!1;if(typeof r[o]!==typeof t[o])return!1;switch(typeof t[o]){case"object":case"function":if(a.push(t),n.push(r),!e(t[o],r[o]))return!1;a.pop(),n.pop();break;default:if(t[o]!==r[o])return!1}}return!0}(e,t)};var ua,pa,da=z.a.Group,ma=Ve.a.Option,fa=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).componentDidMount=Object(u.a)(l.a.mark(function e(){var t,r,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(Ee.a)(Object(Ee.a)(a)),t=new b.ActionProxy,e.next=4,t.runScript("load _mlsql_.`datasources` as output;",la.getJobName(),la.robotFetchParamWithCollect());case 4:r=e.sent,o=la.distinct(r.content.data,"name"),c=[],o.forEach(function(e){c.push(n.createElement(ma,{key:e.name,value:e.name},e.name))}),a.setState({datasourcesRender:c});case 9:case"end":return e.stop()}},e)})),a.params=function(e){a.data.params[e.target.getAttribute("name")]=e.target.value},a.sourceType=function(e,t){a.data.sourceTypeV=e;var r=Object(Ee.a)(Object(Ee.a)(a));new _e(De).runScript({},"load _mlsql_.`datasources/params/".concat(e,"` as output;"),function(e){var t=[];e.forEach(function(e){t.push(n.createElement(aa.a,{key:"row-".concat(e.param)},n.createElement(na.a,null,n.createElement(z.a,{key:"input-".concat(e.param),style:{marginBottom:"10px"},name:e.param,onChange:r.params,type:"text",addonBefore:e.param,placeholder:e.description}))))}),r.loadParamsRef.current.setState({dataForRender:t})},function(e){})},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.makeMLSQL=function(){var e=Object(Ee.a)(Object(Ee.a)(a)),t=[];for(var n in a.data.params){var r=a.data.params[n];if(r){var o='"'+r+'"';"code"!==n&&"fitParam.[group].code"!==n||(o="'''"+r+"'''"),t.push(n.replace(/\[group\]/g,"0")+"="+o)}}var c="";return t.length>0&&(c="where"),"load ".concat(e.data.sourceTypeV,".`").concat(e.data.pathV,"` ").concat(c," ").concat(t.join("and\\n ")," as ").concat(e.data.tableNameV,";")},a.etpop=e.parent,a.data={params:{}},a.state={datasourcesRender:[]},a.loadParamsRef=n.createRef(),a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(da,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,"soureType:",n.createElement(Ve.a,{onChange:this.sourceType,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.datasourcesRender)))),n.createElement("br",null),this.props.ignorePath?n.createElement("div",null):n.createElement(da,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{onChange:this.path,type:"text",label:"Path",addonBefore:"Path",placeholder:"File path or tableName"})))),n.createElement("br",null),this.props.ignoreTableName?n.createElement("div",null):n.createElement(da,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{type:"text",onChange:this.tableName,label:"tableName",addonBefore:"tableName",placeholder:"tableName"})))),n.createElement("br",null),n.createElement(ia,{parent:this,ref:this.loadParamsRef}))}}]),t}(n.Component),ha=z.a.Group,ba=(Ve.a.Option,z.a.TextArea),ga=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).renderParam=function(e){return"keepVersion"===e.param&&"evaluateTable"===e.param?null:"code"===e.param||"fitParam.[group].code"===e.param?n.createElement(aa.a,null,n.createElement(na.a,null,e.param,":",n.createElement(ba,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",rows:10}))):n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",addonBefore:e.param,placeholder:e.description})))},a.params=function(e){a.data.params[e.target.getAttribute("name")]=e.target.value},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.makeMLSQL=function(){Object(Ee.a)(Object(Ee.a)(a));var e=[];for(var t in a.data.params){var n=a.data.params[t];e.push(t.replace(/\[group\]/g,"0")+'="'+n+'"')}return 0==e.length&&e.push('keepVersion="true"'),"train ".concat(a.data.tableNameV," as ").concat(a.name,".`").concat(a.data.pathV,"` where \n").concat(e.join(" and\n "),";")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[]},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this;new _e(De).runScript({},"load modelParams.`".concat(t.name,"` as output;"),function(a){var r=[];a.forEach(function(t){var a=e.renderParam(t);null!==a&&(r.push(a),r.push(n.createElement("br",null)))}),t.setState({dataForRender:r})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement("span",null,"Training data and model path:"),n.createElement(ha,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{type:"text",onChange:this.tableName,size:"large",addonBefore:"tableName",placeholder:"the table of training data"})))),n.createElement("br",null),n.createElement(ha,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{onChange:this.path,type:"text",size:"large",addonBefore:"Model save path",placeholder:"the location you save you model"})))),n.createElement("br",null),n.createElement("span",null,"Algorithm parameters:"),n.createElement(ha,{compact:!0},this.state.dataForRender))}}]),t}(n.Component),va=z.a.Group,ya=Ve.a.Option,Ea=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).sourceType=function(e,t){a.data.sourceTypeV=e},a.saveMode=function(e,t){a.data.saveModeV=e},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.partitionBy=function(e){a.data.partitionByV=e.target.value},a.fileNum=function(e){a.data.fileNumV=e.target.value},a.makeMLSQL=function(){var e=Object(Ee.a)(Object(Ee.a)(a)),t="";a.data.partitionByV&&(t="partitionBy "+a.data.partitionByV);var n='key="value"';return a.data.fileNumV&&(n='fileNum="'.concat(a.data.fileNumV,'"')),"save ".concat(e.data.saveModeV," ").concat(e.data.tableNameV," as ").concat(e.data.sourceTypeV,".`").concat(e.data.pathV,"` \n where ").concat(n," ").concat(t,";")},a.etpop=e.parent,a.data={},a.state={datasourcesRender:[]},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this;new _e(De).runScript({},"load _mlsql_.`datasources` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(ya,{key:e.name,value:e.name},e.name))}),e.setState({datasourcesRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(va,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,"soureType:",n.createElement(Ve.a,{onChange:this.sourceType,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.datasourcesRender)))),n.createElement("br",null),n.createElement(va,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,"SaveMode:",n.createElement(Ve.a,{onChange:this.saveMode,showSearch:!0,style:{width:200},placeholder:"Choose save mode type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(ya,{key:"overwrite",value:"overwrite"},"overwrite"),n.createElement(ya,{key:"append",value:"append"},"append"),n.createElement(ya,{key:"errorIfExists",value:"errorIfExists"},"errorIfExists"),n.createElement(ya,{key:"ignore",value:"ignore"},"ignore"))))),n.createElement("br",null),n.createElement(va,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{type:"text",onChange:this.tableName,label:"tableName",addonBefore:"tableName",placeholder:"the tableName will be saved"})))),n.createElement("br",null),n.createElement(va,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{onChange:this.path,type:"text",addonBefore:"Target Path",placeholder:"File path or tableName"})))),n.createElement("br",null),n.createElement(va,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{type:"text",onChange:this.partitionBy,addonBefore:"partitionBy",placeholder:"partitionBy"})))),n.createElement("br",null),n.createElement(va,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{type:"text",onChange:this.fileNum,addonBefore:"fileNum",placeholder:"fileNum"})))),n.createElement("br",null))}}]),t}(n.Component),Oa=a(142),ka=z.a.Group,ja=(Ve.a.Option,z.a.TextArea),wa=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).renderParam=function(e){return"keepVersion"===e.param||"evaluateTable"===e.param?null:"code"===e.param||"fitParam.[group].code"===e.param?n.createElement(aa.a,null,n.createElement(na.a,null,e.param,":",n.createElement(ja,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",rows:10}))):n.createElement(aa.a,{key:e.param},n.createElement(na.a,null,n.createElement(z.a,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",addonBefore:e.param,placeholder:e.description})))},a.params=function(e){a.data.params[e.target.getAttribute("name")]=e.target.value},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.outputTableName=function(e){a.data.outputTableNameV=e.target.value},a.showTableName=function(){return"true"!==a.state.tableHidden?n.createElement(ka,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{type:"text",onChange:a.tableName,size:"large",addonBefore:a.state.tableAlias?a.state.tableAlias:"Input table",placeholder:""})))):null},a.showOutputTableName=function(){return"true"!==a.state.outputTableHidden?n.createElement(ka,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{type:"text",onChange:a.outputTableName,size:"large",addonBefore:a.state.outputTableAlias?a.state.outputTableAlias:"Output table",placeholder:""})))):null},a.pathNameForRender=function(){return a.state.pathAlias?a.state.pathAlias:"Save path"},a.showPathName=function(){return"true"!==a.state.pathHidden?n.createElement(ka,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{onChange:a.path,type:"text",size:"large",addonBefore:a.pathNameForRender(),placeholder:""})))):""},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[],tableHidden:e.tableHidden,pathAlias:e.pathAlias,pathHidden:e.pathHidden,outputTableHidden:e.outputTableHidden,outputTableAlias:e.outputTableAlias,tableAlias:e.tableAlias},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this;new _e(De).runScript({},"load modelParams.`".concat(t.name,"` as output;"),function(a){var r=[];a.forEach(function(t){var a=e.renderParam(t);null!==a&&(r.push(a),r.push(n.createElement("br",null)))}),t.setState({dataForRender:r})},function(e){})}},{key:"_makeMLSQL",value:function(){var e=[];for(var t in this.data.params){var a=this.data.params[t],n='"'+a+'"';"code"!==t&&"fitParam.[group].code"!==t||(n="'''"+a+"'''"),e.push(t.replace(/\[group\]/g,"0")+"="+n)}var r="";e.length>0&&(r="where");var o="";return this.data.outputTableNameV&&(o="as ".concat(this.data.outputTableNameV)),"run ".concat(this.data.tableNameV||"command"," as ").concat(this.name,".`").concat(this.data.pathV||"","` ").concat(r," ").concat(e.join("and\n ")," ").concat(o,";")}},{key:"_render",value:function(){return n.createElement("div",null,this.showTableName(),n.createElement("br",null),this.showOutputTableName(),n.createElement("br",null),this.showPathName(),n.createElement("br",null),0==this.state.dataForRender.length?"":n.createElement("span",null,"Parameters:"),n.createElement(ka,{compact:!0},this.state.dataForRender))}}]),t}(n.Component),Sa=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).makeMLSQL=function(){return Object(Oa.a)(Object(ve.a)(t.prototype),"_makeMLSQL",Object(Ee.a)(a)).call(Object(Ee.a)(a))},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return Object(Oa.a)(Object(ve.a)(t.prototype),"_render",this).call(this)}}]),t}(wa),xa=z.a.Group,Ca=(Ve.a.Option,function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).makeMLSQL=function(){Object(Ee.a)(Object(Ee.a)(a));var e=[];for(var t in a.data.params){var n=a.data.params[t];e.push(t.replace(/\[group\]/g,"0")+'="'+n+'"')}return 0==e.length&&e.push('keepVersion="true"'),"run command as ".concat(a.name,".`` where \n").concat(e.join(" and\n "),";")},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(xa,{compact:!0},this.state.dataForRender))}}]),t}(Sa)),Ta=(a(929),a(930),a(931),a(465)),Na=a.n(Ta),Ra=Ve.a.Option,Da=z.a.TextArea,Aa=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).udfName=function(e){a.data.udfNameV=e.target.value},a.dataType=function(e){a.data.dataTypeV=e.target.value},a.udfType=function(e){a.udfTypeV=e},a.code=function(e){a.codeV=e},a.langSelect=function(e){a.lang=e,a.codeCheckRef.current.checked=!1,a.setState({dataType:!1}),"python"===a.lang&&a.setState({dataType:!0}),a.setState({codeLang:e})},a.setCodeExample=function(e){e?a.codeRef.current.editor.setValue(a.codeExample()):a.codeRef.current.editor.setValue("")},a.codeExample=function(){var e=a.state.codeLang||"scala";return"scala"===e?"def apply(a:Double,b:Double)={\n   a + b\n}":"python"===e?"def apply(self,m):\n    return m":"java"===e?"import java.util.HashMap;\nimport java.util.Map;\npublic class UDF {\n  public Map<String, Integer[]> apply(String s) {\n    Map<String, Integer[]> m = new HashMap<>();\n    Integer[] arr = {1};\n    m.put(s, arr);\n    return m;\n  }\n}":null},a.showDataType=function(){return a.state.dataType?n.createElement(aa.a,null,n.createElement(na.a,null,"dataType:",n.createElement(Da,{style:{marginBottom:"10px"},name:"dataType",rows:10,onChange:a.dataType,type:"text",addonBefore:"dataType",placeholder:"This is not required when lang is scala\nAs we know python is not strongly typed language, so\nwe should manually spcify the return type.\nmap(string,string) means a map with key is string type,value also is string type.\narray(string) means a array with string type element.\nnested is support e.g. array(array(map(string,array(string))))\n\n"}))):null},a.showCode=function(){return n.createElement("div",null,n.createElement(aa.a,null,n.createElement(na.a,null,"code:",n.createElement(ke.a,{ref:a.codeRef,mode:a.state.codeLang||"scala",theme:"github",width:"400px",height:"300px",name:"code",fontSize:16,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,onChange:a.code,editorProps:{$blockScrolling:1/0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2}}))),n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(na.a,{span:8},"Show CodeExample:",n.createElement(Na.a,{ref:a.codeCheckRef,onChange:a.setCodeExample})))))},a.makeMLSQL=function(){Object(Ee.a)(Object(Ee.a)(a));var e=[];return e.push('lang="'.concat(a.lang,'"')),e.push("code='''".concat(a.codeV,"'''")),e.push('udfType="'.concat(a.udfTypeV,'"')),a.dataTypeV&&e.push("dataType='''".concat(a.dataTypeV,"'''")),"register ScriptUDF.`` as ".concat(a.data.udfNameV," where \n").concat(e.join("\nand "),";")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[]},a.codeRef=n.createRef(),a.codeCheckRef=n.createRef(),a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{onChange:this.udfName,type:"text",size:"large",addonBefore:"UDF Name",placeholder:"the name of udf"}))),n.createElement("br",null),n.createElement(aa.a,null,n.createElement(na.a,{span:4},n.createElement("span",null,"udfType:")),n.createElement(na.a,{span:20},n.createElement(Ve.a,{showSearch:!0,onChange:this.udfType,style:{width:200},placeholder:"Select udf type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(Ra,{value:"udf"},"udf"),n.createElement(Ra,{value:"udaf"},"udaf")))),n.createElement("br",null),n.createElement(aa.a,null,n.createElement(na.a,{span:4},n.createElement("span",null,"Lang:")),n.createElement(na.a,{span:20},n.createElement(Ve.a,{showSearch:!0,style:{width:200},placeholder:"Select language type",optionFilterProp:"children",onChange:this.langSelect,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(Ra,{value:"java"},"java"),n.createElement(Ra,{value:"scala"},"scala"),n.createElement(Ra,{value:"python"},"python")))),n.createElement("br",null),this.showDataType(),n.createElement("br",null),this.showCode(),n.createElement("br",null),n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{style:{marginBottom:"10px"},name:"methodName",onChange:this.params,type:"text",addonBefore:"methodName",placeholder:"methodName"}))))}}]),t}(n.Component),Ia=(z.a.Group,Ve.a.Option),Fa=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).etName=function(e){a.etName=e},a.makeMLSQL=function(){return"load modelExample.`".concat(a.etName,"` as output;")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[],tableHidden:e.tableHidden,pathAlias:e.pathAlias,pathHidden:e.pathHidden},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this;new _e(De).runScript({},"load model.`list` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(Ia,{key:e.name,value:e.name},e.name))}),e.setState({dataForRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(aa.a,null,n.createElement(na.a,null,"ET:",n.createElement(Ve.a,{onChange:this.etName,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.dataForRender))))}}]),t}(n.Component),Pa=(z.a.Group,Ve.a.Option),La=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).makeMLSQL=function(){var e=Object(Ee.a)(Object(Ee.a)(a));return"register ".concat(e.data.sourceTypeV,".`").concat(e.data.pathV,"` as ").concat(e.data.outputTableNameV,";")},a.etName=function(e){a.data.sourceTypeV=e},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this;new _e(De).runScript({},"load model.`list` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(Pa,{key:e.name,value:e.name},e.name))}),e.setState({dataForRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,this.showTableName(),n.createElement("br",null),this.showOutputTableName(),n.createElement("br",null),this.showPathName(),n.createElement("br",null),n.createElement(aa.a,null,n.createElement(na.a,null,"ET:",n.createElement(Ve.a,{onChange:this.etName,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.dataForRender))))}}]),t}(Sa),_a=z.a.Group,Ma=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).makeMLSQL=function(){var e="";a.data.outputTableNameV&&(e="as ".concat(a.data.outputTableNameV));var n=Object(Oa.a)(Object(ve.a)(t.prototype),"_makeMLSQL",Object(Ee.a)(a)).call(Object(Ee.a)(a)).replace(e,""),r="predict ".concat(a.data.tableNameV," as ").concat(a.name,".`").concat(a.data.pathV||"","` ").concat(e,";");return"".concat(n,"\n        ").concat(r,"\n        register ").concat(a.name,".`").concat(a.data.pathV||"","` as ").concat(a.data.functionNameV,"; \n        ").stripMargin()},a.functionName=function(e){a.data.functionNameV=e.target.value},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",null,this.showTableName(),n.createElement("br",null),this.showOutputTableName(),n.createElement("br",null),this.showPathName(),n.createElement("br",null),n.createElement(_a,{compact:!0},n.createElement(aa.a,null,n.createElement(na.a,null,n.createElement(z.a,{onChange:this.functionName,type:"text",size:"large",addonBefore:"functionName",placeholder:"A function you can use to convert String to number or number to String"})))),n.createElement("br",null),0==this.state.dataForRender.length?"":n.createElement("span",null,"Parameters:"),n.createElement(_a,{compact:!0},this.state.dataForRender))}}]),t}(wa),qa=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).makeMLSQL=function(){var e="/api_v1/public/file/download?fileName=".concat(encodeURIComponent(a.data.pathV)),t=document.createElement("a");return t.href=e,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t),""},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(Oa.a)(Object(ve.a)(t.prototype),"_render",this).call(this)}}]),t}(wa),Va=(z.a.Group,Ve.a.Option),Ba=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).etName=function(e){a.etName=e},a.makeMLSQL=function(){return"load _mlsql_.`progress/".concat(a.etName,"` as output;")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[],tableHidden:e.tableHidden,pathAlias:e.pathAlias,pathHidden:e.pathHidden},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this;new _e(De).runScript({},"load _mlsql_.`jobs` as output;",function(t){var a=t.filter(function(e){return"stream"===e.jobType}).map(function(e){return n.createElement(Va,{key:e.jobName,value:e.jobName},e.jobName)});e.setState({dataForRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(aa.a,null,n.createElement(na.a,null,"Stream Jobs:",n.createElement(Ve.a,{onChange:this.etName,showSearch:!0,style:{width:200},placeholder:"Choose Stream Name",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.dataForRender))))}}]),t}(n.Component),Ga=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).disableEtModalVisible=function(){a.et.setState({etPop:!1,etModalVisible:!1})},a.enableEtModalVisible=function(){var e=a.popChild.current.makeMLSQL();a.et.makeMLSQL(e),a.et.setState({etPop:!1,etModalVisible:!1})},a.renderContent=function(){return"load"===a.et.state.eventName?n.createElement(fa,{parent:Object(Ee.a)(Object(Ee.a)(a)),ref:a.popChild}):"save"===a.et.state.eventName?n.createElement(Ea,{name:a.et.state.eventName,ref:a.popChild}):"DownloadExt"===a.et.state.eventName?n.createElement(Ca,{name:a.et.state.eventName,ref:a.popChild}):"StringIndex"===a.et.state.eventName?n.createElement(Ma,{name:a.et.state.eventName,ref:a.popChild}):"DownloadFile"===a.et.state.eventName?n.createElement(qa,Object.assign({name:a.et.state.eventName,ref:a.popChild},a.et.state)):"ETExample"===a.et.state.eventName?n.createElement(Fa,{name:a.et.state.eventName,ref:a.popChild}):"ETStreamProgress"===a.et.state.eventName?n.createElement(Ba,{name:a.et.state.eventName,ref:a.popChild}):"ScriptUDF"===a.et.state.eventName?n.createElement(Aa,{name:a.et.state.eventName,ref:a.popChild}):"register"===a.et.state.eventName?n.createElement(La,Object.assign({name:a.et.state.eventName,ref:a.popChild},a.et.state)):"tool"===a.et.state.processType?n.createElement(Sa,Object.assign({name:a.et.state.eventName,ref:a.popChild},a.et.state)):n.createElement(ga,{name:a.et.state.eventName,ref:a.popChild})},a.et=e.parent,a.popChild=n.createRef(),a.state={etModalVisible:!0,title:e.title},a.data={},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(oa.a,{title:this.state.title,visible:this.state.etModalVisible,onCancel:this.disableEtModalVisible,onOk:this.enableEtModalVisible,okText:"Ok",cancelText:"Cancel"},this.renderContent()))}}]),t}(n.Component),Ua=a(50),Ja=a.n(Ua),Ka=it.a.Panel,Ha=(st.a.TabPane,function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).setData=function(e,t){a.itemData[e]=t},a.getData=function(e){return a.itemData[e]},a.onDragStart=function(e){var t=e.target.getAttribute("processtype");a.setData("eventName",e.target.getAttribute("name")),a.setData("popName",e.target.getAttribute("help")),a.setData("processType",t),a.setData("pathAlias",e.target.getAttribute("pathalias")||""),a.setData("outputTableAlias",e.target.getAttribute("outputtablealias")||""),a.setData("tableAlias",e.target.getAttribute("tablealias")||""),a.setData("tableHidden",e.target.getAttribute("tablehidden")||!1),a.setData("pathHidden",e.target.getAttribute("pathhidden")||!1),a.setData("outputTableHidden",e.target.getAttribute("outputtablehidden")||!1)},a.makeMLSQL=function(e){a.queryApp.getCurrentEditor().ref.appendToEditor(e)},a.renderPop=function(){return a.state.etPop?n.createElement(Ga,{parent:Object(Ee.a)(Object(Ee.a)(a)),title:a.state.popName}):null},a.etDoubleClick=function(e){a.onDragStart(e),a.queryApp.getCurrentEditor().ref.etOver(e)},a.queryApp=e.parent,a.state={},a.itemData={},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(it.a,{style:{margin:"0px 0px",padding:"0px 0px"}},n.createElement(Ka,{header:"Quick Menu",key:"1"},n.createElement(aa.a,{gutter:16},n.createElement(na.a,{span:8},n.createElement(H.a,{title:"Load/Save Data"},n.createElement(Ja.a,{tyle:{marginBottom:"10px"},title:"Load/Save Data",onDragStart:this.onDragStart,name:"load",help:"Load file/db as table",draggable:!0,color:"magenta",onDoubleClick:this.etDoubleClick},"Load data"),n.createElement(Ja.a,{tyle:{marginBottom:"10px"},title:"Save Data",onDragStart:this.onDragStart,name:"save",help:"Save table into file/db ",draggable:!0,color:"magenta",onDoubleClick:this.etDoubleClick},"Save data"))),n.createElement(na.a,{span:8},n.createElement(H.a,{title:"Algorithms"},n.createElement(Ja.a,{tyle:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"TfIdfInPlace",help:"Use TfIdfInPlace vectorize text",draggable:!0,color:"magenta",onDoubleClick:this.etDoubleClick},"TfIdf"),n.createElement(Ja.a,{tyle:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"Word2VecInPlace",help:"Use Word2VecInPlace vectorize text",draggable:!0,color:"magenta",onDoubleClick:this.etDoubleClick},"Word2vec"),n.createElement(Ja.a,{tyle:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"RandomForest",help:"Use RandomForest to train a model",draggable:!0,color:"magenta"},"RandomForest"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"PythonAlg",help:"Run python lib to train",draggable:!0,color:"magenta"},"Python Algorithm"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"BigDLClassifyExt",help:"Use BigDL to develop deep learning algorithm",draggable:!0,color:"magenta"},"Deep Learning"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"NaiveBayes",help:"Use NaiveBayes",draggable:!0,color:"magenta"},"NaiveBayes"))),n.createElement(na.a,{span:8},n.createElement(H.a,{title:"Python"},n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"PythonEnvExt",processtype:"tool",help:"Create Python Env",pathalias:"Temp directory",tablehidden:"true",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Create Python Env"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"PythonParallelExt",processtype:"tool",help:"Run python project",pathalias:"Temp directory",tablehidden:"true",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Run python project")))),n.createElement("br",null),n.createElement(aa.a,{gutter:16},n.createElement(na.a,{span:8},n.createElement(H.a,{title:"Register model as Function"},n.createElement(Ja.a,{onDragStart:this.onDragStart,name:"ScriptUDF",processtype:"tool",onDoubleClick:this.etDoubleClick,help:"Use ScriptUDF create udf",draggable:!0,color:"magenta"},"Create UDF"),n.createElement(Ja.a,{onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"register",help:"Register model to function ",pathalias:"Model saved path",outputtablealias:"Function name",tablealias:"Function name",tablehidden:"true",pathhidden:"false",outputtablehidden:"false",draggable:!0,color:"magenta"},"Register Model As Function"))),n.createElement(na.a,{span:8},n.createElement(H.a,{title:"Jobs"},n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"JobList",onDoubleClick:this.etDoubleClick,processtype:"direct",draggable:!0,color:"magenta"},"Show jobs"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"Kill",onDoubleClick:this.etDoubleClick,processtype:"tool",pathalias:"groupId or jobName",tablehidden:"true",help:"Kill your job",draggable:!0,color:"magenta"},"Kill job"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ETStreamProgress",processtype:"",help:"Show Progress of Stream",draggable:!0,color:"magenta"},"Show Stream Job Progress"))),n.createElement(na.a,{span:8},n.createElement(H.a,{title:"Tools"},n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"DownloadExt",processtype:"tool",help:"Use DownloadExt to download files you have uploaded",draggable:!0,color:"magenta"},"Download uploaded file"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ImageLoaderExt",processtype:"tool",help:"Use ImageLoaderExt to load images",pathalias:"",tablehidden:"true",pathhidden:"true",outputtablehidden:"false",draggable:!0,color:"magenta"},"Load images"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ConnectMySQL",processtype:"direct",help:"",draggable:!0,color:"magenta"},"Connect MySQL"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"JDBC",processtype:"tool",pathalias:"DB name in connect",tablehidden:"false",help:"Run DLL on MySQL",draggable:!0,color:"magenta"},"MySQL DDL"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"TreeBuildExt",processtype:"tool",pathalias:"",tablehidden:"false",pathhidden:"true",help:"Build tree from parent-child",draggable:!0,color:"magenta"},"Parent-Child"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ETExample",processtype:"",help:"Show Example of ET",draggable:!0,color:"magenta"},"Show ET Example"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"RepartitionExt",processtype:"tool",help:"Change Table Partition Num",pathalias:"",tablehidden:"false",pathhidden:"true",outputtablehidden:"false",draggable:!0,color:"magenta"},"Repartition table"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"SendMessage",processtype:"tool",help:"Send email",pathalias:"",tablehidden:"false",pathhidden:"true",outputtablehidden:"true",draggable:!0,color:"magenta"},"Send Mail"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"CacheExt",processtype:"tool",help:"Cache table",pathalias:"",tablehidden:"false",pathhidden:"true",outputtablehidden:"true",draggable:!0,color:"magenta"},"Cache Table"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"StringIndex",processtype:"tool",help:"Convert String to number",pathalias:"Mapping path",tablehidden:"false",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Convert String to number"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"DownloadFile",processtype:"tool",help:"Download File",pathalias:"Target file",tablehidden:"true",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Download File to computer"),n.createElement(Ja.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,onDoubleClick:this.etDoubleClick,name:"ShowResource",processtype:"direct",draggable:!0,color:"magenta"},"Cluster Resource")))))),this.renderPop())}}]),t}(n.Component)),Wa=a(1028),za=a(233),Qa=a(430),Ya=Wa.a.TreeNode,Xa=Wa.a.DirectoryTree,$a=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).state={dbs:{},loading:!1},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"reload",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,Ke.tablesInDeltaLake();case 3:200===(t=e.sent).status&&(a={},t.content.forEach(function(e){a[e.database]?a[e.database].push(e.table):a[e.database]=[e.table]}),this.setState({dbs:a})),this.setState({loading:!1});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"show",value:function(){return Object.entries(this.state.dbs).map(function(e){var t=Object(p.a)(e,2),a=t[0],r=t[1];return n.createElement(Ya,{title:a,key:a},r.map(function(e){return n.createElement(Ya,{icon:n.createElement(Qa.a,null),title:e,key:e,isLeaf:!0})}))})}},{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reload();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return n.createElement(za.a,{tip:"Loading...",spinning:this.state.loading},n.createElement(Xa,null,this.show()))}}]),t}(n.Component),Za=Wa.a.TreeNode,en=Wa.a.DirectoryTree,tn=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).getFileList=function(){var e=Object(u.a)(l.a.mark(function e(t){var n,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.ls(t);case 2:if(200!==(n=e.sent).status||n.content[0]._corrupt_record){e.next=6;break}return r=n.content.map(function(e){return e.is_dir=a.isDir(e),e.key=e.path,e.title=e.path.split("/").slice(-1)[0],e.isLeaf=!e.is_dir,e}),e.abrupt("return",r);case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.isDir=function(e){return e.permission.startsWith("d")},a.onLoadData=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getFileList(t.props.dataRef.path);case 2:t.props.dataRef.children=e.sent,a.setState({root:Object(vt.a)(a.state.root)});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.renderTreeNodes=function(e){return e.map(function(e){return e.children?n.createElement(Za,{title:e.title,key:e.key,isLeaf:e.isLeaf,dataRef:e},a.renderTreeNodes(e.children)):n.createElement(Za,{title:e.title,key:e.key,isLeaf:e.isLeaf,dataRef:e})})},a.state={root:[],loading:!1},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"reload",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.getFileList("/");case 3:t=e.sent,this.setState({loading:!1,root:t});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reload();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return n.createElement("div",null,n.createElement(za.a,{tip:"Loading...",spinning:this.state.loading},n.createElement(en,{loadData:this.onLoadData},this.renderTreeNodes(this.state.root))))}}]),t}(n.Component),an=(a(412),a(421)),nn=a(419),rn=a(417),on=a(418),cn=a(76),sn={setState:cn.SetStateActionHandler},ln={setState:cn.SetStateAction},un=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r,o,c,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new b.ActionProxy,n=t.data,r=n.node,o=n.consoleApp,r.isDir){e.next=10;break}return e.next=5,a.get(g.default.SCRIPT_FILE_GET,{id:r.id});case 5:if(200===(c=e.sent).status){e.next=8;break}return e.abrupt("return",{data:{error:"Fail to get file ".concat(r.label,". Reason: ").concat(c.content)}});case 8:i=c.content,o.openExistsOrNewEditor({id:r.id,content:i.content,name:i.name});case 10:return e.abrupt("return",{data:{}});case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),pn=un.handler,dn=un.action,mn=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r,o,c,i,s,u,p,d,m;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new b.ActionProxy,n=t.data,r=n.createType,n.consoleApp,o=n.form,c=n.scriptContent,i=void 0===c?"":c,s=o.getFieldValue(),u=s.fileName){e.next=5;break}return e.abrupt("return",{data:{createFileError:"Please input the file name"}});case 5:p=t.__state.node,d=!1,e.t0=r,e.next="file"===e.t0?10:"folder"===e.t0?14:16;break;case 10:if(d=!1,u.endsWith(".mlsql")||u.endsWith(".nb")||u.endsWith(".py")){e.next=13;break}return e.abrupt("return",{data:{createFileError:"fileName should end with .mlsql or .nb or .py"}});case 13:return e.abrupt("break",16);case 14:return d=!0,e.abrupt("break",16);case 16:return m={fileName:u,isDir:d,content:i,parentId:p.id},e.next=19,a.post(g.default.SAVE_SCRIPT_FILE,m);case 19:return e.sent,e.abrupt("return",{data:Object(k.a)({},t.data,{reloading:la.getJobName()})});case 21:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),fn=mn.handler,hn=mn.action,bn=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.expandedKeys,n=t.__state.expandedKeys,r=a.filter(function(e){return!n.includes(e)}),o=n.filter(function(e){return!a.includes(e)}),c=new b.ActionProxy,r.forEach(function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.post(g.default.SAVE_SCRIPT_FILE,{id:t,isExpanded:!0});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),o.forEach(function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.post(g.default.SAVE_SCRIPT_FILE,{id:t,isExpanded:!1});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",{data:{expandedKeys:a}});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),gn=bn.handler,vn=bn.action,yn=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.node,e.next=3,b.ActionProxy.client.post(g.default.SCRIPT_FILE_REMOVE,{id:a.id});case 3:return e.abrupt("return",{data:Object(k.a)({},t.data,{reloading:la.getTempTableName()})});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),En=yn.handler,On=yn.action,kn=function e(){Object(f.a)(this,e)};kn.openScriptFile="openScriptFile",kn.createScriptFile="createScriptFile",kn.deleteScriptFile="deleteScriptFile",kn.expand="expand";var jn=Object(k.a)({},sn,(ua={},Object(m.a)(ua,kn.openScriptFile,pn),Object(m.a)(ua,kn.createScriptFile,fn),Object(m.a)(ua,kn.expand,gn),Object(m.a)(ua,kn.deleteScriptFile,En),ua)),wn=Object(k.a)({},ln,(pa={},Object(m.a)(pa,kn.openScriptFile,dn),Object(m.a)(pa,kn.createScriptFile,hn),Object(m.a)(pa,kn.expand,vn),Object(m.a)(pa,kn.deleteScriptFile,On),pa));function Sn(e,t){return wn[t.type](e,t.data)}var xn=a(422),Cn=a(420),Tn=(a(1012),function e(){var t=this;Object(f.a)(this,e),this.build=function(e){var t,a,n={},r=[];for(a=0;a<e.length;a+=1)n[e[a].id]=a,e[a].childNodes=[];for(a=0;a<e.length;a+=1)if(0!==(t=e[a]).parentId)try{e[n[t.parentId]].childNodes.push(t)}catch(o){console.log("------------"),console.log(t),console.log(n[t.parentId])}else r.push(t);return r},this.convert=function(e){return e.childNodes&&e.childNodes.length>0&&(e.children=e.childNodes,e.children.map(function(e){return t.convert(e)})),e.id=String(e.id),e.key=e.id,e.title=r.a.createElement("span",null,e.label),e.isLeaf=!e.isDir,e.isDir?e.icon=r.a.createElement(xn.a,null):e.icon=r.a.createElement(Cn.a,null),e}});function Nn(){var e=Object(oe.a)(["\n  width: 100%; \n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 30px 30px;\n"]);return Nn=function(){return e},e}var Rn=ce.a.div(Nn());var Dn=function(){return r.a.createElement(Rn,null,r.a.createElement(za.a,{tip:"Loading...."}))},An=function(e,t,a){return Object(n.useCallback)(function(n){var r=n.event,o=n.node,c=r.clientX,i=r.clientY-60;if(a){var s=void 0;!function e(t,a){a(t),[].slice.call(t.children).map(function(t){e(t,a)})}(r.target,function(e){e.className!==a||s||(s=e)}),s||(s=r.target);var l=s.getBoundingClientRect();c=l.left+l.width-20,i=l.top-l.height}var u=function(a){e.current&&(!e.current.contains(a.target)&&t({type:"setState",data:{rightClickNodeTreeItem:void 0}}))};document.addEventListener("click",u);var p=function(){t({type:"setState",data:{rightClickNodeTreeItem:void 0}})};document.addEventListener("scroll",p);var d={rightClickNodeTreeItem:{pageX:c,pageY:i,id:o.id}};return t({type:"setState",data:d}),function(){document.removeEventListener("click",u),document.removeEventListener("scroll",p)}},[])},In=Wa.a.DirectoryTree,Fn={nodes:[],rightClickNodeTreeItem:void 0,error:void 0,createFileError:void 0,createType:void 0,createTitle:void 0,operateModal:!1,reloading:void 0,loading:!0,expandedKeys:[]},Pn=r.a.createContext();function Ln(e){var t=e.consoleApp,a=Object(d.useReducerAsync)(Sn,Fn,jn),o=Object(p.a)(a,2),c=o[0],i=o[1],s=c.loading,m=c.nodes,f=c.rightClickNodeTreeItem,h=c.error,v=c.createFileError,y=c.createType,E=c.operateModal,O=c.createTitle,j=c.reloading,w=c.expandedKeys,S=new b.ActionProxy,x=Object(n.useRef)(),C=W.a.useForm(),T=Object(p.a)(C,1)[0];Object(n.useEffect)(function(){(function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.get(g.default.SCRIPT_FILE_LIST,{});case 2:if(200===(t=e.sent).status){e.next=5;break}return e.abrupt("return");case 5:a=new Tn,n=a.build(t.content).sort(function(e,t){return e.id-t.id}),r=n.map(function(e){return a.convert(e)}),la.visitDown(r[0],function(e){e.isExpanded&&w.push(e.id)}),i({type:"setState",data:{nodes:r,loading:!1,expandedKeys:w}});case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},[j]);var N=An(x,i),R=Object(n.useCallback)(function(){if(f){var e=Object(k.a)({},f),t=e.pageX,a=e.pageY,n=e.id,o={zIndex:1e4,position:"absolute",left:"".concat(t,"px"),top:"".concat(a,"px"),borderRadius:"3px",boxShadow:"0 0 0 1px rgba(16, 22, 26, 0.1), 0 2px 4px rgba(16, 22, 26, 0.2), 0 8px 24px rgba(16, 22, 26, 0.2)"},c=function(e){return r.a.createElement("div",{ref:x,style:o},e)},s=void 0;return la.visitDown(m[0],function(e){e.id===n&&(s=e)}),n===m[0].id?c(r.a.createElement(I.a,null,r.a.createElement(I.a.Item,{icon:r.a.createElement(an.a,null),onClick:function(){i({type:"setState",data:{node:s,createType:"folder",createTitle:"Create Project",operateModal:!0}})}},"Create Project"))):s.isDir?c(r.a.createElement(I.a,null,r.a.createElement(I.a.Item,{icon:r.a.createElement(nn.a,null),onClick:function(){i({type:"setState",data:{node:s,createType:"file",createTitle:"Create File",operateModal:!0}})},key:1},"Create Script"),r.a.createElement(I.a.Item,{icon:r.a.createElement(an.a,null),onClick:function(){i({type:"setState",data:{node:s,createType:"folder",createTitle:"Create Folder"}})},key:2},"Create Folder"),r.a.createElement(I.a.Item,{icon:r.a.createElement(rn.a,null),onClick:function(){i({type:kn.deleteScriptFile,data:{node:s}})},key:3},"Delete"))):c(r.a.createElement(I.a,null,r.a.createElement(I.a.Item,{onClick:function(){i({type:kn.deleteScriptFile,data:{node:s,rightClickNodeTreeItem:void 0}})},key:1},"Delete")))}},[f]);return r.a.createElement(Pn.Provider,{value:{dispacher:i}},R(),r.a.createElement(rt.a,{title:O,visible:E,onCancel:function(){i({type:"setState",data:{operateModal:!1}})},onOk:function(){i({type:kn.createScriptFile,data:{operateModal:!1,consoleApp:t,createType:y,form:T}})},cancelText:"Cancel",OkText:"Ok"},v&&r.a.createElement(ue,{message:v}),r.a.createElement(W.a,{form:T},r.a.createElement(W.a.Item,{name:"fileName",label:"File Name"},r.a.createElement(z.a,null)))),h&&r.a.createElement(ue,{message:h}),s&&r.a.createElement(Dn,null),!s&&r.a.createElement(In,{onExpand:function(e){console.log(e),i({type:kn.expand,data:{expandedKeys:e}})},autoExpandParent:!0,expandedKeys:w,onDoubleClick:function(e,a){i({type:kn.openScriptFile,data:{consoleApp:t,node:a}})},expandAction:"click",onRightClick:N,switcherIcon:r.a.createElement(on.a,null),treeData:m}))}var _n=st.a.TabPane,Mn=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).queryApp=e.parent,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return n.createElement(st.a,{defaultActiveKey:"1",style:{maxWidth:"350px"},onTabClick:function(t){"2"===t&&e.deltaLakeTreeRef&&e.deltaLakeTreeRef.reload()}},n.createElement(_n,{tab:"Script",key:"1"},n.createElement("div",{className:"leftview-box"},n.createElement(Ln,{consoleApp:this.queryApp}))),n.createElement(_n,{tab:"DeltaLake",key:"2"},n.createElement("div",{className:"leftview-box"},n.createElement($a,{ref:function(t){return e.deltaLakeTreeRef=t}}))),n.createElement(_n,{tab:"FileSystem",key:"3"},n.createElement("div",{className:"leftview-box"},n.createElement(tn,{ref:function(t){return e.fileSystemTreeRef=t}}))))}}]),t}(n.Component),qn=(a(413),function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).openExistsOrNewEditor=function(e){var t=Object(Ee.a)(Object(Ee.a)(a));if(a.fileToEditorMap.hasOwnProperty(e.id)){var n=a.fileToEditorMap[e.id];n.ref.text(e.content,e.id),a.editorGroup.current.onChange(n.activeKey)}else a.editorGroup.current.addFull(e.name,function(a){a.ref.text(e.content,e.id),t.fileToEditorMap[e.id]=a});e.name.endsWith(".nb")?t.setState({displayEditor:"notebook"}):e.name.endsWith(".py")?t.setState({displayEditor:"pythoneditor"}):t.setState({displayEditor:"normal"})},a.closeEditor=function(e){var t=Object.keys(a.fileToEditorMap).filter(function(t){return a.fileToEditorMap[t].activeKey!==e.activeKey}).reduce(function(e,t){return e[t]=a.fileToEditorMap[t],e},{});a.fileToEditorMap=t},a.getCurrentEditor=function(){return a.editorGroup.current.getCurrentEditor()},a.setData=function(e){a.queryResData=e,a.dash.current.refresh()},a.tableAndDash=function(){if("notebook"!==a.state.displayEditor||"pythoneditor"!==a.state.displayEditor)return r.a.createElement("div",null,r.a.createElement(Be.Resizable,{defaultSize:{height:"300px"},onResize:function(){a.messageBox.current.editor.resize()}},r.a.createElement(ke.a,{height:"100%",width:"100%",ref:a.messageBox,mode:"text",theme:"github",name:"message_box"})),r.a.createElement("div",null,r.a.createElement(Pt,{ref:a.dash,parent:Object(Ee.a)(Object(Ee.a)(a))})),r.a.createElement("div",{className:"mlsql-query-display"},r.a.createElement(ct,{ref:a.display,parent:Object(Ee.a)(Object(Ee.a)(a))})))},a.state={sqlContent:"",displayEditor:"normal"},a.editorGroup=r.a.createRef(),a.messageBox=r.a.createRef(),a.display=r.a.createRef(),a.dash=r.a.createRef(),a.etRef=r.a.createRef(),a.fileToEditorMap={},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"ws-app"},r.a.createElement("div",{className:"ws-left-pane"},r.a.createElement(Be.Resizable,{style:{paddingRight:"30px",borderRight:"solid"}},r.a.createElement(Mn,{ref:function(t){return e.leftTreePaneRef=t},parent:this}))),r.a.createElement("div",{className:"ws-right-pane"},r.a.createElement("div",{style:{marginBottom:"10px"}},r.a.createElement(Ha,{ref:this.etRef,parent:this})),r.a.createElement(ta,{ref:this.editorGroup,parent:this}),this.tableAndDash()))}}]),t}(n.Component)),Vn=a(1029),Bn=function(){function e(t){Object(f.a)(this,e),this.superclass=t}return Object(j.a)(e,[{key:"with",value:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.reduce(function(e,t){return t(e)},this.superclass)}}]),e}(),Gn=function(e){return new Bn(e)},Un=function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).toggleNewSession=function(){a.setState({showNewSession:!a.state.showNewSession})},a.showNewSession=function(e){if(e.node.props.table){var t={table:e.node.props.table,db:e.node.props.db};a.setState({showNewSession:!0,currentTable:t})}},a.currentTableName=function(){return a.state.currentTable?a.state.currentTable.db+"."+a.state.currentTable.table:""},a.showTable=function(){var e=Object(u.a)(l.a.mark(function e(t){var n,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({showNewSession:!1}),n=a.state.currentTable,r=n.db,o=n.table,xc.workshop.newSession(t,r,o),a.workshop.newSession(t,r,o);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(ye.a)(t,e),t}(e)},Jn=(Wa.a.TreeNode,Wa.a.DirectoryTree),Kn=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).showNewSession=function(e){var t={table:e.node.props.dataRef.path,db:""};a.setState({showNewSession:!0,currentTable:t})},a.showTable=function(){var e=Object(u.a)(l.a.mark(function e(t,n,r){var o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({showNewSession:!1}),o=a.state.currentTable,o.db,c=o.table,a.workshop.newSession(t,n,c,r);case 3:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.render=function(){return n.createElement("div",null,n.createElement(rt.a,{title:"Open Table: [".concat(a.currentTableName(),"]?"),visible:a.state.showNewSession,onCancel:a.toggleNewSession,onOk:function(){a.showTable("file",a.loadPopRef.data.sourceTypeV,a.loadPopRef.data.params)},cancelText:"Cancel",OkText:"Ok"},n.createElement(fa,{key:a.currentTableName(),ignorePath:!0,ignoreTableName:!0,ref:function(e){return a.loadPopRef=e},parent:Object(Ee.a)(Object(Ee.a)(a))})),n.createElement(za.a,{tip:"Loading...",spinning:a.state.loading},n.createElement(Jn,{loadData:a.onLoadData,onRightClick:a.showNewSession},a.renderTreeNodes(a.state.root))))},a.workshop=e.parent.workshop,a}return Object(ye.a)(t,e),t}(Gn(tn).with(Un)),Hn=Wa.a.TreeNode,Wn=Wa.a.DirectoryTree,zn=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).tableClick=function(e){a.setState({rightClickNodeTreeItem:{pageX:e.event.pageX,pageY:e.event.pageY,table:e.node.props.table,db:e.node.props.db}})},a.workshop=e.parent.workshop,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"show",value:function(){return Object.entries(this.state.dbs).map(function(e){var t=Object(p.a)(e,2),a=t[0],r=t[1];return n.createElement(Hn,{title:a,key:a},r.map(function(e){return n.createElement(Hn,{icon:n.createElement(Qa.a,null),title:e,table:e,db:a,key:e,isLeaf:!0})}))})}},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(rt.a,{title:"Open Table",visible:this.state.showNewSession,onCancel:this.toggleNewSession,onOk:function(){e.showTable("delta")},cancelText:"Cancel",OkText:"Ok"},"Open  ".concat(this.currentTableName(),"]?")),n.createElement(za.a,{tip:"Loading...",spinning:this.state.loading},n.createElement(Wn,{onRightClick:this.showNewSession},this.show())))}}]),t}(Gn($a).with(Un)),Qn=Wa.a.TreeNode,Yn=Wa.a.DirectoryTree,Xn=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).state={dbs:{},loading:!1},a.workshop=e.parent.workshop,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"reload",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,Ke.tablesInWorkshop();case 3:200===(t=e.sent).status&&(a={},t.content.forEach(function(e){a[e.sessionId]?a[e.sessionId].push(e.tableName):a[e.sessionId]=[e.tableName]}),this.setState({dbs:a})),this.setState({loading:!1});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"show",value:function(){return Object.entries(this.state.dbs).flatMap(function(e){var t=Object(p.a)(e,2),a=t[0];return t[1].map(function(e){return n.createElement(Qn,{icon:n.createElement(Qa.a,null),table:e,db:a,title:e,key:e,isLeaf:!0})})})}},{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reload();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(rt.a,{title:"Open Table",visible:this.state.showNewSession,onCancel:this.toggleNewSession,onOk:function(){e.showTable("temp")},cancelText:"Cancel",OkText:"Ok"},"Open  ".concat(this.currentTableName(),"]?")),n.createElement(za.a,{tip:"Loading...",spinning:this.state.loading},n.createElement(Yn,{onRightClick:this.showNewSession},this.show())))}}]),t}(Gn(n.Component).with(Un)),$n=st.a.TabPane,Zn=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).workshop=e.parent,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return n.createElement(st.a,{defaultActiveKey:"1",onTabClick:function(t){"2"===t&&e.deltaLakeTreeRef&&e.deltaLakeTreeRef.reload()}},n.createElement($n,{tab:"Table Workshop",key:"1"},n.createElement("div",{className:"leftview-box"},n.createElement(Xn,{ref:function(t){return e.workshopTableTreeRef=t},parent:this}))),n.createElement($n,{tab:"DeltaLake",key:"2"},n.createElement("div",{className:"leftview-box"},n.createElement(zn,{ref:function(t){return e.deltaLakeTreeRef=t},parent:this}))),n.createElement($n,{tab:"FileSystem",key:"3"},n.createElement("div",{className:"leftview-box"},n.createElement(Kn,{ref:function(t){return e.fileSystemTreeRef=t},parent:this}))))}}]),t}(n.Component),er=(a(103),a(992),a(1019)),tr=a(1015),ar=(a(993),I.a.SubMenu,function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).enter=function(){a.setState({applyLoading:!0}),a.workshop.setState({tableLoading:!0})},a.exit=function(){a.setState({applyLoading:!1}),a.workshop.setState({tableLoading:!1})},a.showSaveDiagram=function(){a.toggle()},a.toggle=function(){a.setState({saveDiagram:!a.state.saveDiagram})},a.handleTableInput=function(){},a.handlePersit=function(){},a.props=e,a.state={applyLoading:!1,saveDiagram:!1},a.workshop=e.parent.workshop,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",{style:this.props.style,className:this.props.className||"aos-box"},n.createElement(rt.a,{title:"View",visible:this.state.saveDiagram,onCancel:this.toggle,onOk:this.props.onSave,cancelText:"Cancel",width:"50%",OkText:"Ok"},n.createElement(W.a,{className:"login-form"},n.createElement(W.a.Item,null,n.createElement(z.a,{addonBefore:"tableName",onChange:this.props.handleTableInput||this.handleTableInput,placeholder:""})),n.createElement(W.a.Item,{label:"Persist table(take more space):"},n.createElement(tr.a,{onChange:this.props.handlePersit||this.handlePersit})))),n.createElement("div",{className:"aos-button"},n.createElement(Q.a,{loading:this.state.applyLoading,onClick:this.props.onApply,type:"primary"},"Apply")),n.createElement("div",{className:"aos-button"},n.createElement(Q.a,{disabled:this.state.applyLoading,onClick:this.toggle,type:"primary"},"Save As")),n.createElement("div",{className:"aos-button"},n.createElement(Q.a,{disabled:this.state.applyLoading,onClick:this.props.onRollback},"Rollback")))}}]),t}(n.Component)),nr=function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).onSave=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.workshop.save(a.tableNameForSave,a.persistForSave);case 2:200===e.sent&&(a.workshop.refreshOperateStation(),a.workshop.refreshTableWorkshop());case 4:case"end":return e.stop()}},e)})),a.onRollback=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.ApplyOrSaveRef.enter(),e.next=3,a.workshop.rollback();case 3:200===e.sent&&(a.workshop.refreshOperateStation(),a.workshop.refreshTableWorkshop()),a.ApplyOrSaveRef.exit();case 6:case"end":return e.stop()}},e)})),a.handleTableInput=function(e){a.tableNameForSave=e.target.value},a.handlePersit=function(e){a.persistForSave=e},a}return Object(ye.a)(t,e),t}(e)},rr=(a(414),Ve.a.Option),or=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).reload=Object(u.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.joinStation.joinInfo.currentTable.schema,e.next=3,Ke.tableInfo(a.joinTable);case 3:200===(n=e.sent).status&&a.setState({currentTableFields:t.fields,joinTableFields:JSON.parse(n.content.tableSchema).fields});case 5:case"end":return e.stop()}},e)})),a.componentDidMount=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.reload();case 2:case"end":return e.stop()}},e)})),a.next=function(e){a.joinStation.joinInfo=Object.assign(a.joinStation.joinInfo,e),a.joinStation.next()},a.render=function(){return n.createElement(W.a,{className:"login-form",onFinish:a.next},n.createElement(W.a.Item,{name:"leftField",rules:[{required:!0,message:"Please select condition field!"}]},n.createElement(Ve.a,{label:"Current Table",showSearch:!0,style:{width:200},placeholder:a.currentTable,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.currentTableFields.map(function(e){return n.createElement(rr,{key:e.name,value:e.name},e.name)}))),n.createElement(W.a.Item,{name:"rightField",rules:[{required:!0,message:"Please select condition field!"}]},n.createElement(Ve.a,{label:"Join Table",showSearch:!0,style:{width:200},placeholder:a.joinTable,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.joinTableFields.map(function(e){return n.createElement(rr,{key:e.name,value:e.name},e.name)}))),n.createElement(W.a.Item,null,n.createElement(Q.a,{type:"primary",htmlType:"submit"},"Next")))},a.workshop=e.parent.workshop,a.joinStation=e.parent,a.currentTable=a.joinStation.joinInfo.currentTable.table,a.joinTable=a.joinStation.joinInfo.joinTable,a.state={currentTableFields:[],joinTableFields:[]},a}return Object(ye.a)(t,e),t}(n.Component),cr=a(1027),ir=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).filterOption=function(e,t){return t.title.indexOf(e)>-1},a.handleChange=function(e){a.setState({targetKeys:e}),a.props.handleChange&&a.props.handleChange({targetKeys:e})},a.getSelectFields=function(){return a.state.targetKeys||[]},a.workshop=e.parent.workshop,a.state=a.wow(e),a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"wow",value:function(e){return{data:e.schemaFields.map(function(e){return{title:e.name,key:e.name}}),targetKeys:[]}}},{key:"componentDidUpdate",value:function(e){this.props.schemaFields!==e.schemaFields&&this.setState(Object(k.a)({},this.wow(this.props)))}},{key:"render",value:function(){return n.createElement(cr.a,{dataSource:this.state.data,showSearch:!0,filterOption:this.filterOption,targetKeys:this.state.targetKeys,onChange:this.handleChange,render:function(e){return e.title}})}}]),t}(n.Component),sr=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).reload=Object(u.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.joinStation.joinInfo.currentTable.schema,e.next=3,Ke.tableInfo(a.joinTable);case 3:200===(n=e.sent).status&&a.setState({currentTableFields:t.fields,joinTableFields:JSON.parse(n.content.tableSchema).fields});case 5:case"end":return e.stop()}},e)})),a.componentDidMount=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.reload();case 2:case"end":return e.stop()}},e)})),a.handleLeft=function(e){a.joinStation.joinInfo=Object.assign(a.joinStation.joinInfo,{leftProjectFields:e.targetKeys})},a.handleRight=function(e){a.joinStation.joinInfo=Object.assign(a.joinStation.joinInfo,{rightProjectFields:e.targetKeys})},a.reset=function(){a.joinStation.parent.reload()},a.render=function(){return n.createElement(W.a,{labelCol:{span:6}},n.createElement(W.a.Item,{name:"leftProjectFields",label:"currentTable"},n.createElement(ir,{handleChange:a.handleLeft,schemaFields:a.state.currentTableFields,ref:function(e){return a.leftProjectFields=e},parent:Object(Ee.a)(Object(Ee.a)(a))})),n.createElement(W.a.Item,{name:"rightProjectFields",label:a.joinTable+""},n.createElement(ir,{handleChange:a.handleRight,schemaFields:a.state.joinTableFields,ref:function(e){return a.rightProjectFields=e},parent:Object(Ee.a)(Object(Ee.a)(a))})),n.createElement(W.a.Item,null,n.createElement(W.a.Item,null," ",n.createElement(Q.a,{danger:!0},"Reset"))))},a.workshop=e.parent.workshop,a.joinStation=e.parent,a.currentTable=a.joinStation.joinInfo.currentTable.table,a.joinTable=a.joinStation.joinInfo.joinTable,a.state={currentTableFields:[],joinTableFields:[]},a}return Object(ye.a)(t,e),t}(n.Component),lr=Ve.a.Option,ur=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).reload=Object(u.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.tablesInWorkshop();case 2:t=e.sent,n=[],200===t.status&&(n=t.content.map(function(e){return{name:e.tableName,value:e.tableName}})),a.setState({tables:n});case 6:case"end":return e.stop()}},e)})),a.componentDidMount=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.reload();case 2:case"end":return e.stop()}},e)})),a.next=function(e){a.joinStation.joinInfo=Object.assign(a.joinStation.joinInfo,e),a.joinStation.next()},a.render=function(){return n.createElement(W.a,{className:"login-form",onFinish:a.next},n.createElement(W.a.Item,{name:"joinType",rules:[{required:!0,message:"Please select join type!"}]},n.createElement(Ve.a,{showSearch:!0,style:{width:200},placeholder:"Select Join Type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(lr,{key:"inner",value:"inner join"},"Inner Join"),n.createElement(lr,{key:"left",value:"left join"},"Left Join"),n.createElement(lr,{key:"right",value:"right join"},"Right Join"),n.createElement(lr,{key:"full",value:"full join"},"Full Join"))),n.createElement(W.a.Item,{name:"joinTable",rules:[{required:!0,message:"Please select join table!"}]},n.createElement(Ve.a,{showSearch:!0,style:{width:200},placeholder:"Choose Join Table",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.tables.map(function(e){return n.createElement(lr,{key:e.name,value:e.value},e.name)}))),n.createElement(W.a.Item,null,n.createElement(Q.a,{type:"primary",htmlType:"submit"},"Next")))},a.workshop=e.parent.workshop,a.joinStation=e.parent,a.state={tables:[]},a}return Object(ye.a)(t,e),t}(n.Component);function pr(){var e=Object(oe.a)(["\nborder: 1px dashed #e9e9e9;\nborder-radius: 6px;\nbackground-color: #fafafa;\nmin-height: 200px;\ntext-align: center;\npadding-top: 80px;\nwidth: 100%;\n"]);return pr=function(){return e},e}var dr,mr,fr=er.a.Step,hr=ce.a.div(pr()),br=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).onApply=Object(u.a)(l.a.mark(function e(){var t,n,r,o,c,i,s,u,p,d,m,f,h,b,g,v,y,E;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.workshop.currentTable.table,n=a.joinInfo,r=n.joinTable,o=n.joinType,c=n.leftField,i=n.rightField,s=n.leftProjectFields,u=n.rightProjectFields,s||u){e.next=5;break}return a.workshop.toggleMessage("Fields are not selected."),e.abrupt("return");case 5:return a.ApplyOrSaveRef.enter(),e.next=8,Ke.tableInfo(r);case 8:return p=e.sent,d=p.content,m=s&&s.map(function(e){return"".concat(t,".`").concat(e,"`")}).join(","),f=u&&u.map(function(e){return"".concat(r,".`").concat(e,"`")}).join(","),h="".concat(t,".`").concat(c,"`"),b="".concat(r,".`").concat(i,"`"),g="".concat(o," ").concat(r," on ").concat(h," = ").concat(b),v="",m&&f&&(v=m+","+f),m&&!f&&(v=m),!m&&f&&(v=f),y=la.getTempTableName(),E="".concat(d.content," \n select ").concat(v," from ").concat(t," ").concat(g," as ").concat(y,";"),console.log(E),e.next=24,a.workshop.apply({tableName:y,sql:E});case 24:a.ApplyOrSaveRef.exit(),a.workshop.refreshOperateStation();case 26:case"end":return e.stop()}},e)})),a.next=function(){a.setState({currentStep:a.state.currentStep+1})},a.preview=function(){a.setState({currentStep:a.state.currentStep-1})},a.workshop=e.parent.workshop,a.joinInfo={currentTable:a.workshop.currentTable},a.state={currentStep:0,steps:[n.createElement(ur,{parent:Object(Ee.a)(Object(Ee.a)(a))}),n.createElement(or,{parent:Object(Ee.a)(Object(Ee.a)(a))}),n.createElement(sr,{parent:Object(Ee.a)(Object(Ee.a)(a))})]},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("div",{className:"join-app"},n.createElement("div",{className:"station-menu"},n.createElement(ar,{parent:this,onRollback:this.onRollback,handleTableInput:this.handleTableInput,ref:function(t){return e.ApplyOrSaveRef=t},onSave:this.onSave,onApply:this.onApply,style:{marginBottom:"30px"}})),n.createElement("div",null,n.createElement(er.a,{current:this.state.currentStep},n.createElement(fr,{key:0,title:"Table",description:"Choose the table you wanna join from workshop"}),n.createElement(fr,{key:1,title:"Join Condition ",description:"Choose the join condition in both tables"}),n.createElement(fr,{key:2,title:"Fields",description:"Choose the fields you want from both tables"}))),n.createElement("div",{className:"join-app-form"}," ",n.createElement(hr,null,this.state.steps[this.state.currentStep])))}}]),t}(Gn(n.Component).with(nr)),gr=a(192),vr=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).setRender=function(e,t){var r=t[0][e.key];if(a.config&&a.config.render)Object.keys(a.config).map(function(t){var n=a.config[t][e.key];n&&(e[t]=n)});else{try{if(n.Component.isPrototypeOf(r.type))return void(e.render=function(e){return n.createElement("span",null,e)})}catch(o){}"html"!=e.key?"object"!==typeof r?"array"!==typeof r?"boolean"!==typeof r?"fileSystem"!=e.key&&"message"!=e.key&&"info"!=e.key||(e.render=function(e){return n.createElement("pre",null,e.toString())}):e.render=function(e){return n.createElement("span",null,e.toString())}:e.render=function(e){return n.createElement("span",null,e.join(",").substring(0,300))}:e.render=function(e){return n.createElement("span",null,JSON.stringify(e).substring(0,300))}:e.render=function(e){return n.createElement("pre",null,e.substring(0,300))}}},a.update=function(e,t){a.config=t;var n=[],r={},o=[],c=Object(Ee.a)(Object(Ee.a)(a));e.forEach(function(t){for(var a in t)if(!r[a]){var o={title:a,dataIndex:a,key:a};c.setRender(o,e),n.push(o),r[a]=!0}}),e.forEach(function(e,t){var a={};n.forEach(function(t){a[t.key]=e[t.key]}),a.key=t,o.push(a)}),a.setState({columns:n,data:o})},a.rowDoubleClick=function(e,t,n){"codeExample"!==e.name&&"doc"!==e.name||a.setState({view:{enabled:!0,content:e.value}})},a.disablePreview=function(){a.setState({view:{enabled:!1}})},a.tableStyle=e.style||{},a.state={columns:[],rows:[],view:{enabled:!1}},a.config={},a.workshop=e.parent,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",{style:this.tableStyle},n.createElement(nt.a,{size:"default",columns:this.state.columns,dataSource:this.state.data,scroll:{x:!0}}),n.createElement(rt.a,{title:"View",visible:this.state.view.enabled,onCancel:this.disablePreview,onOk:this.disablePreview,cancelText:"Cancel",OkText:"Ok"},n.createElement(gr,{source:this.state.view.content||""})))}}]),t}(n.Component),yr=a(1031),Er=(Ve.a.Option,function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).show=function(e){a.setState({func:e})},a.funcValue=function(){return n.createElement(yr.b.Item,{key:"Func"},n.createElement(yr.b.Item.Meta,{title:"Func",description:a.state.func.funcValue.extra.zhDoc}))},a.returnValue=function(){return n.createElement(yr.b.Item,{key:"Return value"},n.createElement(yr.b.Item.Meta,{title:"Return value",description:a.state.func.returnValue.extra.zhDoc}))},a.parameters=function(){return a.state.func.params.map(function(e){return n.createElement(yr.b.Item,{key:e.name},n.createElement(yr.b.Item.Meta,{title:e.name,description:e.extra.zhDoc}))})},a.state=Object(k.a)({},e),a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return this.state.func?n.createElement(yr.b,{size:"large",header:n.createElement("div",null,"Function [".concat(this.state.func.value,"] Info")),footer:n.createElement("div",null),bordered:!0},this.funcValue(),this.returnValue(),this.parameters()):n.createElement("div",null)}}]),t}(n.Component)),Or=Ve.a.Option,kr=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).handleSearch=function(){var e=Object(u.a)(l.a.mark(function e(t){var n,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,Ke.showFunctions();case 3:n=e.sent,r=n.content.map(function(e){return{value:e.key.table,text:e.key.table,funcValue:e.columns[0],returnValue:e.columns[1],params:e.columns.slice(2,e.columns.length)}}),a.setState({data:r}),e.next=9;break;case 8:a.setState({data:[]});case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){var t=a.state.data.filter(function(t){return t.value===e})[0];a.setState({currentFunc:t}),a.funcDescRef.show(t)},a.handleOperateInput=function(e){a.manuallyTransform=e.target.value},a.isAggChecked=function(e){a.manuallyIsAgg=e},a.handleNewName=function(e){a.newFuncName=e.target.value},a.handleField=function(e){var t=e.target.getAttribute("name");a.funcParams[t]=e.target.value},a.showColumn=function(e){return a.funcParams[e.name]=a.operateField,"yes"===e.extra.column?a.operateField:""},a.getTransform=function(){if(a.manuallyTransform)return{field:a.operateField,isAgg:a.manuallyIsAgg,transformCode:a.manuallyTransform,columnName:a.newFuncName};var e=[];return a.state.currentFunc.params.forEach(function(t){var n=a.funcParams[t.name];n&&("yes"===t.extra.column?e.push(la.getField(n)):"number"==t.dataType||"boolean"==t.dataType?e.push(n):e.push('"'.concat(n,'"')))}),{field:a.operateField,isAgg:"yes"===a.state.currentFunc.funcValue.extra.agg,transformCode:"".concat(a.state.currentFunc.value,"(").concat(e.join(","),")"),columnName:a.newFuncName}},a.reload=function(){a.setState({key:Math.random(),data:[],value:void 0,funcPopUp:!1,currentFunc:void 0}),a.collect={}},a.parent=e.parent,a.operateField=e.operateField,a.funcParams={},a.state={data:[],value:void 0,funcPopUp:!1,func:{},key:Math.random()},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this,t=this.state.data.map(function(e){return n.createElement(Or,{key:e.value},e.text)});return n.createElement(W.a,{className:"login-form",key:this.state.key},n.createElement(W.a.Item,null,n.createElement(Ve.a,{showSearch:!0,value:this.state.value,placeholder:"Search function",defaultActiveFirstOption:!1,showArrow:!1,style:{width:"200px"},filterOption:!1,onSearch:this.handleSearch,onChange:this.handleChange,notFoundContent:"type function name"},t)),n.createElement(W.a.Item,null,n.createElement(Er,{ref:function(t){return e.funcDescRef=t}})),this.state.currentFunc?this.state.currentFunc.params.map(function(t){return n.createElement(W.a.Item,{key:t.name},n.createElement(z.a,{name:t.name,onChange:e.handleField,addonBefore:t.name,defaultValue:e.showColumn(t)}))}):n.createElement("div",null),n.createElement(W.a.Item,null,n.createElement(z.a,{addonBefore:"Mannual Transform",onChange:this.handleOperateInput,placeholder:""})),n.createElement(W.a.Item,{label:"Is Agg Function"},n.createElement(tr.a,{onChange:this.isAggChecked})),n.createElement(W.a.Item,null,n.createElement(z.a,{addonBefore:"New fieldName",onChange:this.handleNewName,placeholder:""})))}}]),t}(n.Component),jr=(I.a.SubMenu,function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).showAggFuncsAndApply=function(e){a.operateField=e.field,a.setState({funcPopUp:!0})},a.reload=function(){var e=a.workshop.currentTable.schema.fields.map(function(e){return{field:e.name,groupby:"",agg:""}}),t={render:{groupby:function(e,t){return n.createElement(tr.a,{onChange:function(e){return a.enableGroupByField(e,t)},dataref:t})},agg:function(e,t){return n.createElement(Q.a,{dataref:t,onClick:function(){a.showAggFuncsAndApply(t)}},"Choose function")}}};a.columnsRef.update(e,t)},a.handleFunc=function(){var e=a.applyFuncToFieldRef.getTransform(),t=(e.field,e.transformCode),n=e.columnName;a.generateProjectField(t,n),a.setState({funcPopUp:!1}),a.applyFuncToFieldRef.reload()},a.workshop=e.parent.workshop,a.state={funcPopUp:!1},a.groupByFields=[],a.aggFields=[],a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.reload()}},{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement("div",null,n.createElement(rt.a,{title:"Apply function to [".concat(this.operateField,"]"),visible:this.state.funcPopUp,onCancel:function(){e.setState({funcPopUp:!1}),e.applyFuncToFieldRef.setState({key:Math.random()})},onOk:this.handleFunc,cancelText:"Cancel",width:"50%",OkText:"Ok"},n.createElement(kr,{parent:this,ref:function(t){return e.applyFuncToFieldRef=t},operateField:this.operateField})),n.createElement("div",{className:"station-menu"},n.createElement(ar,{parent:this,onRollback:this.onRollback,handlePersit:this.handlePersit,handleTableInput:this.handleTableInput,ref:function(t){return e.ApplyOrSaveRef=t},onSave:this.onSave,onApply:this.onApply,style:{marginBottom:"30px"}}))),n.createElement("div",null,n.createElement(vr,{parent:this,ref:function(t){return e.columnsRef=t}})))}}]),t}(Gn(n.Component).with(nr,function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).enableGroupByField=function(e,t){var n=t.field;e?a.groupByFields.push(n):a.groupByFields=a.groupByFields.filter(function(e){return e.name!==n})},a.generateProjectField=function(e,t){a.aggFields.push({name:e,newName:t})},a.onApply=Object(u.a)(l.a.mark(function e(){var t,n,r,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.ApplyOrSaveRef.enter(),t=la.getTempTableName(),n=a.aggFields.map(function(e){return"".concat(e.name," as `").concat(e.newName,"`")}),r="",0!==a.groupByFields.length&&(r="group by ".concat(a.groupByFields.map(function(e){return"`".concat(e,"`")}).join(",")),n=a.groupByFields.map(function(e){return"`".concat(e,"`")}).concat(n)),o="select ".concat(n.join(",")," from ").concat(a.workshop.getLastApplyTable().tableName," ").concat(r," as ").concat(t,";"),e.next=8,a.workshop.apply({tableName:t,sql:o});case 8:c=e.sent,a.ApplyOrSaveRef.exit(),200===c&&a.workshop.refreshOperateStation();case 11:case"end":return e.stop()}},e)})),a}return Object(ye.a)(t,e),t}(e)}))),wr=(a(415),function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).getSelectFields=function(){return a.formRef.getFieldValue()},a.workshop=e.parent.workshop,a.state=a.wow(e),a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"wow",value:function(e){return{data:e.schemaFields.map(function(e){return{title:e.name,key:e.name}}),targetKeys:[]}}},{key:"componentDidUpdate",value:function(e){this.props.schemaFields!==e.schemaFields&&this.setState(Object(k.a)({},this.wow(this.props)))}},{key:"render",value:function(){var e=this;return n.createElement(W.a,{labelCol:{span:6},ref:function(t){e.formRef=t}},this.state.data.map(function(e){return n.createElement(W.a.Item,{key:e.key,name:e.key,label:e.key,value:e.key},n.createElement(z.a,{placeholder:"input the new name here"}))}))}}]),t}(n.Component)),Sr=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).wow=function(e){return{funcPopUp:!1,data:e.schemaFields.map(function(e){return{field:e.name,func:"",transformCode:"",columnName:""}}),config:{render:{func:function(e,t){return n.createElement(Q.a,{dataref:t,onClick:function(){a.showAggFuncsAndApply(t)}},"Choose function")},transformCode:function(e,t){return e},columnName:function(e,t){return e}}}}},a.showAggFuncsAndApply=function(e){a.operateField=e.field,a.setState({funcPopUp:!0})},a.reload=function(){a.columnsRef.update(a.state.data,a.state.config)},a.handleFunc=function(){var e=a.applyFuncToFieldRef.getTransform(),t=e.field,n=e.transformCode,r=e.columnName,o=e.isAgg;if(r){var c=a.state.data.map(function(e){return e.field===t?{field:t,func:"",transformCode:n,columnName:r,isAgg:o}:e});a.setState({funcPopUp:!1,data:c,error:void 0},function(){a.reload()}),a.applyFuncToFieldRef.reload()}else a.setState({error:"New fieldName is required."})},a.getSelectFields=function(){return a.state.data},a.render=function(){return n.createElement("div",null,n.createElement(rt.a,{title:"Apply function to [".concat(a.operateField,"]"),visible:a.state.funcPopUp,onCancel:function(){a.applyFuncToFieldRef.reload(),a.setState({funcPopUp:!1,error:void 0})},onOk:a.handleFunc,cancelText:"Cancel",width:"50%",OkText:"Ok"},a.state.error&&n.createElement(ue,{message:a.state.error}),n.createElement(kr,{parent:Object(Ee.a)(Object(Ee.a)(a)),ref:function(e){return a.applyFuncToFieldRef=e},operateField:a.operateField})),n.createElement(vr,{ref:function(e){return a.columnsRef=e}}))},a.workshop=e.parent.workshop,a.state=a.wow(e),a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;this.props.schemaFields!==e.schemaFields&&this.setState(Object(k.a)({},this.wow(this.props)),function(){t.reload()})}},{key:"componentDidMount",value:function(){this.reload()}}]),t}(n.Component),xr=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.fields,n=t.__state.operateFileds.filter(function(e){return a!==e.field}),e.abrupt("return",{data:{operateFileds:n}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Cr=xr.handler,Tr=xr.action,Nr=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.fields.map(function(e){return{field:e}}),e.abrupt("return",{data:{operateFileds:a}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Rr=Nr.handler,Dr=Nr.action,Ar=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,null,[{key:"apply",value:function(){var e=Object(u.a)(l.a.mark(function e(t,a,n){var r,o,c,i,s,u,p,d;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,o=r.workshop,c=r.values,i=t.__state.applySaveRollbackDispacher,!(s=a(c))){e.next=6;break}return i({type:"setState",data:{loading:!1}}),e.abrupt("return",{data:Object(k.a)({},t.data,{error:s,loading:!1})});case 6:return u=n(o,c),p=u.tableName,d=u.sql,e.next=9,o.apply({tableName:p,sql:d});case 9:return 200===e.sent&&o.refreshOperateStation(),i({type:"setState",data:{loading:!1}}),e.abrupt("return",{data:Object(k.a)({},t.data,{loading:!1})});case 13:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}()}]),e}(),Ir=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ar.apply(t,function(e){if(0==Object.keys(e).length)return"Please configure cast fields then click apply"},function(e,t){var a=la.getTempTableName(),n=Object.keys(t).map(function(e){return"cast(".concat(la.getField(e)," as ").concat(t[e],") as ").concat(la.getField(e))}),r=Object.keys(t),o=e.currentTable.schema.fields.filter(function(e){return!r.includes(e.name)}).map(function(e){return la.getField(e.name)}),c=n.concat(o).join(",");return{tableName:a,sql:"select ".concat(c," from ").concat(e.getLastApplyTable().tableName,"            \n            as ").concat(a,";")}}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Fr=Ir.handler,Pr=Ir.action,Lr=function e(){Object(f.a)(this,e)};Lr.ADD_FIELD="addField",Lr.REMOVE_FIELD="removeField";var _r=Object(k.a)({},sn,(dr={},Object(m.a)(dr,Lr.ADD_FIELD,Rr),Object(m.a)(dr,Lr.REMOVE_FIELD,Cr),Object(m.a)(dr,"apply",Fr),dr)),Mr=Object(k.a)({},ln,(mr={},Object(m.a)(mr,Lr.ADD_FIELD,Dr),Object(m.a)(mr,Lr.REMOVE_FIELD,Tr),Object(m.a)(mr,"apply",Pr),mr));function qr(e,t){return Mr[t.type](e,t.data)}var Vr=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data.workshop,e.next=3,a.rollback();case 3:return e.abrupt("return",{data:t.data});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Br=Vr.handler,Gr=Vr.action,Ur=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.data.workshop,n=t.__state,r=n.saveTablePersisted,o=n.saveTableName){e.next=4;break}return e.abrupt("return",{data:{error:"table name is required"}});case 4:return e.next=6,a.save(o,r);case 6:return a.refreshTableWorkshop(),e.abrupt("return",{data:Object(k.a)({},t.data,{loading:!1})});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Jr=Ur.handler,Kr=Ur.action,Hr={setState:N.SetStateActionHandler,rollback:Br,save:Jr};function Wr(e,t){switch(t.type){case"setState":return Object(N.SetStateAction)(e,t.data);case"rollback":return Gr(e,t.data);case"save":return Kr(e,t.data);default:return e}}var zr={saveDiagram:!1,saveTablePersisted:!1,loading:!1,saveTableName:void 0,error:void 0},Qr=r.a.createContext();function Yr(e){var t=e.workshop,a=Object(n.useContext)(e.context).dispacher,o=Object(d.useReducerAsync)(Wr,zr,Hr),c=Object(p.a)(o,2),i=c[0],s=c[1],l=i.saveDiagram,u=(i.saveTablePersisted,i.loading),m=i.error;return r.a.createElement(Qr.Provider,{value:{dispacher:s}},m&&r.a.createElement(ue,{message:m}),r.a.createElement(rt.a,{title:"View",visible:l,onCancel:function(){s({type:"setState",data:{saveDiagram:!1}})},onOk:function(){s({type:"save",data:{saveDiagram:!1,workshop:t}})},cancelText:"Cancel",width:"50%",OkText:"Ok"},r.a.createElement(W.a,{className:"login-form"},r.a.createElement(W.a.Item,null,r.a.createElement(z.a,{addonBefore:"tableName",onChange:function(e){s({type:"setState",data:{saveTableName:e.target.value}})},placeholder:""})),r.a.createElement(W.a.Item,{label:"Persist table(take more space):"},r.a.createElement(tr.a,{onChange:function(e){s({type:"setState",data:{saveTablePersisted:e}})}})))),r.a.createElement(Q.a,{loading:u,type:"primary",onClick:function(){s({type:"setState",data:{loading:!0}}),a({type:"setState",data:{applySaveRollbackDispacher:s}})}},"Apply"),r.a.createElement(F.a,{type:"vertical"}),r.a.createElement(Q.a,{disabled:u,onClick:function(){s({type:"setState",data:{saveDiagram:!0}})}},"Save As"),r.a.createElement(F.a,{type:"vertical"}),r.a.createElement(Q.a,{disabled:u,onClick:function(){s({type:"setState",data:{loading:!0}}),s({type:"rollback",data:{workshop:t,loading:!1}})}},"Rollback"))}var Xr,$r,Zr=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ar.apply(t,function(e){if(0==Object.keys(e).length)return"Please configure order fields then click apply"},function(e,t){var a=la.getTempTableName(),n=Object.keys(t).map(function(e){return" ".concat(la.getField(e)," ").concat(t[e]," ")}).join(",");return{tableName:a,sql:"select * from ".concat(e.getLastApplyTable().tableName,"\n            order by  ").concat(n,"\n            as ").concat(a,";")}}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),eo=Zr.handler,to=Zr.action,ao=function e(){Object(f.a)(this,e)};ao.ADD_FIELD="addField",ao.REMOVE_FIELD="removeField";var no=(Xr={},Object(m.a)(Xr,ao.ADD_FIELD,Rr),Object(m.a)(Xr,ao.REMOVE_FIELD,Cr),Object(m.a)(Xr,"setState",N.SetStateActionHandler),Object(m.a)(Xr,"apply",eo),Xr),ro=($r={},Object(m.a)($r,ao.ADD_FIELD,Dr),Object(m.a)($r,ao.REMOVE_FIELD,Tr),Object(m.a)($r,"setState",N.SetStateAction),Object(m.a)($r,"apply",to),$r);function oo(e,t){return ro[t.type](e,t.data)}var co=Ve.a.Option,io={error:void 0,applySaveRollbackDispacher:void 0,operateFileds:[]},so=r.a.createContext();function lo(e){var t=e.workshop,a=W.a.useForm(),o=Object(p.a)(a,1)[0],c=t.currentTable.schema.fields,i=Object(d.useReducerAsync)(qr,io,_r),s=Object(p.a)(i,2),l=s[0],u=s[1],m=l.operateFileds,f=l.error,h=l.applySaveRollbackDispacher,b=c.map(function(e){return r.a.createElement(co,{key:e.name},e.name)});return Object(n.useEffect)(function(){h&&o.submit()},[h]),r.a.createElement(so.Provider,{value:{dispacher:u}},r.a.createElement("div",{style:{marginTop:"10px",width:"400px"}},f&&r.a.createElement(ue,{message:f}),r.a.createElement(W.a,{form:o,onFinish:function(e){u({type:"apply",data:{workshop:t,values:e}})},className:"login-form"},r.a.createElement(W.a.Item,null,r.a.createElement(Yr,{context:so,workshop:t})),r.a.createElement(W.a.Item,{label:"Choose fields"},r.a.createElement(Ve.a,{mode:"multiple",onDeselect:function(e){u({type:Lr.REMOVE_FIELD,data:{fields:e}})},onChange:function(e){u({type:Lr.ADD_FIELD,data:{fields:e}})}},b)),m.map(function(e){return r.a.createElement(W.a.Item,{key:e.field,label:"Cast ".concat(e.field," to"),name:e.field},r.a.createElement(Ve.a,null,r.a.createElement(Ve.a.Option,{value:"int"},"int"),r.a.createElement(Ve.a.Option,{value:"long"},"long"),r.a.createElement(Ve.a.Option,{value:"double"},"double"),r.a.createElement(Ve.a.Option,{value:"string"},"string")))}))))}var uo=st.a.TabPane,po=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).workshop=e.parent.workshop,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement("div",{className:"station-menu"},n.createElement(st.a,{defaultActiveKey:"1",className:"station-tabs"},n.createElement(uo,{tab:"Select Columns",key:"1"},n.createElement(ar,{parent:this,onRollback:this.onRollback,handlePersit:this.handlePersit,handleTableInput:this.handleTableInput,ref:function(t){return e.ApplyOrSaveRef=t},onSave:this.onSave,onApply:this.onSelectApply,style:{marginBottom:"30px"}}),n.createElement(ir,{schemaFields:this.workshop.currentTable.schema.fields,ref:function(t){return e.selectFieldsRef=t},parent:this})),n.createElement(uo,{tab:"Rename Columns",key:"2"},n.createElement(ar,{parent:this,onRollback:this.onRollback,handlePersit:this.handlePersit,handleTableInput:this.handleTableInput,ref:function(t){return e.ApplyOrSaveRef=t},onSave:this.onSave,onApply:this.onRenameApply,style:{marginBottom:"30px"}}),n.createElement(wr,{schemaFields:this.workshop.currentTable.schema.fields,ref:function(t){return e.renameFieldsRef=t},parent:this})),n.createElement(uo,{tab:"Transform Columns",key:"3"},n.createElement(ar,{parent:this,onRollback:this.onRollback,handlePersit:this.handlePersit,handleTableInput:this.handleTableInput,ref:function(t){return e.ApplyOrSaveRef=t},onSave:this.onSave,onApply:this.onFuncApply,style:{marginBottom:"30px"}}),n.createElement(Sr,{schemaFields:this.workshop.currentTable.schema.fields,ref:function(t){return e.functionFieldRef=t},parent:this})),n.createElement(uo,{tab:"Cast Column Type",key:"4"},n.createElement(lo,{workshop:this.workshop})))),n.createElement("div",null))}}]),t}(Gn(n.Component).with(nr,function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).onSelectApply=Object(u.a)(l.a.mark(function e(){var t,n,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.ApplyOrSaveRef.enter(),0!==(t=a.selectFieldsRef.getSelectFields().map(function(e){return"`".concat(e,"`")})).length){e.next=6;break}return a.workshop.showInfo("No fields are selected."),a.ApplyOrSaveRef.exit(),e.abrupt("return");case 6:return n=la.getTempTableName(),r="select ".concat(t.join(",")," from ").concat(a.workshop.getLastApplyTable().tableName," as ").concat(n,";"),e.next=10,a.workshop.apply({tableName:n,sql:r});case 10:a.ApplyOrSaveRef.exit(),a.workshop.refreshOperateStation();case 12:case"end":return e.stop()}},e)})),a.onFuncApply=Object(u.a)(l.a.mark(function e(){var t,n,r,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.ApplyOrSaveRef.enter(),0!==(t=a.functionFieldRef.getSelectFields()).length){e.next=6;break}return a.workshop.toggleMessage("No fields are renamed."),a.ApplyOrSaveRef.exit(),e.abrupt("return");case 6:return n=t.filter(function(e){return e.isAgg}).length>0,r=[],r=n?t.filter(function(e){return e.isAgg}).map(function(e){return"".concat(e.transformCode," as `").concat(e.columnName,"`")}):t.map(function(e){return e.transformCode?"".concat(e.transformCode," as `").concat(e.columnName,"`"):"`".concat(e.field,"` as `").concat(e.field,"`")}),o=la.getTempTableName(),c="select ".concat(r.join(",")," from ").concat(a.workshop.getLastApplyTable().tableName," as ").concat(o,";"),e.next=13,a.workshop.apply({tableName:o,sql:c});case 13:a.ApplyOrSaveRef.exit(),a.workshop.refreshOperateStation();case 15:case"end":return e.stop()}},e)})),a.onRenameApply=Object(u.a)(l.a.mark(function e(){var t,n,r,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.ApplyOrSaveRef.enter(),t=a.renameFieldsRef.getSelectFields(),n=a.workshop.currentTable.schema.fields.map(function(e){return"`".concat(e.name,"`")}),0!==t.length){e.next=7;break}return a.workshop.toggleMessage("No fields are renamed."),a.ApplyOrSaveRef.exit(),e.abrupt("return");case 7:return r=Object.keys(t).map(function(e){return"`".concat(e,"` as `").concat(t[e],"`")}),o=la.getTempTableName(),c="select ".concat(n.concat(r).join(",")," from ").concat(a.workshop.getLastApplyTable().tableName," as ").concat(o,";"),e.next=12,a.workshop.apply({tableName:o,sql:c});case 12:a.ApplyOrSaveRef.exit(),a.workshop.refreshOperateStation();case 14:case"end":return e.stop()}},e)})),a}return Object(ye.a)(t,e),t}(e)})),mo=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).reload=function(e){a.setState(Object(k.a)({},a.wow(e)))},a.compareInput=function(e,t){var n=a.params.filter(function(e){return e.field===t.field});1==n.length?n[0].compare=e:a.params.push(Object(k.a)({},t,{compare:e}))},a.conditionInput=function(e,t){var n=a.params.filter(function(e){return e.field===t.field});1===n.length?n[0].condition=e:a.params.push(Object(k.a)({},t,{condition:e}))},a.wow=function(e){return{funcPopUp:!1,data:e.map(function(e){return{key:e.name,field:e.name,dataType:e.type,compare:"=",condition:"",command:""}}),columns:[{title:"field",dataIndex:"field"},{title:"dataType",dataIndex:"dataType",render:function(e,t){switch(typeof e){case"object":return n.createElement("span",null,e.type);default:return n.createElement("span",null,e)}}},{title:"compare",dataIndex:"compare",render:function(e,t){return n.createElement(Ve.a,{key:t.field,defaultValue:e,onChange:function(e){a.compareInput(e,t)},style:{width:100}},n.createElement(Ve.a.Option,{value:"="},"="),n.createElement(Ve.a.Option,{value:"<"},"<"),n.createElement(Ve.a.Option,{value:">"},">"),n.createElement(Ve.a.Option,{value:">="},">="),n.createElement(Ve.a.Option,{value:"<="},"<="),n.createElement(Ve.a.Option,{value:"like"},"like"),n.createElement(Ve.a.Option,{value:"in"},"in"))}},{title:"condition",dataIndex:"condition",render:function(e,t){return n.createElement(z.a,{onChange:function(e){a.conditionInput(e.target.value,t)},key:t.field,defaultValue:e})}}]}},a.addGroup=function(e){var t=e.groupName,n=e.groupType;if(t&&n){var r=a.params.filter(function(e){return a.selectedRowKeys.includes(e.field)});a.fitlerStation.conGroups[t]={groupName:t,groupType:n,tp:"basic",data:r},a.fitlerStation.applyGroup&&a.fitlerStation.applyGroup.reload({data:a.fitlerStation.conGroups}),a.fitlerStation.groupGroup&&a.fitlerStation.groupGroup.reload({data:a.fitlerStation.conGroups}),a.workshop.showInfo("Add successfully")}else a.workshop.showInfo("Error: groupName and groupType is required.")},a.render=function(){var e={onChange:function(e,t){a.selectedRowKeys=e},getCheckboxProps:function(e){return{name:e.field}}};return n.createElement("div",null,n.createElement(W.a,{onFinish:a.addGroup},n.createElement(W.a.Item,{name:"groupName",label:"Group Name"},n.createElement(z.a,null)),n.createElement(W.a.Item,{name:"groupType",label:"Group Type",defaultValue:"and"},n.createElement(Ve.a,null,n.createElement(Ve.a.Option,{value:"and"},"and"),n.createElement(Ve.a.Option,{value:"or"},"or"))),n.createElement(W.a.Item,null,n.createElement(Q.a,{type:"primary",htmlType:"submit"},"Add selected conditions to group"))),n.createElement(F.a,null),n.createElement(ar,{parent:Object(Ee.a)(Object(Ee.a)(a)),onRollback:a.fitlerStation.onRollback,handlePersit:a.fitlerStation.handlePersit,handleTableInput:a.fitlerStation.handleTableInput,ref:function(e){return a.fitlerStation.ApplyOrSaveRef=e},onSave:a.fitlerStation.onSave,onApply:function(){var e=a.params.filter(function(e){return a.selectedRowKeys.includes(e.field)});a.fitlerStation.onNonGroupFilterApply(e)},style:{marginBottom:"30px"}}),n.createElement(nt.a,{rowSelection:Object(k.a)({type:"checkbox"},e),columns:a.state.columns,dataSource:a.state.data}))},a.fitlerStation=e.parent,a.workshop=e.parent.workshop,a.state=a.wow(e.schemaFields),a.params=[],a}return Object(ye.a)(t,e),t}(n.Component),fo=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).reload=function(e){a.setState(Object(k.a)({},a.wow(e)))},a.wow=function(e){return{funcPopUp:!1,data:Object.keys(e.data).map(function(e){return{groupName:e}}).map(function(e){return{key:e.groupName,groupName:e.groupName}}),columns:[{title:"groupName",dataIndex:"groupName"}]}},a.addGroup=function(e){var t=e.groupName,n=e.groupType;if(t&&n){var r=a.params.filter(function(e){return a.selectedRowKeys.includes(e.title)});a.fitlerStation.conGroups[t]={groupName:t,groupType:n,tp:"group",data:r},a.workshop.showInfo("Add successfully")}else a.workshop.showInfo("Error: groupName and groupType is required.")},a.render=function(){var e={onChange:function(e,t){a.selectedRowKeys=e},getCheckboxProps:function(e){return{name:e.title}}};return n.createElement("div",null,n.createElement(W.a,{onFinish:a.addGroup},n.createElement(W.a.Item,{name:"groupName",label:"Group Name"},n.createElement(z.a,null)),n.createElement(W.a.Item,{name:"groupType",label:"Group Type",defaultValue:"and"},n.createElement(Ve.a,null,n.createElement(Ve.a.Option,{value:"and"},"and"),n.createElement(Ve.a.Option,{value:"or"},"or"))),n.createElement(W.a.Item,null,n.createElement(Q.a,{type:"primary",htmlType:"submit"},"Add selected"))),n.createElement(nt.a,{rowSelection:Object(k.a)({type:"checkbox"},e),columns:a.state.columns,dataSource:a.state.data}))},a.fitlerStation=e.parent,a.workshop=e.parent.workshop,a.state=a.wow(e),a}return Object(ye.a)(t,e),t}(n.Component),ho=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).reload=function(e){a.setState(Object(k.a)({},a.wow(e)))},a.wow=function(e){return{data:Object.keys(e.data).map(function(e){return{groupName:e}}).map(function(e){return{key:e.groupName,groupName:e.groupName}}),refresh:Math.random()}},a.onChange=function(e){a.groupName=e},a.render=function(){return n.createElement("div",null,n.createElement(W.a,{key:a.state.refresh},n.createElement(W.a.Item,{label:"Select group name to apply:"},n.createElement(Ve.a,{onChange:a.onChange},a.state.data.map(function(e){return n.createElement(Ve.a.Option,{key:e.key,value:e.groupName},e.groupName)})))))},a.fitlerStation=e.parent,a.workshop=e.parent.workshop,a.state=a.wow(e),a}return Object(ye.a)(t,e),t}(n.Component),bo=st.a.TabPane,go=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).onNonGroupFilterApply=function(){var e=Object(u.a)(l.a.mark(function e(t){var n,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(function(e){var t="";switch(e.dataType){case"string":t='"'.concat(e.condition,'"');break;default:t=e.condition}return"".concat(la.getField(e.field)," ").concat(e.compare," ").concat(t)}).join(" and "),a.ApplyOrSaveRef.enter(),r=la.getTempTableName(),o="select * from ".concat(a.workshop.getLastApplyTable().tableName," \n        where ").concat(n,"\n        as ").concat(r,";"),e.next=6,a.workshop.apply({tableName:r,sql:o});case 6:a.ApplyOrSaveRef.exit(),a.workshop.refreshOperateStation();case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onFilterApply=Object(u.a)(l.a.mark(function e(){var t,n,r,o,c,i,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=function(e){if("basic"===e.tp)return"and"===e.groupType?"(".concat(r(e.data).join(" and "),")"):"(".concat(r(e.data).join(" or "),")");if("and"===e.groupType){var t=e.data.flatMap(function(e){return o(e)}).join(" and ");return"(".concat(t,")")}var a=e.data.flatMap(function(e){return o(e)});return"(".concat(a.join(" or "),")")},r=function(e){return e.map(function(e){var t="";switch(e.dataType){case"string":t='"'.concat(e.condition,'"');break;default:t=e.condition}return"".concat(la.getField(e.field)," ").concat(e.compare," ").concat(t)})},t=a.applyGroup.groupName){e.next=6;break}return a.workshop.showInfo("Choose the group name to apply."),e.abrupt("return");case 6:return n=a.conGroups[t],c=o(n),a.ApplyOrSaveRef.enter(),i=la.getTempTableName(),s="select * from ".concat(a.workshop.getLastApplyTable().tableName," \n        where ").concat(c,"\n        as ").concat(i,";"),e.next=13,a.workshop.apply({tableName:i,sql:s});case 13:a.ApplyOrSaveRef.exit(),a.workshop.refreshOperateStation();case 15:case"end":return e.stop()}},e)})),a.workshop=e.parent.workshop,a.conGroups={},a.currentConditions={},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e,t,a,r=this;return n.createElement("div",null,n.createElement("div",{className:"station-menu"},n.createElement(st.a,{defaultActiveKey:"1",className:"station-tabs"},n.createElement(bo,{tab:"Add Conditions to Group",key:"1"},n.createElement(mo,(e={parent:this,ref:function(e){return r.compare=e}},Object(m.a)(e,"parent",this),Object(m.a)(e,"schemaFields",this.workshop.currentTable.schema.fields),e))),n.createElement(bo,{tab:"Apply Group",key:"2"},n.createElement(ar,{parent:this,onRollback:this.onRollback,handlePersit:this.handlePersit,handleTableInput:this.handleTableInput,ref:function(e){return r.ApplyOrSaveRef=e},onSave:this.onSave,onApply:this.onFilterApply,style:{marginBottom:"30px"}}),n.createElement(F.a,null),n.createElement(ho,(t={parent:this,ref:function(e){return r.applyGroup=e}},Object(m.a)(t,"parent",this),Object(m.a)(t,"data",this.conGroups),t))),n.createElement(bo,{tab:"Add Groups to Group",key:"3"},n.createElement(fo,(a={parent:this,ref:function(e){return r.groupGroup=e}},Object(m.a)(a,"parent",this),Object(m.a)(a,"data",this.conGroups),a))))),n.createElement("div",null))}}]),t}(Gn(n.Component).with(nr)),vo={operateFileds:[],error:void 0,applySaveRollbackDispacher:void 0},yo=r.a.createContext(),Eo=Ve.a.Option;function Oo(e){var t=e.parent.workshop,a=t.currentTable.schema.fields,o=Object(d.useReducerAsync)(oo,vo,no),c=Object(p.a)(o,2),i=c[0],s=c[1],l=i.operateFileds,u=i.error,m=i.applySaveRollbackDispacher,f=W.a.useForm(),h=Object(p.a)(f,1)[0],b=a.map(function(e){return r.a.createElement(Eo,{key:e.name},e.name)});return Object(n.useEffect)(function(){m&&h.submit()},[m]),r.a.createElement(yo.Provider,{value:{dispacher:s}},r.a.createElement("div",{style:{marginTop:"10px",width:"400px"}},u&&r.a.createElement(ue,{message:u}),r.a.createElement(W.a,{form:h,onFinish:function(e){s({type:"apply",data:{workshop:t,values:e}})},className:"login-form"},r.a.createElement(W.a.Item,null,r.a.createElement(Yr,{context:yo,workshop:t})),r.a.createElement(W.a.Item,{label:"Choose fields"},r.a.createElement(Ve.a,{mode:"multiple",onDeselect:function(e){s({type:ao.REMOVE_FIELD,data:{fields:e}})},onChange:function(e){s({type:ao.ADD_FIELD,data:{fields:e}})}},b)),l.map(function(e){return r.a.createElement(W.a.Item,{initialValue:"desc",key:e.field,label:e.field,name:e.field},r.a.createElement(Ve.a,null,r.a.createElement(Ve.a.Option,{value:"desc"},"desc"),r.a.createElement(Ve.a.Option,{value:"asc"},"asc")))}))))}var ko=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ar.apply(t,function(e){return 0==Object.keys(e).length?"Please configure limit size then click apply.":e.limitSize?void 0:"Please configure limit size then click apply."},function(e,t){var a=la.getTempTableName(),n=t.limitSize;return{tableName:a,sql:"select * from ".concat(e.getLastApplyTable().tableName,"\n            limit  ").concat(n,"\n            as ").concat(a,";")}}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),jo=ko.handler,wo=ko.action,So=Object(k.a)({},sn,{apply:jo}),xo=Object(k.a)({},ln,{apply:wo});function Co(e,t){return xo[t.type](e,t.data)}var To={limitSize:void 0,error:void 0,applySaveRollbackDispacher:void 0},No=r.a.createContext();function Ro(e){var t=e.parent.workshop,a=Object(d.useReducerAsync)(Co,To,So),o=Object(p.a)(a,2),c=o[0],i=o[1],s=(c.limitSize,c.error),l=c.applySaveRollbackDispacher,u=W.a.useForm(),m=Object(p.a)(u,1)[0];return Object(n.useEffect)(function(){l&&m.submit()},[l]),r.a.createElement(No.Provider,{value:{dispacher:i}},r.a.createElement("div",{style:{marginTop:"10px",width:"400px"}},s&&r.a.createElement(ue,{message:s}),r.a.createElement(W.a,{form:m,onFinish:function(e){i({type:"apply",data:{workshop:t,values:e}})},className:"login-form"},r.a.createElement(W.a.Item,null,r.a.createElement(Yr,{context:No,workshop:t})),r.a.createElement(W.a.Item,{name:"limitSize"},r.a.createElement(z.a,null)))))}var Do,Ao,Io=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t.__state.result).groupFields=t.data.groupFields,e.abrupt("return",{data:{current:t.__state.current+1,result:a}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Fo=Io.handler,Po=Io.action,Lo=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t.__state.result).orderFields=t.data.orderFields,e.abrupt("return",{data:{current:t.__state.current+1,result:a}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),_o=Lo.handler,Mo=Lo.action,qo=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t.__state.result).rowWindows=t.data.rowWindows,e.abrupt("return",{data:{current:t.__state.current+1,result:a}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Vo=qo.handler,Bo=qo.action,Go=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r,o,c,i,s,u,p,d,m,f,h,b,g,v,y,E,O,k;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.__state.result,n=a.groupFields,r=a.orderFields,o=a.rowWindows,c=t.data,i=c.workshop,s=c.functions,u=n.map(function(e){return la.getField(e.field)}).join(","),p=r.map(function(e){return"".concat(la.getField(e.field)," ").concat(e.value)}),d="",p.length>0&&(d="order by ".concat(p.join(","))),m=o.windowType,f=o.preceding,h=o.following,b="",g=f||"UNBOUNDED",v=h||"UNBOUNDED",!m){e.next=18;break}e.t0=m,e.next="row window"===e.t0?14:"range window"===e.t0?16:18;break;case 14:return b="ROWS BETWEEN ".concat(g," PRECEDING and ").concat(v," FOLLOWING"),e.abrupt("break",18);case 16:return b="RANGE BETWEEN ".concat(g," PRECEDING and ").concat(v," FOLLOWING"),e.abrupt("break",18);case 18:return y=s.map(function(e){e.field,e.isAgg;var t=e.transformCode,a=e.columnName;return"".concat(t," over w as ").concat(a)}).join(","),E=i.currentTable.schema.fields.map(function(e){return la.getField(e.name)}).join(","),O=la.getTempTableName(),k="\n     select ".concat(E,",").concat(y,"\n     from ").concat(i.getLastApplyTable().tableName," \n     window w as (\n         partition by ").concat(u," ").concat(d," ").concat(b,"\n     ) as ").concat(O,";\n    "),e.next=24,i.apply({tableName:O,sql:k});case 24:return i.refreshOperateStation(),e.abrupt("return",{data:{}});case 26:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Uo=Go.handler,Jo=Go.action,Ko=function e(){Object(f.a)(this,e)};Ko.buildGroup="buildGroup",Ko.buildOrder="buildOrder",Ko.buildRowWindows="buildRowWindows",Ko.apply="apply";var Ho=Object(k.a)({},sn,(Do={},Object(m.a)(Do,Ko.buildGroup,Fo),Object(m.a)(Do,Ko.buildOrder,_o),Object(m.a)(Do,Ko.buildRowWindows,Vo),Object(m.a)(Do,"apply",Uo),Do)),Wo=Object(k.a)({},ln,(Ao={},Object(m.a)(Ao,Ko.buildGroup,Po),Object(m.a)(Ao,Ko.buildOrder,Mo),Object(m.a)(Ao,Ko.buildRowWindows,Bo),Object(m.a)(Ao,"apply",Jo),Ao));function zo(e,t){return Wo[t.type](e,t.data)}var Qo=Ve.a.Option;var Yo=function(e){var t=e.workshop,a=(e.dispacher,e.context),o=e.enableApply,c=void 0!==o&&o,i=e.fieldWrapper,s=e.submit,l=e.selectFields,u=e.selectFieldsLabel,d=void 0===u?"Choose fields":u,m=e.selectFieldsMode,f=void 0===m?"multiple":m,h=l||t.currentTable.schema.fields,b=Object(n.useState)([]),g=Object(p.a)(b,2),v=g[0],y=g[1],E=Object(n.useState)(void 0),O=Object(p.a)(E,2),k=O[0],j=O[1],w=W.a.useForm(),S=Object(p.a)(w,1)[0],x=h.map(function(e){return r.a.createElement(Qo,{key:e.name},e.name)});return{ui:function(e){return r.a.createElement(W.a,{form:S,className:"login-form",onFinish:s},k&&r.a.createElement(ue,{onClose:function(){j(void 0)},message:k}),c&&r.a.createElement(W.a.Item,null,r.a.createElement(Yr,{context:a,workshop:t})),r.a.createElement(W.a.Item,{label:d,name:"selectFieldsName"},r.a.createElement(Ve.a,{style:{minWidth:"200px"},mode:f,onDeselect:function(e){y(v.filter(function(t){return e!==t.field}))},onChange:function(e){y("multiple"===f?e.map(function(e){return{field:e}}):[{field:e}])}},x)),v.map(function(e){return i(e)}),e)},operateFields:v,form:S,setError:j}};function Xo(e){var t=Object(n.useContext)(cc).dispacher,a=Yo({workshop:e.workshop,fieldWrapper:function(e){return r.a.createElement(r.a.Fragment,null)}}),o=a.ui,c=a.operateFields,i=a.setError;return o([r.a.createElement(W.a.Item,{key:"button"},r.a.createElement(Q.a,{type:"primary",onClick:function(){0!==c.length?t({type:Ko.buildGroup,data:{groupFields:c}}):i("Fields are required.")}},"Next"))])}function $o(e){var t=Object(n.useContext)(cc).dispacher,a=Yo({workshop:e.workshop,fieldWrapper:function(e){return r.a.createElement(W.a.Item,{initialValue:"desc",key:e.field,label:e.field,name:e.field},r.a.createElement(Ve.a,null,r.a.createElement(Ve.a.Option,{value:"desc"},"desc"),r.a.createElement(Ve.a.Option,{value:"asc"},"asc")))}}),o=a.ui,c=a.operateFields,i=(a.setError,a.form);return o([r.a.createElement(W.a.Item,null,r.a.createElement(Q.a,{type:"primary",onClick:function(){var e=i.getFieldValue(),a=c.map(function(t){return{field:t.field,value:e[t.field]}});t({type:Ko.buildOrder,data:{orderFields:a}})}},"Next"),r.a.createElement(F.a,{type:"vertical"}),r.a.createElement(Q.a,{onClick:function(){t({type:"setState",data:{current:0}})}},"Previous"))])}function Zo(e){var t=Object(n.useContext)(cc).dispacher,a=Yo({workshop:e.workshop,fieldWrapper:function(e){switch(e.field){case"row window":case"range window":return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a.Item,{label:"Preceding",name:"preceding"},r.a.createElement(z.a,{placeholder:"number"})),r.a.createElement(W.a.Item,{label:"Following",name:"following"},r.a.createElement(z.a,{placeholder:"number"})))}},selectFields:[{name:"row window"},{name:"range window"}],selectFieldsLabel:"Window Type",selectFieldsMode:"single"}),o=a.ui,c=(a.operateFields,a.setError,a.form);return o([r.a.createElement(W.a.Item,null,r.a.createElement(Q.a,{type:"primary",onClick:function(){var e=c.getFieldValue().selectFieldsName,a=Object(k.a)({},c.getFieldValue(),{windowType:e});t({type:Ko.buildRowWindows,data:{rowWindows:a}})}},"Next"),r.a.createElement(F.a,{type:"vertical"}),r.a.createElement(Q.a,{onClick:function(){t({type:"setState",data:{current:1}})}},"Previous"))])}var ec=it.a.Panel;var tc=a(1022);it.a.Panel;function ac(e){var t=e.workshop,a=Object(n.useContext)(cc).dispacher,o=function(e){var t=e.operateField,a=Object(n.useState)([]),o=Object(p.a)(a,2),c=o[0],i=o[1],s=Object(n.useState)(void 0),d=Object(p.a)(s,2),m=d[0],f=d[1],h=W.a.useForm(),b=Object(p.a)(h,1)[0],g=Object(n.useState)(void 0),v=Object(p.a)(g,2),y=v[0],E=v[1],O=function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.showFunctions();case 2:t=e.sent,a=t.content.map(function(e){return{value:e.key.table,text:e.key.table,funcValue:e.columns[0],returnValue:e.columns[1],params:e.columns.slice(2,e.columns.length)}}),i(a);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){O()},[]);var k=Object(n.useCallback)(function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=c.filter(function(e){return e.value===t})[0],f(a);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[c]),j=function(e){return"yes"===e.extra.column?t:""};return{ui:function(e,t){return r.a.createElement(W.a,{form:b,className:"login-form"},y&&r.a.createElement(ue,{onClose:function(){E(void 0)},message:y}),r.a.createElement(W.a.Item,{label:"Search function"},r.a.createElement(Ve.a,{showSearch:!0,defaultActiveFirstOption:!1,showArrow:!0,style:{width:"200px"},filterOption:!0,onChange:k,notFoundContent:"type function name"},c.map(function(e){return r.a.createElement(Ve.a.Option,{key:e.value},e.text)}))),m&&r.a.createElement(W.a.Item,{key:m.value},r.a.createElement(Er,{func:m})),m&&m.params.map(function(e){return r.a.createElement(W.a.Item,{initialValue:j(e),key:e.name,name:e.name,label:e.name},r.a.createElement(z.a,null))}),r.a.createElement(W.a.Item,null,r.a.createElement(it.a,null,r.a.createElement(ec,{header:"Mannually Apply Function"},r.a.createElement(F.a,{type:"horizontal"}),r.a.createElement(W.a.Item,{name:"mannualTransform",label:"Mannual Transform"},r.a.createElement(z.a,null)),r.a.createElement(W.a.Item,{name:"isMannualAgg",label:"Is Agg Function"},r.a.createElement(tr.a,null))))),t,r.a.createElement(W.a.Item,{name:"newFieldName",label:"New Field Name",required:!0},r.a.createElement(z.a,null)),e)},form:b,getTransform:function(){var e=b.getFieldValue(),a=e.mannualTransform,n=e.isMannualAgg,r=e.newFieldName;if(a)return{field:t,isAgg:n||!1,transformCode:a,columnName:r};if(!m)return E("Operate is required."),{};var o=[];return m.params.forEach(function(e){var a=b.getFieldValue()[e.name];a||"yes"!==e.extra.column||(a=t),a&&("yes"===e.extra.column?o.push(la.getField(a)):"number"==e.dataType||"boolean"==e.dataType?o.push(a):o.push('"'.concat(a,'"')))}),{field:t,isAgg:"yes"===m.funcValue.extra.agg,transformCode:"".concat(m.value,"(").concat(o.join(","),")"),columnName:r}},setError:E}}({operateField:""}),c=o.ui,i=o.form,s=o.getTransform,d=o.setError,m=Object(n.useState)(!1),f=Object(p.a)(m,2),h=f[0],b=f[1],g=Object(n.useState)([]),v=Object(p.a)(g,2),y=v[0],E=v[1];return r.a.createElement(r.a.Fragment,null,c([r.a.createElement(W.a.Item,null,r.a.createElement(Q.a,{type:"primary",loading:h,onClick:function(){var e=[];if(0===y.length){var n=s(),r=n.field,o=n.isAgg,c=n.transformCode,i=n.columnName;if(e.push({field:r,isAgg:o,transformCode:c,columnName:i}),!i)return void d("New Field Name is required.")}else e=y;b(!0),a({type:Ko.apply,data:{setLoading:b,workshop:t,functions:e}})}},"Apply"),r.a.createElement(F.a,{type:"vertical"}),r.a.createElement(Q.a,{loading:h,onClick:function(){var e=s(),t=e.field,a=e.isAgg,n=e.transformCode,r=e.columnName;r?(E(y.concat([{field:t,isAgg:a,transformCode:n,columnName:r}])),i.resetFields()):d("New Field Name is required.")}},"Add"),r.a.createElement(F.a,{type:"vertical"}),r.a.createElement(Q.a,{onClick:function(){a({type:"setState",data:{current:2}})}},"Previous"))]),y.length>0&&r.a.createElement(yr.b,{style:{width:"500px"},header:r.a.createElement("div",null,"Added Functions"),bordered:!0,dataSource:y.map(function(e){return"".concat(e.transformCode," as ").concat(e.columnName)}),renderItem:function(e){return r.a.createElement(yr.b.Item,null,r.a.createElement(tc.a.Text,{mark:!0},"Func")," ",e)}}))}function nc(){var e=Object(oe.a)(["\nborder: 1px dashed #e9e9e9;\nborder-radius: 6px;\nbackground-color: #fafafa;\nmin-height: 200px;\npadding: 30px 30px;\nwidth: 100%;\ndisplay:flex;\nalign-items:center;\njustify-content:center;\nflex-direction: column;\n"]);return nc=function(){return e},e}var rc=er.a.Step,oc=ce.a.div(nc()),cc=r.a.createContext();function ic(e){var t=e.parent.workshop,a={steps:[r.a.createElement(Xo,{workshop:t}),r.a.createElement($o,{workshop:t}),r.a.createElement(Zo,{workshop:t}),r.a.createElement(ac,{workshop:t})],current:0,result:{groupFields:[],orderFields:[],rowWindows:[]}},n=Object(d.useReducerAsync)(zo,a,Ho),o=Object(p.a)(n,2),c=o[0],i=o[1],s=c.steps,l=c.current;return r.a.createElement(cc.Provider,{value:{dispacher:i}},r.a.createElement("div",{className:"join-app"},r.a.createElement("div",{style:{marginTop:"30px"}},r.a.createElement(er.a,{current:l},r.a.createElement(rc,{key:0,title:"Build Group",description:"Choose fields to group data"}),r.a.createElement(rc,{key:1,title:"Setup Group Row Order",description:"Choose fields to order the data in group"}),r.a.createElement(rc,{key:2,title:"Build Window",description:"Build window on every row of every group"}),r.a.createElement(rc,{key:3,title:"Apply Function",description:"Apply functions to all windows we have created"}))),r.a.createElement("div",{className:"join-app-form"},r.a.createElement(oc,null,s[l]," "))))}var sc=Object(k.a)({},sn),lc=Object(k.a)({},ln);function uc(e,t){return lc[t.type](e,t.data)}a(1003);var pc={applySaveRollbackDispacher:void 0,scriptContent:void 0},dc=r.a.createContext();function mc(e){var t=e.parent.workshop,a=Object(d.useReducerAsync)(uc,pc,sc),o=Object(p.a)(a,2),c=o[0],i=o[1],s=function(e){var t=e.parent.workshop.currentTable.schema.fields.map(function(e){return e.name}),a=W.a.useForm(),o=Object(p.a)(a,1)[0],c=Object(n.useState)(),i=Object(p.a)(c,2),s=i[0],l=i[1],u=Object(n.useState)([]),d=Object(p.a)(u,2),m=d[0],f=d[1],h=t.map(function(e){return r.a.createElement(Ve.a.Option,{value:e},e)}),b=Object(n.useCallback)(function(e){e.forEach(function(e){"vType"===e.name[0]&&l(e.value)})},[]);return{ui:function(){return r.a.createElement(W.a,{form:o,onFieldsChange:b},r.a.createElement(W.a.Item,{label:"Visulizaiton Plugin",name:"vType"},r.a.createElement(Ve.a,null,m.map(function(e){return r.a.createElement(Ve.a.Option,{value:e},e)}))),r.a.createElement(W.a.Item,{label:"X Column",name:"xColumn"},r.a.createElement(Ve.a,null,h)),r.a.createElement(W.a.Item,{label:"Y Column",name:"yColumn"},r.a.createElement(Ve.a,null,h)))},form:o,vType:s,setPlugins:f}}(e),m=s.ui,f=s.form,h=s.vType,v=s.setPlugins,y=function(e){var t=W.a.useForm(),a=Object(p.a)(t,1)[0],o=Object(n.useState)([]),c=Object(p.a)(o,2),i=c[0],s=c[1];return console.log(i),{ui:function(){return r.a.createElement(W.a,{form:a},i.map(function(e){return r.a.createElement(W.a.Item,{key:e.key,name:e.key,label:e.option.label||e.key,initialValue:la.unQuote(e.command)},r.a.createElement(z.a,null))}))},form:a,setPluginConfigs:s,pluginConfigs:i}}(),E=y.ui,O=y.form,k=y.setPluginConfigs,j=new b.ActionProxy,w=c.applySaveRollbackDispacher,S=c.scriptContent,x=function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get(g.default.PLUGIN_LIST,{});case 2:if(200===(t=e.sent).status){e.next=5;break}return e.abrupt("return");case 5:a=t.content.map(function(e){return e.name}),v(a);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=13;break}return e.next=3,j.get(g.default.PLUGIN_GET,{pluginName:h});case 3:return t=e.sent,a=t.content.content,e.next=7,j.runScript(a,la.getJobName(),{executeMode:"analyze"});case 7:if(200===(n=e.sent).status){e.next=10;break}return e.abrupt("return");case 10:r=n.content.filter(function(e){return e.mode&&"defaultParam"===e.mode}),i({type:"setState",data:{scriptContent:a}}),k(r);case 13:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){C()},[h]),Object(n.useEffect)(function(){x()},[]);var T=function(){var e=Object(u.a)(l.a.mark(function e(){var a,n,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=8;break}return a=f.getFieldValue(),n=O.getFieldValue(),r=n.tableName||la.getTempTableName(),o="\n             select ".concat(la.getField(a.xColumn)," as x,").concat(la.getField(a.yColumn)," as y \n             from ").concat(t.getLastApplyTable().tableName," as ").concat(r,";\n             ").concat(S,"\n            "),e.next=7,t.apply({tableName:r,sql:o});case 7:w({type:"setState",data:{loading:!1}});case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)(function(){T()},[w]),r.a.createElement(dc.Provider,{value:{dispacher:i}},r.a.createElement(Yr,{workshop:t,context:dc}),r.a.createElement("div",{className:"dash-station"},r.a.createElement("div",{className:"dash-station-data-page"},m()),r.a.createElement(F.a,{type:"vertical",style:{height:"300px"}}),r.a.createElement("div",{className:"dash-station-dash-page"},E())))}var fc=st.a.TabPane,hc=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).reload=function(){a.setState({key:Math.random()})},a.workshop=e.parent,a.state={key:Math.random()},a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:"os-pane"},n.createElement("div",{className:"os-tabs"},n.createElement(st.a,{defaultActiveKey:"1",tabPosition:"left",key:this.state.key},n.createElement(fc,{tab:"Project",key:1},n.createElement(po,{parent:this})),n.createElement(fc,{tab:"Filter",key:2},n.createElement(go,{parent:this})),n.createElement(fc,{tab:"Join",key:3},n.createElement(br,{parent:this})),n.createElement(fc,{tab:"Agg",key:4},n.createElement(jr,{parent:this})),n.createElement(fc,{tab:"Order",key:5},n.createElement(Oo,{parent:this})),n.createElement(fc,{tab:"Limit",key:6},n.createElement(Ro,{parent:this})),n.createElement(fc,{tab:"Window",key:7},n.createElement(ic,{parent:this})),n.createElement(fc,{tab:"Dash",key:8},n.createElement(mc,{parent:this})))))}}]),t}(n.Component),bc=a(1016),gc=a(476),vc=a.n(gc),yc=a(431),Ec=a(159),Oc=a(416),kc=a(192),jc=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).getDefaultRender=function(e){e.name;switch(e.type){case"string":return function(e,t){return e};case"array":case"map":return function(e,t){return JSON.stringify(e)};default:return function(e,t){return e}}},a.getDefaultSearch=function(e){var t=e.name;switch(e.type){case"string":return a.getColumnSearchProps(t);case"array":case"map":default:return{}}},a.getDefaultTitleRender=function(e){return a.dropdown(e)},a.update=function(e,t){var n=!1;t[0]&&"html"===t[0].name&&t[1]&&"dash"===t[1].name&&(n=!0);var r=t.map(function(e){return Object(k.a)({},e,{dataIndex:e.name,title:a.getDefaultTitleRender(e),render:a.getDefaultRender(e)},a.getDefaultSearch(e))});a.setState({columns:r,data:e,isDash:n})},a.disablePreview=function(){a.setState({view:{enabled:!1}})},a.tableStyle=e.style||{},a.state={columns:[],rows:[],view:{enabled:!1},searchText:"",searchedColumn:"",loading:!1,isDash:!1},a.config={},a.workshop=e.parent,a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return this.state.isDash?Nt.render(this.state.data):n.createElement("div",{style:this.tableStyle},n.createElement(nt.a,{loading:this.state.loading,size:"default",columns:this.state.columns,dataSource:this.state.data,scroll:{x:!0}}),n.createElement(rt.a,{title:"View",visible:this.state.view.enabled,onCancel:this.disablePreview,onOk:this.disablePreview,cancelText:"Cancel",OkText:"Ok"},n.createElement(kc,{source:this.state.view.content||""})))}}]),t}(Gn(n.Component).with(function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(o)))).getColumnSearchProps=function(e){return{filterDropdown:function(t){var r=t.setSelectedKeys,o=t.selectedKeys,c=t.confirm,i=t.clearFilters;return n.createElement("div",{style:{padding:8}},n.createElement(z.a,{ref:function(e){a.searchInput=e},placeholder:"Search ".concat(e),value:o[0],onChange:function(e){return r(e.target.value?[e.target.value]:[])},onPressEnter:function(){return a.handleSearch(o,c,e)},style:{width:188,marginBottom:8,display:"block"}}),n.createElement(bc.a,null,n.createElement(Q.a,{type:"primary",onClick:function(){return a.handleSearch(o,c,e)},icon:n.createElement(yc.a,null),size:"small",style:{width:90}},"Search"),n.createElement(Q.a,{onClick:function(){return a.handleReset(i)},size:"small",style:{width:90}},"Reset")))},filterIcon:function(e){return n.createElement(yc.a,{style:{color:e?"#1890ff":void 0}})},onFilter:function(e,t){return!0},onFilterDropdownVisibleChange:function(e){e&&setTimeout(function(){return a.searchInput.select()})},render:function(t){return a.state.searchedColumn===e?n.createElement(vc.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[a.state.searchText],autoEscape:!0,textToHighlight:t?t.toString():""}):t}}},a.handleSearch=function(){var e=Object(u.a)(l.a.mark(function e(t,n,r){var o,c,i,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=la.getTempTableName(),c=t[0],i=la.getField(r),s={tableName:o,sql:"select * from ".concat(a.workshop.getLastApplyTable().tableName," \n            where ").concat(i," like '%").concat(c,"%' as ").concat(o,";")},n(),a.setState({loading:!0}),e.next=8,a.workshop.apply(s);case 8:a.setState({loading:!1,searchText:t[0],searchedColumn:r});case 9:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.handleReset=function(e){e(),a.setState({searchText:""})},a}return Object(ye.a)(t,e),t}(e)},function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(o)))).dropdownStat=function(){var e=Object(u.a)(l.a.mark(function e(t,n){var r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({loading:!0}),r=la.getTempTableName(),e.t0=t,e.next="count"===e.t0?5:"count(distinct)"===e.t0?9:13;break;case 5:return e.next=7,a.workshop.apply({tableName:r,sql:"select count(".concat(la.getField(n),") \n                    from ").concat(a.workshop.getLastApplyTable().tableName,"\n                    as ").concat(r,"\n                    ;")});case 7:return a.setState({loading:!1}),e.abrupt("return");case 9:return e.next=11,a.workshop.apply({tableName:r,sql:"select count(distinct ".concat(la.getField(n),") \n                    from ").concat(a.workshop.getLastApplyTable().tableName,"\n                    as ").concat(r,"\n                    ;")});case 11:return a.setState({loading:!1}),e.abrupt("return");case 13:a.setState({loading:!1});case 14:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.dropdown=function(e){var t=n.createElement(I.a,{onClick:function(t){a.dropdownStat(t.key,e.name)}},n.createElement(I.a.Item,{key:"count",icon:n.createElement(Oc.a,null)},"Count"),n.createElement(I.a.Item,{key:"count(distinct)",icon:n.createElement(Oc.a,null)},"Count&distinct"));return n.createElement(Ec.a,{overlay:t},n.createElement("span",null,e.name,n.createElement(F.a,{type:"vertical"}),n.createElement(on.a,null)))},a}return Object(ye.a)(t,e),t}(e)}));var wc=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(ge.a)(this,Object(ve.a)(t).call(this,e))).client=new b.ActionProxy,a.state={tableLoading:!1},a.sqls=[],t.workshop=Object(Ee.a)(Object(Ee.a)(a)),a}return Object(ye.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){}},{key:"operateStationView",value:function(){var e=this;return this.state.loadingTable?n.createElement(Dn,null):this.sessionId?n.createElement(hc,{ref:function(t){return e.stationRef=t},parent:this}):n.createElement("div",null,n.createElement(Vn.a,{style:{width:"100%"},title:"No Aanalysis Session Is Opened",subTitle:"Right click the table in the left panel(DeltaLake/FileSystem) to begin your analysis"}))}},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"ws-app"},n.createElement("div",{className:"ws-left-pane"},n.createElement(Be.Resizable,{style:{paddingRight:"30px",borderRight:"solid"}},n.createElement(Zn,{ref:function(t){return e.leftTreePaneRef=t},parent:this}))),n.createElement("div",{className:"ws-right-pane"},n.createElement(rt.a,{title:"Message",visible:this.state.showMessage||!1,onCancel:this.toggleMessage,onOk:this.toggleMessage,cancelText:"Cancel",width:"60%",OkText:"Ok"},n.createElement(ke.a,{height:"300px",width:"100%",mode:"text",theme:"github",name:"detail_box",value:this.state.consoleMessage||""})),n.createElement(rt.a,{title:"Message",visible:this.state.showInfoMessage||!1,onCancel:function(){e.setState({showInfoMessage:!1})},onOk:function(){e.setState({showInfoMessage:!1})},cancelText:"Cancel",OkText:"Ok"},this.state.infoMessage),n.createElement("div",{className:"ws-operate-pane"},this.operateStationView()),n.createElement(F.a,null),n.createElement("div",{className:"ws-table-pane"},n.createElement(jc,{style:{width:"90%"},ref:function(t){return e.displayRef=t},parent:this}))))}}]),t}(Gn(n.Component).with(function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).newSession=function(){var e=Object(u.a)(l.a.mark(function e(t,n,r,o){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.showTable(t,n,r,o),e.abrupt("return",Object(Ee.a)(Object(Ee.a)(a)));case 2:case"end":return e.stop()}},e)}));return function(t,a,n,r){return e.apply(this,arguments)}}(),a.showTable=function(){var e=Object(u.a)(l.a.mark(function e(t,n,r,o){var c,i,s,u,p,d,m,f,h,b;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=la.getTempTableName(),i="".concat(n,"."),n||(i=""),s="select * from ".concat(i).concat(r," as ").concat(c,";"),"delta"===t&&(s="load delta.`".concat(n,".").concat(r,"` as ").concat(c,";")),"temp"!==t){e.next=11;break}return e.next=8,Ke.tableInfo(r);case 8:u=e.sent,p=u.content,s=2===p.status?"load parquet.`/__persisted__/".concat(p.tableName,"`  as ").concat(p.tableName,";\n                select * from ").concat(p.tableName," as ").concat(c,";"):"".concat(p.content," \n                select * from ").concat(p.tableName," as ").concat(c,";");case 11:return"file"===t&&(d="where ",o?d+=Object.keys(o).map(function(e){var t=o[e];return"".concat(e.replace(/\[group\]/g,"0"),"='''").concat(t,"'''")}).join(" and "):d="",s="load ".concat(n,".`").concat(r,"` ").concat(d,"  as ").concat(c,";")),a.sqls.push({tableName:c,sql:s}),a.setState({loadingTable:!0}),e.next=16,a.client.runScript(s,la.getJobName(),la.robotFetchParam());case 16:if(m=e.sent,a.setState({loadingTable:!1}),200===m.status){e.next=21;break}return a.toggleMessage("Fail to load ".concat(c,": ").concat(m.content)),e.abrupt("return");case 21:f=m.content,h=f.schema,b=f.data,a.setCurrentTable("","",c,h,b),a.sessionId=la.getJobName(),a.setState({sessionId:a.sessionId});case 25:case"end":return e.stop()}},e)}));return function(t,a,n,r){return e.apply(this,arguments)}}(),a.setCurrentTable=function(e,t,n,r,o){a.currentTable={prefix:e,db:t,table:n,schema:r,data:o},a.updateDisplay(o,r)},a}return Object(ye.a)(t,e),t}(e)},function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).getLastApplyTable=function(){return a.sqls[a.sqls.length-1]},a.rollback=function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.sqls.length<2)){e.next=3;break}return a.toggleMessage("No apply to rollback."),e.abrupt("return");case 3:a.sqls.pop(),n=a.sqls.pop(),a.apply(n);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.apply=function(){var e=Object(u.a)(l.a.mark(function e(t){var n,r,o,c,i,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.tableName,t.sql,a.sqls.push(t),r=a.sqls.map(function(e){return e.sql}).join(""),e.prev=3,e.next=6,a.client.runScript(r,la.getJobName(),la.robotFetchParam());case 6:if(200===(o=e.sent).status){e.next=10;break}return a.toggleMessage(o.content),e.abrupt("return",500);case 10:return c=o.content,i=c.data,s=c.schema,a.setCurrentTable("","",n,s,i),e.abrupt("return",200);case 15:return e.prev=15,e.t0=e.catch(3),a.toggleMessage("Execute job fail;(Job is killed)"),e.abrupt("return",500);case 19:case"end":return e.stop()}},e,null,[[3,15]])}));return function(t){return e.apply(this,arguments)}}(),a.save=function(){var e=Object(u.a)(l.a.mark(function e(t,n){var r,o,c,i,s,u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.sqls.length){e.next=3;break}return a.toggleMessage("Sorry, current session have no applies."),e.abrupt("return",500);case 3:if(r="select * from ".concat(a.getLastApplyTable().tableName," as ").concat(t,";"),a.sqls.push({tableName:t,sql:r}),o=a.sqls.map(function(e){return e.sql}).join("\n"),c=la.getJobName(),i={status:5},!n){e.next=13;break}return s="".concat(o,"\n         save overwrite ").concat(t," as parquet.`/__persisted__/").concat(t,"`;"),e.next=12,a.client.runScript(s,c,{persistJobName:c,async:!0});case 12:i={jobName:c,status:1};case 13:return e.next=15,a.client.post(g.default.ANALYSIS_SAVE,Object.assign({tableName:t,sql:o,sessionId:a.sessionId,schema:JSON.stringify(a.currentTable.schema)},i));case 15:return u=e.sent,e.abrupt("return",u.status);case 17:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(ye.a)(t,e),t}(e)},function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).toggleMessage=function(e){a.state.showMessage?a.setState({showMessage:!a.state.showMessage}):a.setState({showMessage:!a.state.showMessage,consoleMessage:e})},a.showInfo=function(e){a.setState({showInfoMessage:!0,infoMessage:e})},a}return Object(ye.a)(t,e),t}(e)},function(e){return function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(ge.a)(this,(e=Object(ve.a)(t)).call.apply(e,[this].concat(r)))).updateDisplay=function(){var e=Object(u.a)(l.a.mark(function e(t,n){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({tableLoading:!0}),a.displayRef.update(t,n.fields),a.setState({tableLoading:!1});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.refreshOperateStation=function(){a.stationRef.setState({key:Math.random()})},a.refreshTableWorkshop=function(){a.leftTreePaneRef.workshopTableTreeRef.reload()},a}return Object(ye.a)(t,e),t}(e)}));wc.workshop=void 0;var Sc,xc=wc,Cc=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r,o,c,i,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data,n=a.enableRegister,r=void 0!==n&&n,o=a.enableLogin,c=void 0!==o&&o,i=new b.ActionProxy,e.next=4,i.post(g.default.APP_SAVE,{login:c,register:r});case 4:if(200!==(s=e.sent).status){e.next=7;break}return e.abrupt("return",{data:{applySuccess:!0}});case 7:return e.abrupt("return",{data:{error:s.content}});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Tc=Cc.handler,Nc=Cc.action,Rc=function e(){Object(f.a)(this,e)};Rc.LR_CONTROL="lrControl",Rc.SET_STATE="setState";var Dc=(Sc={},Object(m.a)(Sc,Rc.LR_CONTROL,Tc),Object(m.a)(Sc,Rc.SET_STATE,N.SetStateActionHandler),Sc);function Ac(e,t){switch(t.type){case Rc.LR_CONTROL:return Nc(e,t.data);case Rc.SET_STATE:return Object(N.SetStateAction)(e,t.data);default:return e}}a(1006);var Ic=a(423),Fc={enableLogin:!1,enableRegister:!1,applySuccess:!1,error:void 0,loading:!0},Pc=r.a.createContext();function Lc(){var e=Object(d.useReducerAsync)(Ac,Fc,Dc),t=Object(p.a)(e,2),a=t[0],o=t[1],c=S.formLayout1(),i=c.formItemLayout,s=c.tailLayout,f=a.enableLogin,v=a.enableRegister,y=a.applySuccess,E=a.error,O=a.loading;function k(){return(k=Object(u.a)(l.a.mark(function e(){var t,a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new b.ActionProxy,e.next=3,t.get(g.default.APP_INFO,{});case 3:200===(a=e.sent).status&&o({type:Rc.SET_STATE,data:(n={enableLogin:Boolean(a.content.login)},Object(m.a)(n,"enableLogin",Boolean(a.content.register)),Object(m.a)(n,"loading",!1),n)});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(n.useEffect)(function(){!function(){k.apply(this,arguments)}()},[y,E]),r.a.createElement(Pc.Provider,{value:{dispacher:o}},y&&r.a.createElement(ie.a,{closable:!0,message:"Success",description:"Apply Success",type:"success",showIcon:!0}),E&&r.a.createElement(ie.a,{closable:!0,message:"Fail",description:E,type:"error",showIcon:!0}),O&&r.a.createElement(Dn,null),!O&&r.a.createElement(H.a,{title:"Control Website Register/Login"},r.a.createElement(W.a,Object.assign({},i,{className:"login-form",onFinish:function(e){o(h.a.buildEvent(Rc.LR_CONTROL,e))}}),r.a.createElement(W.a.Item,{label:"Allow Register New User",name:"enableRegister"},r.a.createElement(tr.a,{defaultChecked:v,checkedChildren:"enable",unCheckedChildren:"shutdown"})),r.a.createElement(W.a.Item,{label:"Allow User Login",name:"enableLogin"},r.a.createElement(tr.a,{defaultChecked:f,checkedChildren:"enable",unCheckedChildren:"shutdown"})),r.a.createElement(W.a.Item,s,r.a.createElement(Q.a,{type:"primary",htmlType:"submit"},"Apply")))))}var _c=I.a.SubMenu,Mc={currentPage:"lr-settings"},qc=r.a.createContext();function Vc(){var e=Object(d.useReducerAsync)(Ac,Mc,Dc),t=Object(p.a)(e,2),a=t[0],n=t[1],o=a.currentPage;return r.a.createElement(qc.Provider,{value:{dispacher:n}},r.a.createElement("div",{className:"app-admin"},r.a.createElement("div",{className:"app-admin-side"},r.a.createElement(I.a,{style:{width:256},defaultSelectedKeys:["lr-settings"],defaultOpenKeys:["console-settings"],mode:"inline"},r.a.createElement(_c,{key:"console-settings",title:r.a.createElement("span",null,r.a.createElement(Ic.a,null),r.a.createElement("span",null,"Console settings"))},r.a.createElement(I.a.Item,{key:"lr-settings"},"Login/Register Control")))),r.a.createElement("div",{className:"app-admin-main"},"lr-settings"===o&&r.a.createElement(Lc,null))))}var Bc={currentPage:"login",logined:!1},Gc=r.a.createContext();function Uc(){var e=Object(d.useReducerAsync)(A,Bc,D),t=Object(p.a)(e,2),a=t[0],o=t[1],c=a.currentPage,i=a.logined;return Object(n.useEffect)(function(){o(h.a.buildEvent(R.CHECK_LOGINED,{}))},[]),r.a.createElement(Gc.Provider,{value:{dispacher:o}},r.a.createElement("div",{className:"app-console"},r.a.createElement("div",{className:"app-console-header"},r.a.createElement(J,{userLogined:i,currentPage:c})),r.a.createElement("div",{className:"app-console-main"},"register"===c&&r.a.createElement(me,null),"register"!==c&&!i&&r.a.createElement(be,null),"console"===c&&i&&r.a.createElement(qn,null),"workshop"===c&&i&&r.a.createElement(xc,null),"admin"===c&&i&&S.isAdmin()&&r.a.createElement(Vc,null)),r.a.createElement("div",{className:"app-console-footer"},r.a.createElement("div",{style:{bottom:"100px",textAlign:"center",width:"100%"}},"MLSQL Licensed under the Apache License, Version 2.0. @",r.a.createElement("a",{className:"copyright",href:"http://www.miitbeian.gov.cn/"},"\u6d59ICP\u590718052520\u53f7"),r.a.createElement("div",null,"@",r.a.createElement("a",{target:"_blank",href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010802009683"},r.a.createElement("img",{src:""}),"\u6d59\u516c\u7f51\u5b89\u5907 33010802009683\u53f7"))))))}var Jc,Kc=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){var a,n,r,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new b.ActionProxy,n=t.data,r=n.name,o=n.url,e.next=4,a.post(g.default.ENGINE_ADD,{name:r,url:o});case 4:if(200===(c=e.sent).status){e.next=7;break}return e.abrupt("return",{data:{error:JSON.parse(c.content).msg}});case 7:return e.abrupt("return",{data:{error:void 0,current:t.__state.current+1}});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Hc=Kc.handler,Wc=Kc.action,zc=h.a.buildHandler(function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{data:{error:void 0,current:t.__state.current+1}});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Qc=zc.handler,Yc=zc.action,Xc=function e(){Object(f.a)(this,e)};Xc.registerAdmin="registerAdmin",Xc.addEngine="addEngine",Xc.skipAddEngine="skipAddEngine";var $c=(Jc={},Object(m.a)(Jc,Xc.registerAdmin,X),Object(m.a)(Jc,Xc.addEngine,Hc),Object(m.a)(Jc,Xc.skipAddEngine,Qc),Jc);function Zc(e,t){switch(t.type){case Xc.registerAdmin:return $(e,t.data);case Xc.addEngine:return Wc(e,t.data);case Xc.skipAddEngine:return Yc(e,t.data);default:return e}}var ei=a(1026);var ti=function(){var e=Object(n.useContext)(Si).dispacher,t=S.formLayout1(),a=t.formItemLayout,o=t.tailLayout;return r.a.createElement(W.a,Object.assign({},a,{className:"login-form",onFinish:function(t){e({type:Xc.registerAdmin,data:t})}}),r.a.createElement(W.a.Item,{label:"UserName",name:"userName",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(z.a,null)),r.a.createElement(W.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(z.a.Password,null)),r.a.createElement(W.a.Item,{label:"Repeated Password",name:"password2",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(z.a.Password,null)),r.a.createElement(W.a.Item,o,r.a.createElement(Q.a,{type:"primary",htmlType:"submit"},"Go")))};var ai,ni=function(){var e=Object(n.useContext)(Si).dispacher,t=S.formLayout1(),a=t.formItemLayout,o=t.tailLayout,c={required:!0,message:"required"};return r.a.createElement(W.a,Object.assign({},a,{className:"login-form",onFinish:function(t){e({type:Xc.addEngine,data:t})}}),r.a.createElement(W.a.Item,{label:"Engine Name",name:"name",rules:[c]},r.a.createElement(z.a,null)),r.a.createElement(W.a.Item,{label:"Engine Url",name:"url",rules:[c]},r.a.createElement(z.a,null)),r.a.createElement(W.a.Item,o,r.a.createElement(Q.a,{type:"primary",htmlType:"submit"},"Go"),r.a.createElement(F.a,{type:"vertical"}),r.a.createElement(Q.a,{onClick:function(t){t.preventDefault(),e({type:Xc.skipAddEngine,data:{}})},htmlType:"submit"},"Skip")))},ri=h.a.buildHandler(function(e){return{data:e.data}}),oi=ri.handler,ci=ri.action,ii=h.a.buildHandler(function(e){return{data:{appConfigured:!0}}}),si=ii.handler,li=ii.action,ui=h.a.buildHandler(function(e){return{data:{appConfigured:!0}}}),pi=ui.handler,di=ui.action,mi=function e(){Object(f.a)(this,e)};mi.GO_CONSOLE="goConsole",mi.GO_ADMIN="goAdmin",mi.appConfigured="appConfigured";var fi=(ai={},Object(m.a)(ai,mi.GO_ADMIN,si),Object(m.a)(ai,mi.GO_CONSOLE,pi),Object(m.a)(ai,mi.appConfigured,oi),ai);function hi(e,t){switch(t.type){case mi.GO_ADMIN:return li(e,t.data);case mi.GO_CONSOLE:return di(e,t.data);case mi.appConfigured:return ci(e,t.data);default:return e}}var bi=function(){var e=Object(n.useContext)(Ti).dispacher,t=S.formLayout1(),a=t.formItemLayout,o=t.tailLayout;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ie.a,{message:"Congratuation!",description:"You have finished the setup of MLSQL Console.",type:"success"}),r.a.createElement(F.a,null),r.a.createElement(W.a,a,r.a.createElement(W.a.Item,o,r.a.createElement(Q.a,{type:"primary",onClick:function(){e({type:mi.GO_ADMIN,data:{}})}},"Go to Admin Page"),r.a.createElement(F.a,{type:"vertical"}),r.a.createElement(Q.a,{onClick:function(){e({type:mi.GO_CONSOLE,data:{}})}},"Go to Console Page"))))};function gi(){var e=Object(oe.a)(["\n width:100%;\n display:flex;\n max-width: 800px;\n flex-direction: column;\n"]);return gi=function(){return e},e}function vi(){var e=Object(oe.a)(["\n  width:100%;\n  margin-top:6px;\n"]);return vi=function(){return e},e}function yi(){var e=Object(oe.a)(["\ndisplay: flex;\nflex-direction: column;\nwidth:100%;\njustify-content:center;\n align-items:  center;\n"]);return yi=function(){return e},e}var Ei=er.a.Step,Oi=ce.a.div(yi()),ki=ce.a.div(vi()),ji=ce.a.div(gi()),wi={error:void 0,current:0},Si=r.a.createContext();var xi=function(){var e=Object(d.useReducerAsync)(Zc,wi,$c),t=Object(p.a)(e,2),a=t[0],n=t[1],o=a.error,c=a.current;return r.a.createElement(Si.Provider,{value:{dispacher:n}},r.a.createElement(Oi,null,r.a.createElement(ki,null,r.a.createElement(ei.a,{title:"Setup MLSQL Console in 2 Steps"})),r.a.createElement(F.a,null),r.a.createElement(ji,null,r.a.createElement(er.a,{current:c},r.a.createElement(Ei,{title:"Admin User/Password",description:"Setup Admin accout"}),r.a.createElement(Ei,{title:"Add Engines",description:"Add default MLSQL Engine"}),r.a.createElement(Ei,{title:"Done",description:"Congratuation"})),r.a.createElement(F.a,null),o&&r.a.createElement(ie.a,{message:"Message",description:o,type:"error",closable:!0}),0===c&&r.a.createElement(H.a,null,r.a.createElement(ti,null)),1===c&&r.a.createElement(H.a,null,r.a.createElement(ni,null)),2===c&&r.a.createElement(H.a,null,r.a.createElement(bi,null)))))},Ci={appConfigured:!1,loading:!0},Ti=r.a.createContext();var Ni=function(){var e=Object(d.useReducerAsync)(hi,Ci,fi),t=Object(p.a)(e,2),a=t[0],o=t[1],c=a.appConfigured,i=a.loading;function s(){return(s=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new b.ActionProxy,e.next=3,t.get(g.default.APP_INFO,{});case 3:200===(a=e.sent).status&&o({type:mi.appConfigured,data:{appConfigured:a.content.configured,loading:!1}});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(n.useEffect)(function(){!function(){s.apply(this,arguments)}()},[]),r.a.createElement(Ti.Provider,{value:{dispacher:o}},i&&r.a.createElement(Dn,null),!i&&!c&&r.a.createElement(xi,null),!i&&c&&r.a.createElement(Uc,null))};c.a.render(r.a.createElement(Ni,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},27:function(e,t,a){"use strict";var n=a(6),r=a.n(n),o=a(21),c=a(8),i=a(7),s=a(12),l=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"buildHandler",value:function(e){return{handler:function(t){var a=t.dispatch,n=t.getState,i=(t.signal,a);return function(){var t=Object(c.a)(r.a.mark(function t(a){var c;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(Object(o.a)({},a,{__state:n()}));case 2:c=t.sent,i(Object(o.a)({type:a.type},c));case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},action:function(e,t){return Object(o.a)({},e,t)}}}},{key:"buildEvent",value:function(e,t){return{type:e,data:t}}}]),e}();t.a=l},32:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return r});var n=a(7),r=function e(){Object(n.a)(this,e)};r.RUN="/api_v1/run/script",r.USER_NAME="/api_v1/user/userName",r.JOB_LIST="/api_v1/job/list",r.JOB_DETAIL="/api_v1/job",r.JOB_KILL="/api_v1/job/kill",r.SAVE_SCRIPT_FILE="/api_v1/script_file",r.ANALYSIS_TABLES="/api_v1/analysis/tables",r.ANALYSIS_TABLE_INFO="/api_v1/analysis/table/get",r.ANALYSIS_SAVE="/api_v1/analysis/tables/save",r.APP_INFO="/api_v1/app",r.APP_SAVE="/api_v1/app/save",r.REGISTER="/api_v1/user/register",r.LOGIN="/api_v1/user/login",r.LOGOUT="/api_v1/user/logout",r.ENGINE_ADD="/api_v1/engine/add",r.SCRIPT_FILE_LIST="/api_v1/script_file",r.SCRIPT_FILE_GET="/api_v1/script_file/get",r.SCRIPT_FILE_REMOVE="/api_v1/script_file/remove",r.PLUGIN_LIST="/api_v1/plugin/list",r.PLUGIN_GET="/api_v1/plugin/get"},329:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(6),r=a.n(n),o=a(8),c=a(7),i=a(12),s=a(21),l=a(83),u=function e(){Object(c.a)(this,e)};u.USER_NAME="userName",u.USER_ID="userId",u.ADMIN_TOKEN="admin_token",u.LOGIN_TOKEN="access-token";var p=function e(t,a,n){Object(c.a)(this,e),this.status=t,this.content=a,this.resp=n},d=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.a)(this,e),this.url=t,this.url||(this.url=l.b),this.fetch_config=a}return Object(i.a)(e,[{key:"request",value:function(){var e=Object(o.a)(r.a.mark(function e(t,a){var n,o,c,i,d,m,f,h,b,g,v,y,E=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i in n=(n=E.length>2&&void 0!==E[2]?E[2]:"GET").toUpperCase(),(o=sessionStorage.getItem(u.USER_NAME))&&(a[u.USER_NAME]=o),c=[],a)d=encodeURIComponent(i),m=encodeURIComponent(a[i]),c.push(d+"="+m);return f=this.url+t,c.length>0&&(f+="?"),"GET"===n?(f+=c.join("&"),c=void 0):c=c.join("&"),h={method:n,timeout:864e5,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","Access-Token":sessionStorage.getItem(l.a)||""},body:c},b=Object(s.a)({},h,this.fetch_config),e.prev=11,e.next=14,fetch(f,b);case 14:if((g=e.sent).ok){e.next=20;break}return e.next=18,g.text();case 18:return v=e.sent,e.abrupt("return",new p(g.status,v));case 20:return e.next=22,g.json();case 22:return y=e.sent,e.abrupt("return",new p(200,y,g));case 26:return e.prev=26,e.t0=e.catch(11),e.abrupt("return",new p(500,e.t0,void 0));case 29:case"end":return e.stop()}},e,this,[[11,26]])}));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),m=a(32);a.d(t,"ActionProxy",function(){return f});var f=function(){function e(){Object(c.a)(this,e),this.backend=new d}return Object(i.a)(e,[{key:"userName",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(m.default.USER_NAME,{});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"runScript",value:function(){var e=Object(o.a)(r.a.mark(function e(t,a,n){var o,c,i,s,l,u;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userName();case 2:if(200===(o=e.sent).status){e.next=5;break}return e.abrupt("return",o);case 5:return c=o.content,i=c.userName,s=c.backendTags,l={sql:t,owner:i,jobName:a,sessionPerUser:!0,show_stack:!0,skipAuth:!1,tags:s||""},Object.assign(l,n),e.next=10,this.post(m.default.RUN,l);case 10:return u=e.sent,e.abrupt("return",u);case 12:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(o.a)(r.a.mark(function e(t,a){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backend.request(t,a,l.c.GET);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(o.a)(r.a.mark(function e(t,a){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backend.request(t,a,l.c.POST);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}]),e}();f.client=new f},344:function(e,t,a){},412:function(e,t,a){},413:function(e,t,a){},414:function(e,t,a){},415:function(e,t,a){},506:function(e,t,a){e.exports=a(1011)},512:function(e,t,a){},513:function(e,t,a){},516:function(e,t,a){},517:function(e,t,a){},656:function(e,t,a){},659:function(e,t,a){},76:function(e,t,a){"use strict";a.r(t),a.d(t,"SetStateActionHandler",function(){return s}),a.d(t,"SetStateAction",function(){return l});var n=a(6),r=a.n(n),o=a(21),c=a(8),i=a(27).a.buildHandler(function(){var e=Object(c.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{data:Object(o.a)({},t.data)});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),s=i.handler,l=i.action},83:function(e,t,a){"use strict";a.d(t,"b",function(){return r}),a.d(t,"c",function(){return o}),a.d(t,"a",function(){return c});var n=a(7),r="",o=function e(){Object(n.a)(this,e)};o.GET="get",o.POST="post",o.PUT="put",o.DELETE="delete";var c={name:"access-token"}},992:function(e,t,a){},993:function(e,t,a){}},[[506,1,2]]]);
//# sourceMappingURL=main.9d9b2949.chunk.js.map